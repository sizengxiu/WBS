{"version":3,"file":"index.js","sources":["../src/interface/canvas.js","../src/interface/node.js","../src/interface/endpoint.js","../src/endpoint/baseEndpoint.js","../src/node/baseNode.js","../src/utils/link.js","../src/utils/arrow.js","../src/utils/link_animate.js","../src/interface/edge.js","../src/edge/baseEdge.js","../src/interface/group.js","../src/utils/scopeCompare.js","../src/group/baseGroup.js","../src/utils/layout/circleLayout.js","../src/utils/layout/fruchterman.js","../src/utils/layout/gridLayout.js","../src/utils/layout/forceLayout.js","../src/utils/layout/concentLayout.js","../src/utils/layout/drageLayout.js","../src/utils/layout/layout.js","../src/utils/selectCanvas.js","../src/utils/coordinate.js","../src/utils/girdService.js","../src/utils/guidelineService.js","../src/utils/minimap.js","../src/canvas/baseCanvas.js","../src/node/treeNode.js","../src/utils/layout/hierarchy/index.js","../src/canvas/treeCanvas.js","../src/utils/toolTip.js","../index.js"],"sourcesContent":["'use strict';\n\nconst EventEmit3 = require('eventemitter3');\n\nclass Canvas extends EventEmit3 {\n  constructor() {\n    // root             根节点\n    // layout           布局支持\n    // zoomable         是否可放大缩小\n    // moveable         是否可移动\n    // draggable        是否可拖动节点\n    // linkable         是否可连接线条\n    // disLinkable      是否可取消连线\n    // theme            主题配置\n    // global           公共配置\n    super();\n  }\n\n  // 渲染节点\n  draw() {}\n\n  // 获取节点\n  getNode() {}\n\n  // 获取线条\n  getEdge() {}\n\n  // 获取节点组\n  getGroup() {}\n\n  // 添加节点\n  addNode() {}\n\n  // 批量添加节点\n  addNodes() {}\n\n  // 添加线条\n  addEdge() {}\n\n  // 批量添加线条\n  addEdges() {}\n\n  // 批量添加节点组\n  addGroups() {}\n\n  // 删除节点\n  removeNode() {} \n\n  // 批量删除节点\n  removeNodes() {}\n\n  // 删除线条\n  removeEdge() {}\n\n  // 批量删除线条\n  removeEdges() {}\n\n  // 删除节点组\n  removeGroup() {}\n\n  // 获取相邻的线条\n  getNeighborEdges() {}\n\n  // 获取相邻的节点\n  getNeighborNodes() {}\n\n  // 获取无环血缘图\n  getNeighborNodesAndEdgesByLevel() {}\n  getAdjcentTable() {} // 需要改为内部方法\n\n  // 获取缩放值\n  getZoom() {}\n  // 动态设置可缩放\n  setZoomable() {}\n  // 动态设置缩放值\n  zoom() {}\n\n  // 获取偏移值\n  getOffset() {}\n  // 动态设置可移动\n  setMoveable() {}\n  // 动态设置移动\n  move() {}\n\n  // 获取中心点\n  getOrigin() {}\n  // 动态设置中心点\n  setOrigin() {}\n\n  // 获取数据结构\n  getDataMap() {}\n\n  // 设置网格模式\n  setGirdMode() {}\n  // 设置网格线条\n  setGuideLine() {}\n  // 设置辅助线\n  justifyCoordinate() {}\n\n  // 设置框选模式\n  setSelectMode() {}\n\n  // 设置某些联合值，即框选的元素\n  getUnion() {}\n  // 设置所有联合值，即框选的元素\n  getAllUnion() {}\n\n  // 添加联合值\n  add2Union() {}\n  // 删除某些联合值\n  removeUnion() {}\n  // 删除所有联合值\n  removeAllUnion() {}\n\n  // 聚焦单个节点（看看需要合并不）\n  focusNodeWithAnimate() {}\n  // 聚焦某些节点\n  focusNodesWithAnimate() {}\n\n  // 画布坐标转换为终端坐标\n  canvas2terminal() {}\n  // 终端坐标转换为画布坐标\n  terminal2canvas() {}\n\n  // 保存为图片\n  save2img() {}\n\n  // ********* 需要优化的api ********* \n  \n  // 更新画布的大小 \n  updateRootResize() {}\n\n  // ********* 需要新增的api ********* \n\n  // 单击的回调\n  click() {}\n\n  // 双击的回调\n  doubleClick() {}\n\n  // 右键的回调\n  onContextmenu() {}\n\n  // 集成menu\n\n  // 生成/关闭缩略图\n  \n}\n\n\nexport default Canvas;\n","'use strict';\n\nconst EventEmit3 = require('eventemitter3');\n\nclass Node extends EventEmit3 {\n  constructor() {\n    // id        节点唯一标志\n    // top       坐标y\n    // left      坐标x\n    // group     存在于哪个节点组上\n    // dom       节点的dom元素\n    // draggable 该节点是否能拖动标志，可覆盖全局的\n    // options   数据的透传\n    // _on       节点发送事件\n    // _emit     节点发送事件\n    // _global   全局的配置\n\n\n    // 需要优化的\n    // scope           scope相同可拉进group里面\n    // endpoints       endpoint对象\n    // _endpointsData  真实的endpoint数据\n    // _isMoving       标识是否在移动做，兼容冒泡\n    super();\n  }\n\n  // 渲染节点\n  draw() {}\n\n  // 获取锚点\n  getEndpoint() {}\n\n  // 添加锚点\n  addEndpoint() {}\n\n  // 删除锚点\n  removeEndpoint() {}\n\n  // 移动节点\n  moveTo() {}\n\n  // 获取宽度\n  getWidth() {}\n\n  // 获取高度\n  getHeight() {}\n\n  // 设置该节点是否能拖动，能覆盖全局\n  setDraggable() {}\n\n  // remove的方法\n  remove() {}\n\n  // 销毁的方法\n  destroy() {}\n\n\n  // ********* 需要新增的api ********* \n\n\n  // focus回调\n  focus() {}\n\n  // unFocus回调\n  unFocus() {}\n\n  // 单击的回调\n  click() {}\n\n  // 双击的回调\n  doubleClick() {}\n\n  // 右键的回调\n  onContextmenu() {}\n\n  // hover的回调\n  hover() {}\n\n}\n\nexport default Node;\n","'use strict';\n\nconst EventEmit3 = require('eventemitter3');\n\nclass Endpoint extends EventEmit3 {\n  constructor() {\n    super();\n  }\n}\n\nexport default Endpoint;","\n\nconst $ = require('jquery');\nconst _ = require('lodash');\n\nimport './baseEndpoint.less';\n\nimport Endpoint from '../interface/endpoint';\n\nclass BaseEndpoint extends Endpoint {\n  constructor(opts) {\n    super(opts);\n    this.id = opts.id;\n    this.options = opts;\n    this.orientation = opts.orientation;\n    this.pos = opts.pos;\n    this.type = opts.type;\n    this.nodeType = _.get(opts, 'nodeType', 'node');\n    this.nodeId = _.get(opts, '_node.id');\n    this.root = opts.root;\n    this.scope = opts.scope;\n    this.expandArea = opts.expandArea;\n    this.limitNum = opts.limitNum;\n    this.options = opts;\n    // 鸭子辨识手动判断类型\n    this.__type = 'endpoint';\n    // 假如锚点在节点上则有值\n    this._node = opts._node;\n    this._global = opts._global;\n    this._on = opts._on;\n    this._emit = opts._emit;\n    // 相对坐标\n    this._top = 0;\n    this._left = 0;\n    // 相对于画布的绝对坐标\n    this._posTop = 0;\n    this._posLeft = 0;\n    this._width = 0;\n    this._height = 0;\n    // 拉线时候可连接的标志\n    this._linkable = false;\n\n    this._coordinateService = null;\n\n    this.dom = null;\n    // 判断自定义锚点\n    this._isInitedDom = false;\n    if (opts.dom) {\n      this.dom = opts.dom;\n      this._isInitedDom = true;\n    }\n  }\n\n  _init(obj) {\n    this._coordinateService = obj._coordinateService;\n    \n    if (obj.nodeType) {\n      this.nodeType = obj.nodeType;\n    }\n    // 计算锚点起始值\n    if (!this._isInitedDom) {\n      this.dom = this.draw({\n        id: this.id,\n        orientation: this.orientation,\n        pos: this.pos,\n        dom: this.dom,\n        root: this.root,\n        type: this.type,\n        options: this.options\n      });\n    } else {\n      // 计算width,height,left,top\n      this._width = $(this.dom).width();\n      this._height = $(this.dom).height();\n      this._left = this._coordinateService._terminal2canvas('x', $(this.dom).offset().left);\n      this._top = this._coordinateService._terminal2canvas('y', $(this.dom).offset().top);\n\n      this._posTop = this._top;\n      this._posLeft = this._left;\n    }\n\n    this.attachEvent();\n  }\n\n  draw(obj) {\n    let _dom = obj.dom;\n    if (!_dom) {\n      _dom = $('<div class=\"butterflie-circle-endpoint\"></div>').attr('id', this.id);\n    } else {\n      _dom = $(_dom);\n    }\n    return _dom[0];\n  }\n\n  updatePos(dom = this.dom, orientation = this.orientation, pos = this.pos) {\n    if (this._isInitedDom) {\n      // 计算width,height,left,top\n      this._width = $(this.dom).width();\n      this._height = $(this.dom).height();\n      // 计算锚点起始值\n      this._left = this._coordinateService._terminal2canvas('x', $(this.dom).offset().left);\n      this._top = this._coordinateService._terminal2canvas('y', $(this.dom).offset().top);\n      this._posLeft = this._left;\n      this._posTop = this._top;\n    } else {\n      let _currentNode = this._node;\n      let _currentDom = $(this._node.dom);\n      let _currentNodeType = this.nodeType;\n\n      // 分情况弄好方向和位置\n      const nodeW = _currentDom.outerWidth();\n      const nodeH = _currentDom.outerHeight();\n\n      let targetDom = null;\n      let targetDomW = 0;\n      let targetDomH = 0;\n      if (this.root) {\n        targetDom = _currentDom.find(this.root);\n        targetDomW = targetDom.width();\n        targetDomH = targetDom.height();\n      }\n\n      this._width = $(dom).outerWidth();\n      this._height = $(dom).outerHeight();\n\n      // 计算节点本身的偏移量\n      const eOffsetX = this._width / 2;\n      const eOffsetY = this._height / 2;\n\n      let _offsetTop = 0;\n      let _offsetLeft = 0;\n\n      const _orientation = orientation || this.orientation || [0, -1];\n      const _pos = pos || this.pos || [_orientation[0] === 0 ? 0.5 : 0, _orientation[1] === 0 ? 0.5 : 0];\n\n      const result = [0, 0];\n\n      const _ox = _orientation[0];\n      const _oy = _orientation[1];\n      const _px = _pos[0];\n      const _py = _pos[1];\n      if (_ox === 0) {\n        result[0] = !this.root ? nodeW * _px - eOffsetX : targetDomW * _px - eOffsetX;\n      } else if (_ox === -1) {\n        result[0] = 0 - eOffsetX;\n      } else if (_ox === 1) {\n        result[0] = !this.root ? nodeW - eOffsetX : targetDomW - eOffsetX;\n      }\n\n      if (_oy === 0) {\n        result[1] = !this.root ? nodeH * _py - eOffsetY : targetDomH * _py - eOffsetY;\n      } else if (_oy === -1) {\n        result[1] = 0 - eOffsetY;\n      } else if (_oy === 1) {\n        result[1] = !this.root ? nodeH - eOffsetY : targetDomH - eOffsetY;\n      }\n      // 计算绝对定位\n      if (_currentNode && !this.root) {\n        _offsetTop += _currentNode.top;\n        _offsetLeft += _currentNode.left;\n      } else if (_currentNode && this.root) {\n        // 计算传入的dom距离跟节点\n        const nodeDomOffsets = _currentDom.offset();\n        const targetDomOffsets = targetDom.offset();\n        // 先计算目标节点和父节点得差值再加上父节点的offset\n        _offsetTop += (targetDomOffsets.top - nodeDomOffsets.top + _currentNode.top);\n        _offsetLeft += (targetDomOffsets.left - nodeDomOffsets.left + _currentNode.left);\n      }\n      this._top = result[1] + _offsetTop;\n      this._left = result[0] + _offsetLeft;\n      this._posTop = this._top;\n      this._posLeft = this._left;\n      if (_currentNodeType === 'node' && _currentNode._group) {\n        this._posTop += _currentNode._group.top;\n        this._posLeft += _currentNode._group.left;\n      }\n      $(dom)\n        .css('top', this._top)\n        .css('left', this._left);\n\n      this.updated && this.updated();\n    }\n  }\n\n  moveTo(x, y) {\n    this._top = y;\n    this._left = x;\n    this._posTop = this._top;\n    this._posLeft = this._left;\n    if (!this._isInitedDom) {\n      $(this.dom).css('top', y).css('left', x);\n      if (_.get(this, '_node._group')) {\n        this._posTop += this._node._group.top;\n        this._posLeft += this._node._group.left;\n      }\n    }\n  }\n\n  linkable() {\n    $(this.dom).addClass('linkable');\n  }\n\n  unLinkable() {\n    $(this.dom).removeClass('linkable');\n  }\n\n  hoverLinkable() {\n    $(this.dom).addClass('hover');\n  }\n\n  unHoverLinkable() {\n    $(this.dom).removeClass('hover');\n  }\n\n  attachEvent() {\n    $(this.dom).on('mousedown', (e) => {\n      const LEFT_KEY = 0;\n      if (e.button !== LEFT_KEY) {\n        return;\n      }\n      e.preventDefault();\n      e.stopPropagation();\n      this.emit('InnerEvents', {\n        type: 'endpoint:drag',\n        data: this\n      });\n    });\n  }\n  emit(type, data) {\n    super.emit(type, data);\n    this._emit(type, data);\n  }\n  destroy(isNotEvent) {\n    if (!isNotEvent) {\n      $(this.dom).off();\n      $(this.dom).remove();\n      this.removeAllListeners();\n    } else {\n      $(this.dom).detach();\n    }\n  }\n}\n\nexport default BaseEndpoint;\n","const $ = require('jquery');\nconst _ = require('lodash');\n\nimport Node from '../interface/node';\nimport Endpoint from '../endpoint/baseEndpoint';\n\nclass BaseNode extends Node {\n  constructor(opts) {\n    super(opts);\n    this.id = opts.id;\n    this.scope = opts.scope;\n    this.group = opts.group;\n    this.top = opts.top || 0;\n    this.left = opts.left || 0;\n    this.dom = opts.dom || null;\n    this.draggable = opts.draggable;\n    this.options = opts;\n    // 鸭子辨识手动判断类型\n    this.__type = 'node';\n    this._on = opts._on;\n    this._emit = opts._emit;\n    this._global = opts._global;\n    // endpoint 这部分需要考虑\n    this.endpoints = [];\n    this._endpointsData = opts.endpoints;\n    this._endpointLimitNum = opts._endpointLimitNum;\n    // 标识是否在移动做，兼容冒泡\n    this._isMoving = false;\n  }\n\n  draw(obj) {\n    let _dom = obj.dom;\n    if (!_dom) {\n      _dom = $('<div></div>')\n        .attr('class', 'node')\n        .attr('id', obj.id);\n    }\n    const node = $(_dom);\n    if (obj.top !== undefined) {\n      node.css('top', `${obj.top}px`);\n    }\n    if (obj.left !== undefined) {\n      node.css('left', `${obj.left}px`);\n    }\n    this.updated && this.updated();\n    return node[0];\n  }\n\n  focus() {}\n\n  unFocus() {}\n\n  addEndpoint(obj, isInited) {\n    if (isInited) {\n      this.emit('InnerEvents', {\n        type: 'node:addEndpoint',\n        data: obj,\n        isInited\n      });\n      return obj;\n    } \n    // 这部分可能还需要想一下\n    const EndpointClass = obj.Class || Endpoint;\n    const endpoint = new EndpointClass(_.assign({\n      _on: this._on,\n      _emit: this._emit,\n      _node: this,\n      _limitNum: obj.limitNum || this._endpointLimitNum,\n      _global: this.global\n    }, obj));\n    \n    this.emit('InnerEvents', {\n      type: 'node:addEndpoint',\n      data: endpoint\n    });\n\n    this.endpoints.push(endpoint);\n    return endpoint;\n  }\n\n  removeEndpoint(pointId) {\n    const rmEndpointIndex = _.findIndex(this.endpoints, point => point.id === pointId);\n    if (rmEndpointIndex !== -1) {\n      const rmEndpoint = this.endpoints.splice(rmEndpointIndex, 1)[0];\n      this.emit('InnerEvents', {\n        type: 'node:removeEndpoint',\n        data: rmEndpoint\n      });\n      rmEndpoint.destroy();\n      return rmEndpoint;\n    }\n  }\n\n  getEndpoint(pointId, type) {\n    return _.find(this.endpoints, (point) => {\n      if (!point.type || point.type === 'onlyConnect') {\n        return pointId === point.id;\n      } else {\n        return pointId === point.id && ((type && type === point.type) || !type);\n      }\n    });\n  }\n\n  _init(obj = {}) {\n    if (this._isInited) {\n      return;\n    }\n    // 这里可以抽象下，和constructor对比\n    if (obj.left) {\n      this.left = obj.left;\n    }\n    if (obj.top) {\n      this.top = obj.top;\n    }\n    if (obj._isDeleteGroup) {\n      this.group = undefined;\n      this._group = undefined;\n    } else {\n      obj.group && (this.group = obj.group);\n    }\n\n    delete obj._isDeleteGroup;\n    this._isInited = true;\n    if (obj.dom) {\n      this.dom = obj.dom;\n      obj.left && ($(this.dom).css('left', `${obj.left}px`));\n      obj.top && ($(this.dom).css('top', `${obj.top}px`));\n\n    } else {\n      this.dom = this.draw(_.assign({\n        id: this.id,\n        top: this.top,\n        left: this.left,\n        dom: this.dom,\n        options: this.options\n      }, obj));\n      this._addEventListener();\n    }\n  }\n  // drag的时候移动的api\n  _moveTo(x, y) {\n    // 自身移动\n    $(this.dom).css('top', y).css('left', x);\n    // 所在的点移动\n    this.endpoints.forEach((item) => {\n      item.moveTo(x - this.left + item._left, y - this.top + item._top);\n    });\n    this.top = y;\n    this.left = x;\n  }\n  moveTo(x, y, isNotEventEmit) {\n    this.emit('InnerEvents', {\n      type: 'node:move',\n      node: this,\n      x,\n      y,\n      isNotEventEmit\n    });\n  }\n\n  getWidth() {\n    return $(this.dom).outerWidth();\n  }\n\n  getHeight() {\n    return $(this.dom).outerHeight();\n  }\n\n  _createEndpoint(isInited) {\n    if (isInited) {\n      this.endpoints.forEach(item => this.addEndpoint(item, isInited));\n    } else if (this._endpointsData) {\n      this._endpointsData.map(item => this.addEndpoint(item));\n    }\n  }\n\n  _addEventListener() {\n    // todo 做事件代理的形式\n    $(this.dom).on('mousedown', (e) => {\n      const LEFT_KEY = 0;\n      if (e.button !== LEFT_KEY) {\n        return;\n      }\n      if (!['SELECT', 'INPUT', 'RADIO', 'CHECKBOX', 'TEXTAREA'].includes(e.target.nodeName)) {\n        e.preventDefault();\n      }\n      if (this.draggable) {\n        this._isMoving = true;\n        this.emit('InnerEvents', {\n          type: 'node:dragBegin',\n          data: this\n        });\n      } else {\n        // 单纯为了抛错事件给canvas，为了让canvas的dragtype不为空，不会触发canvas:click事件\n        this.emit('InnerEvents', {\n          type: 'node:mouseDown',\n          data: this\n        });\n      }\n    });\n\n    $(this.dom).on('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.emit('system.node.click', {\n        node: this\n      });\n      this.emit('events', {\n        type: 'node:click',\n        node: this\n      });\n    });\n\n    this.setDraggable(this.draggable);\n  }\n  setDraggable(draggable) {\n    this.draggable = draggable;\n  }\n  remove() {\n    this.emit('InnerEvents', {\n      type: 'node:delete',\n      data: this\n    });\n  }\n  emit(type, data) {\n    super.emit(type, data);\n    this._emit(type, data);\n  }\n  destroy(isNotEvent) {\n    if (!isNotEvent) {\n      this.endpoints.forEach((item) => {\n        !item._isInitedDom && item.destroy();\n      });\n      $(this.dom).remove();\n      this.removeAllListeners();\n    } else {\n      this.endpoints.forEach((item) => {\n        !item._isInitedDom && item.destroy(isNotEvent);\n      });\n      $(this.dom).detach();\n    }\n    this._isInited = false;\n  }\n}\n\nexport default BaseNode;\n","'use strict';\n\nconst _ = require('lodash');\n\nconst MINDIST = 20;\nconst TOL = 0.1;\nconst TOLxTOL = 0.01;\nconst TOGGLE_DIST = 20;\nconst LEFT = 'Left';\nconst RIGHT = 'Right';\nconst TOP = 'Top';\nconst BOTTOM = 'Bottom';\n\nconst Point = function(x, y) {\n  this.x = x;\n  this.y = y;\n}\n\nfunction drawBezier(sourcePoint, targetPoint) {\n\n  if (!sourcePoint.orientation) {\n    sourcePoint.orientation = _calcOrientation(targetPoint.pos[0], targetPoint.pos[1], sourcePoint.pos[0], sourcePoint.pos[1]);\n  }\n\n  if (!targetPoint.orientation) {\n    targetPoint.orientation = _calcOrientation(sourcePoint.pos[0], sourcePoint.pos[1], targetPoint.pos[0], targetPoint.pos[1]);\n  }\n\n  // 控制点\n\n  let _width = Math.abs(sourcePoint.pos[0] - targetPoint.pos[0]);\n  let _height = Math.abs(sourcePoint.pos[1] - targetPoint.pos[1]);\n\n  let _sx = sourcePoint.pos[0] < targetPoint.pos[0] ? _width : 0;\n  let _sy = sourcePoint.pos[1] < targetPoint.pos[1] ? _height : 0;\n  let _tx = sourcePoint.pos[0] < targetPoint.pos[0] ? 0 : _width;\n  let _ty = sourcePoint.pos[1] < targetPoint.pos[1] ? 0 : _height;\n  let _so = sourcePoint.orientation;\n  let _to = targetPoint.orientation;\n\n  let sourceCtrlPoint = _findControlPoint([_sx, _sy], sourcePoint, targetPoint, _so, _to);\n  let targetCtrlPoint = _findControlPoint([_tx, _ty], targetPoint, sourcePoint, _to, _so);\n\n\n  let offsetX = sourcePoint.pos[0] < targetPoint.pos[0] ? sourcePoint.pos[0] : targetPoint.pos[0];\n  let offsetY = sourcePoint.pos[1] < targetPoint.pos[1] ? sourcePoint.pos[1] : targetPoint.pos[1];\n\n  sourceCtrlPoint = [sourceCtrlPoint[0] + offsetX, sourceCtrlPoint[1] + offsetY];\n  targetCtrlPoint = [targetCtrlPoint[0] + offsetX, targetCtrlPoint[1] + offsetY];\n\n  // 起始点\n  let result = ['M', sourcePoint.pos[0], sourcePoint.pos[1]];\n  // 两个控制点\n  result = result.concat(['C', targetCtrlPoint[0], targetCtrlPoint[1], sourceCtrlPoint[0], sourceCtrlPoint[1]]);\n  // 结束点\n  result = result.concat([targetPoint.pos[0], targetPoint.pos[1]]);\n\n  return result.join(' ');\n}\n\nfunction drawAdvancedBezier(sourcePoint, targetPoint) {\n\n  if (!sourcePoint.orientation) {\n    sourcePoint.orientation = _calcOrientation(targetPoint.pos[0], targetPoint.pos[1], sourcePoint.pos[0], sourcePoint.pos[1]);\n  }\n\n  if (!targetPoint.orientation) {\n    targetPoint.orientation = _calcOrientation(sourcePoint.pos[0], sourcePoint.pos[1], targetPoint.pos[0], targetPoint.pos[1]);\n  }\n\n  // 控制点\n\n  let _width = Math.abs(sourcePoint.pos[0] - targetPoint.pos[0]);\n  let _height = Math.abs(sourcePoint.pos[1] - targetPoint.pos[1]);\n\n  let _so = sourcePoint.orientation;\n  let _to = targetPoint.orientation;\n\n  const dist = Math.sqrt(_width * _width + _height * _height);\n  // 控制点百分比，可转配置\n  const percent = 0.25;\n  // 偏差量，可转配置\n  const minorDist = 30;\n  let so_offsetX = 0;\n  let so_offsetY = 0;\n  if (_so[0] !== 0) {\n    so_offsetX = (dist * percent + minorDist) * _so[0];\n  } else if (_so[1] !== 0) {\n    so_offsetY = (dist * percent + minorDist) * _so[1];\n  }\n\n  let to_offsetX = 0;\n  let to_offsetY = 0;\n  if (_to[0] !== 0) {\n    to_offsetX = (dist * percent + minorDist) * _to[0];\n  } else if (_to[1] !== 0) {\n    to_offsetY = (dist * percent + minorDist) * _to[1];\n  }\n\n  const sourceCtrlPoint = [sourcePoint.pos[0] + so_offsetX, sourcePoint.pos[1] + so_offsetY];\n  const targetCtrlPoint = [targetPoint.pos[0] + to_offsetX, targetPoint.pos[1] + to_offsetY];\n\n  // 起始点\n  let result = ['M', sourcePoint.pos[0], sourcePoint.pos[1]];\n  // let result = ['M', targetPoint.pos[0], targetPoint.pos[1]];\n  // 两个控制点\n  result = result.concat(['C', sourceCtrlPoint[0], sourceCtrlPoint[1]], targetCtrlPoint[0], targetCtrlPoint[1]);\n  // result = result.concat(['C', targetCtrlPoint[0], targetCtrlPoint[1], sourceCtrlPoint[0], sourceCtrlPoint[1]]);\n  // 结束点\n  result = result.concat([targetPoint.pos[0], targetPoint.pos[1]]);\n  // result = result.concat([sourcePoint.pos[0], sourcePoint.pos[1]]);\n\n  return result.join(' ');\n}\n\nfunction drawStraight(sourcePoint, targetPoint) {\n  let result = ['M', sourcePoint.pos[0], sourcePoint.pos[1], 'L', targetPoint.pos[0], targetPoint.pos[1]];\n  return result.join(' ');\n}\n\nfunction drawFlow(sourcePoint, targetPoint, orientationLimit) {\n  if (!sourcePoint.orientation) {\n    sourcePoint.orientation = _calcOrientation(targetPoint.pos[0], targetPoint.pos[1], sourcePoint.pos[0], sourcePoint.pos[1], orientationLimit);\n  }\n\n  if (!targetPoint.orientation) {\n    targetPoint.orientation = _calcOrientation(sourcePoint.pos[0], sourcePoint.pos[1], targetPoint.pos[0], targetPoint.pos[1], orientationLimit);\n  }\n\n  let stub = 30; // 每部分折线的最小长度\n  let midpoint = 0.5; // 折线中点\n  let w = Math.abs(sourcePoint.pos[0] - targetPoint.pos[0]);\n  let h = Math.abs(sourcePoint.pos[1] - targetPoint.pos[1]);\n  let sx = targetPoint.pos[0] < sourcePoint.pos[0] ? w : 0;\n  let sy = targetPoint.pos[1] < sourcePoint.pos[1] ? h : 0;\n  let tx = targetPoint.pos[0] < sourcePoint.pos[0] ? 0 : w;\n  let ty = targetPoint.pos[1] < sourcePoint.pos[1] ? 0 : h;\n  let offsetX = sourcePoint.pos[0] < targetPoint.pos[0] ? sourcePoint.pos[0] : targetPoint.pos[0];\n  let offsetY = sourcePoint.pos[1] < targetPoint.pos[1] ? sourcePoint.pos[1] : targetPoint.pos[1];\n  // 小心有可能so[0]和to[0]同时为0；或者是so[1]和to[1]同时为0\n  let so = sourcePoint.orientation;\n  let to = targetPoint.orientation;\n  // 拿来判断是对面，垂直还是正交\n  let oProduct = ((so[0] * to[0]) + (so[1] * to[1]));\n\n  let sourceAxis = so[0] === 0 ? 'y' : 'x';\n\n  let startStubX = sx + (so[0] * stub);\n  let startStubY = sy + (so[1] * stub);\n  let endStubX = tx + (to[0] * stub);\n  let endStubY = ty + (to[1] * stub);\n\n  let isXGreaterThanStubTimes2 = Math.abs(sx - tx) > (stub + stub);\n  let isYGreaterThanStubTimes2 = Math.abs(sy - ty) > (stub + stub);\n\n  // 判断方向\n  let anchorOrientation = null;\n  if (oProduct === -1) {\n    anchorOrientation = 'opposite';\n  } else if (oProduct === 0) {\n    anchorOrientation = 'perpendicular';\n  } else if (oProduct === 1) {\n    anchorOrientation = 'orthogonal';\n  }\n\n  // 计算折线的方法\n  let _commonStubCalculator = () => {\n    return [startStubX, startStubY, endStubX, endStubY];\n  };\n  let stubCalculators = {\n    perpendicular: _commonStubCalculator,\n    orthogonal: _commonStubCalculator,\n    opposite: (axis) => {\n      let idx = axis === 'x' ? 0 : 1;\n      let areInProximity = {\n        x: () => {\n          return ( (so[idx] === 1 && (\n            ( (startStubX > endStubX) && (tx > startStubX) ) ||\n            ( (sx > endStubX) && (tx > sx))))) ||\n            ( (so[idx] === -1 && (\n              ( (startStubX < endStubX) && (tx < startStubX) ) ||\n              ( (sx < endStubX) && (tx < sx)))));\n        },\n        y: () => {\n          return ( (so[idx] === 1 && (\n            ( (startStubY > endStubY) && (ty > startStubY) ) ||\n            ( (sy > endStubY) && (ty > sy))))) ||\n\n            ( (so[idx] === -1 && (\n                ( (startStubY < endStubY) && (ty < startStubY) ) ||\n                ( (sy < endStubY) && (ty < sy)))));\n        }\n      };\n      \n      // 判断是否需要折线\n      if (areInProximity[axis]()) { // 这判断可以设置总是有折线\n        return {\n          x: [(sx + tx) / 2, startStubY, (sx + tx) / 2, endStubY],\n          y: [startStubX, (sy + ty) / 2, endStubX, (sy + ty) / 2]\n        }[axis];\n      } else {\n        return [startStubX, startStubY, endStubX, endStubY];\n      }\n    }\n  };\n\n  // 加工线条处理的方法\n  let lastx = null;\n  let lasty = null;\n  let segments = [];\n  let _sgn = (n) => {\n    return n < 0 ? -1 : n === 0 ? 0 : 1;\n  };\n  let _addSegment = (x, y) => {\n    if (lastx === x && lasty === y) {\n      return;\n    }\n    let lx = lastx == null ? sx : lastx;\n    let ly = lasty == null ? sy : lasty;\n    let o = lx === x ? 'v': 'h';\n    let sgnx = _sgn(x - lx);\n    let sgny = _sgn(y - ly);\n\n    lastx = x;\n    lasty = y;\n\n    segments.push([lx, ly, x, y, o, sgnx, sgny]);\n  };\n\n  // 开始实现\n  let stubs = stubCalculators[anchorOrientation](sourceAxis);\n  let idx = sourceAxis === 'x' ? 0 : 1;\n  let oidx = sourceAxis === 'x' ? 0 : 1;\n  let ss = stubs[idx];\n  let oss = stubs[oidx];\n  let es = stubs[idx + 2];\n  let oes = stubs[oidx + 2];\n\n  _addSegment(stubs[0], stubs[1]);\n\n  let midx = startStubX + (endStubX - startStubX) * midpoint;\n  let midy = startStubY + (endStubY - startStubY) * midpoint;\n\n  let orientations = { x: [ 0, 1 ], y: [ 1, 0 ] };\n  let _lineCalculators = {\n    perpendicular: (axis) => {\n      let sis = {\n        x: [\n          [[1, 2, 3, 4], null, [2, 1, 4, 3]],\n          null,\n          [[4, 3, 2, 1], null, [3, 4, 1, 2]]\n        ],\n        y: [\n          [[3, 2, 1, 4], null, [2, 3, 4, 1]],\n          null,\n          [[4, 1, 2, 3], null, [1, 4, 3, 2]]\n        ]\n      };\n      let stubs = {\n        x: [[startStubX, endStubX], null, [endStubX, startStubX]],\n        y: [[startStubY, endStubY], null, [endStubY, startStubY]]\n      };\n      let midLines = {\n        x: [[midx, startStubY], [midx, endStubY]],\n        y: [[startStubX, midy], [endStubX, midy]]\n      };\n      let linesToEnd = {\n        x: [[endStubX, startStubY]],\n        y: [[startStubX, endStubY]]\n      };\n      let startToEnd = {\n        x: [[startStubX, endStubY], [endStubX, endStubY]],\n        y: [[endStubX, startStubY], [endStubX, endStubY]]\n      };\n      let startToMidToEnd = {\n        x: [[startStubX, midy], [endStubX, midy], [endStubX, endStubY]],\n        y: [[midx, startStubY], [midx, endStubY], [endStubX, endStubY]]\n      };\n      let otherStubs = {\n        x: [startStubY, endStubY],\n        y: [startStubX, endStubX]\n      };\n      let soIdx = orientations[axis][0];\n      let toIdx = orientations[axis][1];\n      let _so = so[soIdx] + 1;\n      let _to = to[toIdx] + 1;\n      let otherFlipped = (to[toIdx] === -1 && (otherStubs[axis][1] < otherStubs[axis][0])) || (to[toIdx] === 1 && (otherStubs[axis][1] > otherStubs[axis][0]));\n      let stub1 = stubs[axis][_so][0];\n      let stub2 = stubs[axis][_so][1];\n      let segmentIndexes = sis[axis][_so][_to];\n\n      // 计算一下节点象限\n      let _quadrant = (p1, p2) => {\n        if (p2.pos[0] > p1.pos[0]) {\n          return (p2.pos[1] > p1.pos[1]) ? 2 : 1;\n        } else if (p2.pos[0] == p1.pos[0]) {\n          return p2.pos[1] > p1.pos[1] ? 2 : 1;\n        } else {\n          return (p2.pos[1] > p1.pos[1]) ? 3 : 4;\n        }\n      };\n      var segment = _quadrant(sourcePoint, targetPoint);\n      if (segment === segmentIndexes[3] || (segment === segmentIndexes[2] && otherFlipped)) {\n        return midLines[axis];\n      } else if (segment === segmentIndexes[2] && stub2 < stub1) {\n        return linesToEnd[axis];\n      } else if ((segment === segmentIndexes[2] && stub2 >= stub1) || (segment === segmentIndexes[1] && !otherFlipped)) {\n        return startToMidToEnd[axis];\n      } else if (segment === segmentIndexes[0] || (segment === segmentIndexes[1] && otherFlipped)) {\n        return startToEnd[axis];\n      }\n    },\n    orthogonal: (axis, startStub, otherStartStub, endStub, otherEndStub) => {\n      let extent = {\n        x: so[0] === -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub),\n        y: so[1] === -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub)\n      }[axis];\n\n      return {\n        x: [\n          [extent, otherStartStub],\n          [extent, otherEndStub],\n          [endStub, otherEndStub]\n        ],\n        y: [\n          [otherStartStub, extent],\n          [otherEndStub, extent],\n          [otherEndStub, endStub]\n        ]\n      }[axis];\n    },\n    opposite: (axis, ss, oss, es) => {\n      let otherAxis = {x: 'y', y: 'x'}[axis];\n      let dim = {x: 'height', y: 'width'}[axis];\n      let comparator = axis === 'x' ? isXGreaterThanStubTimes2 : isYGreaterThanStubTimes2;\n\n      // 考虑下自连的情况, 现在很不严禁\n      if (sourcePoint.pos[0] === targetPoint.pos[0] && sourcePoint.pos[1] === targetPoint.pos[1]) {\n        //\n      } else if (!comparator || (so[idx] === 1 && ss > es) || (so[idx] === -1 && ss < es)) {\n        return {\n          x: [\n            [ss, midy],\n            [es, midy]\n          ],\n          y: [\n            [midx, ss],\n            [midx, es]\n          ]\n        }[axis];\n      } else if ((so[idx] === 1 && ss < es) || (so[idx] === -1 && ss > es)) {\n        return {\n          x: [\n            [midx, sy],\n            [midx, ty]\n          ],\n          y: [\n            [sx, midy],\n            [tx, midy]\n          ]\n        }[axis];\n      }\n    }\n  };\n\n  // 计算剩余线条\n  var p = _lineCalculators[anchorOrientation](sourceAxis, ss, oss, es, oes);\n  if (p) {\n    for (let i = 0; i < p.length; p++) {\n      _addSegment(p[i][0], p[i][1]);\n    }\n  }\n\n  // line to end stub\n  _addSegment(stubs[2], stubs[3]);\n\n  // end stub to end (common)\n  _addSegment(tx, ty);\n\n  // 实际操作svg\n  return _drawFlowSegment(segments, {\n    x: offsetX,\n    y: offsetY\n  });\n}\n\nfunction drawManhattan(sourcePoint, targetPoint) {\n  if (!sourcePoint.orientation) {\n    sourcePoint.orientation = _calcOrientation(targetPoint.pos[0], targetPoint.pos[1], sourcePoint.pos[0], sourcePoint.pos[1]);\n  }\n\n  if (!targetPoint.orientation) {\n    targetPoint.orientation = _calcOrientation(sourcePoint.pos[0], sourcePoint.pos[1], targetPoint.pos[0], targetPoint.pos[1]);\n  }\n\n  const pointArr = [];\n  const fromPt = {\n    x: sourcePoint.pos[0],\n    y: sourcePoint.pos[1],\n  };\n  const toPt = {\n    x: targetPoint.pos[0],\n    y: targetPoint.pos[1],\n  };\n  const orientation = {\n    '-10': LEFT,\n    '10': RIGHT,\n    '0-1': TOP,\n    '01': BOTTOM,\n  };\n  // link:connect 中 orientation = undefined\n  _route(pointArr, fromPt, orientation[sourcePoint.orientation.join('')], toPt, orientation[targetPoint.orientation.join('')]);\n  if (pointArr.length < 2) return '';\n  const path = pointArr.reduce((path, point) => {\n    path.push([\n      'L',\n      point.x,\n      point.y\n    ].join(' '));\n    return path;\n  }, [[\n    'M',\n    pointArr[0].x,\n    pointArr[0].y\n  ].join(' ')]).join(' ');\n  return path;\n}\n\nfunction _drawFlowSegment(segments, offset) {\n  let current = null;\n  let next = null;\n  let cornerRadius = 0; // 拐角角度，按道理可以配置\n  let lw = 1; // strokeWidth，线条的粗细\n  let _segLength = (s) => {\n    return Math.sqrt(Math.pow(s[0] - s[2], 2) + Math.pow(s[1] - s[3], 2));\n  };\n  let result = [];\n  let _drawStraight = (d) => {\n    return ['M', d.x1 + offset.x, d.y1 + offset.y, 'L', d.x2 + offset.x, d.y2 + offset.y];\n  };\n  let _drawArc = (d) => {\n\n    // 有重复，可抽象，计算象限\n    let _quadrant = (p1, p2) => {\n      if (p2[0] > p1[0]) {\n        return (p2[1] > p1[1]) ? 2 : 1;\n      } else if (p2[0] === p1[0]) {\n        return p2[1] > p1[1] ? 2 : 1;\n      } else {\n        return (p2[1] > p1[1]) ? 3 : 4;\n      }\n    };\n    // 计算两点之间的直线的梯度\n    let _gradient = (p1, p2) => {\n      if (p2[0] === p1[0]) {\n        return p2[1] > p1[0] ? Infinity : -Infinity;\n      } else if (p2[1] === p1[1]) {\n        return p2[0] > p1[0] ? 0 : -0;\n      } else {\n        return (p2[1] - p1[1]) / (p2[0] - p1[0]);\n      }\n    };\n    // Calculates the angle between the two points\n    let _theta = (p1, p2) => {\n      let m = _gradient(p1, p2);\n      let t = Math.atan(m);\n      let s = _quadrant(p1, p2);\n      if ((s === 4 || s === 3)) {\n        t += Math.PI;\n      }\n      if (t < 0) {\n        t += (2 * Math.PI);\n      }\n      return t;\n    };\n\n    let _calcAngle = function (x, y) {\n      return _theta([d.cx, d.cy], [x, y]);\n    };\n\n    let startAngle = _calcAngle(x1, y1);\n    let endAngle = _calcAngle(x2, y2);\n    let TWO_PI = 2 * Math.PI;\n    if (endAngle < 0) {\n      endAngle += TWO_PI;\n    }\n    if (startAngle < 0) {\n      startAngle += TWO_PI;\n    }\n    // we now have startAngle and endAngle as positive numbers, meaning the\n    // absolute difference (|d|) between them is the sweep (s) of this arc, unless the\n    // arc is 'anticlockwise' in which case 's' is given by 2PI - |d|.\n    let ea = endAngle < startAngle ? endAngle + TWO_PI : endAngle;\n    let sweep = Math.abs(ea - startAngle);\n    let anticlockwise = d.ac;\n\n    if (anticlockwise) {\n      sweep = TWO_PI - sweep;\n    }\n\n    return ['M', d.x1 + offset.x, d.y1 + offset.y, 'A', d.r, d.r, '0', ',', d.x2 + offset.x, d.y2 + offset.y];\n  };\n\n  // let offsetX = sourcePoint.pos[0] < targetPoint.pos[0] ? sourcePoint.pos[0] : targetPoint.pos[0];\n  // let offsetY = sourcePoint.pos[1] < targetPoint.pos[1] ? sourcePoint.pos[1] : targetPoint.pos[1];\n\n  for (let i = 0; i < segments.length - 1; i++) {\n    current = current || _.cloneDeep(segments[i]);\n    next = _.cloneDeep(segments[i + 1]);\n    if (cornerRadius > 0 && current[4] !== next[4]) {\n      let radiusToUse = Math.min(cornerRadius, _segLength(current), _segLength(next));\n      // right angle. adjust current segment's end point, and next segment's start point.\n      current[2] -= current[5] * radiusToUse;\n      current[3] -= current[6] * radiusToUse;\n      next[0] += next[5] * radiusToUse;\n      next[1] += next[6] * radiusToUse;\n      let ac = (current[6] === next[5] && next[5] === 1) ||\n            ((current[6] === next[5] && next[5] === 0) && current[5] !== next[6]) ||\n            (current[6] === next[5] && next[5] === -1);\n      let sgny = next[1] > current[3] ? 1 : -1;\n      let sgnx = next[0] > current[2] ? 1 : -1;\n      let sgnEqual = sgny === sgnx;\n      let cx = (sgnEqual && ac || (!sgnEqual && !ac)) ? next[0] : current[2];\n      let cy = (sgnEqual && ac || (!sgnEqual && !ac)) ? current[3] : next[1];\n\n      let _line1 = _drawStraight({\n        x1: current[0],\n        y1: current[1],\n        x2: current[2],\n        y2: current[3]\n      });\n      let _line2 = _drawArc({\n        r: radiusToUse,\n        x1: current[2],\n        y1: current[3],\n        x2: next[0],\n        y2: next[1],\n        cx: cx,\n        cy: cy,\n        ac: ac\n      });\n      result = result.concat(_line1);\n      result = result.concat(_line2);\n    } else {\n      // dx + dy are used to adjust for line width.\n      let dx = (current[2] === current[0]) ? 0 : (current[2] > current[0]) ? (lw / 2) : -(lw / 2);\n      let dy = (current[3] === current[1]) ? 0 : (current[3] > current[1]) ? (lw / 2) : -(lw / 2);\n      let _line = _drawStraight({\n        x1: current[0] - dx,\n        y1: current[1] - dy,\n        x2: current[2] + dx,\n        y2: current[3] + dy\n      });\n      result = result.concat(_line);\n    }\n    current = next;\n  }\n  if (next !== null) {\n    let _line = _drawStraight({\n      x1: next[0],\n      y1: next[1],\n      x2: next[2],\n      y2: next[3]\n    });\n    result = result.concat(_line);\n  }\n  return result.join(' ');\n}\n\nfunction _calcOrientation(beginX, beginY, endX, endY, orientationLimit) {\n\n  let _calcWithLimit = (rank) => {\n    if (orientationLimit) {\n      for (let i = 0; i < rank.length; i++) {\n        let isInLimit = _.some(orientationLimit, (limit) => {\n          return limit === rank[i];\n        });\n        if (isInLimit) {\n          return rank[i];\n        }\n      }\n      return rank[0];\n    } else {\n      return rank[0];\n    }\n  };\n  // 计算orientation\n  let posX = endX - beginX;\n  let posY = endY - beginY;\n  let orientation = null;\n\n  // 斜率\n  let k = Math.abs(posY / posX);\n\n  if (posX === 0 || posY === 0) {\n    if (posX === 0) {\n      orientation = posY >= 0 ? _calcWithLimit(['Top', 'Left', 'Right', 'Bottom']) : orientation;\n      orientation = posY < 0 ? _calcWithLimit(['Bottom', 'Left', 'Right', 'Top']) : orientation;\n    }\n    if (posY === 0) {\n      orientation = posX >= 0 ? _calcWithLimit(['Right', 'Top', 'Bottom', 'Left']) : orientation;\n      orientation = posX < 0 ? _calcWithLimit(['Left', 'Top', 'Bottom', 'Right']) : orientation;\n    }\n  } else if (posX > 0 && posY > 0) {\n    if (k > 1) {\n      orientation = _calcWithLimit(['Top', 'Left', 'Right', 'Bottom']);\n      // orientation = [0, -1];\n    } else {\n      orientation = _calcWithLimit(['Left', 'Top', 'Bottom', 'Right']);\n      // orientation = [-1, 0];\n    }\n  } else if (posX < 0 && posY > 0) {\n    if (k > 1) {\n      orientation = _calcWithLimit(['Top', 'Right', 'Left', 'Bottom']);\n      // orientation = [0, -1];\n    } else {\n      orientation = _calcWithLimit(['Right', 'Top', 'Bottom', 'Left']);\n      // orientation = [1, 0];\n    }\n  } else if (posX < 0 && posY < 0) {\n    if (k > 1) {\n      orientation = _calcWithLimit(['Bottom', 'Right', 'Left', 'Top']);\n      // orientation = [0, 1];\n    } else {\n      orientation = _calcWithLimit(['Right', 'Bottom', 'Top', 'Left']);\n      // orientation = [1, 0];\n    }\n  } else {\n    if (k > 1) {\n      orientation = _calcWithLimit(['Bottom', 'Left', 'Right', 'Top']);\n      // orientation = [0, 1];\n    } else {\n      orientation = _calcWithLimit(['Left', 'Bottom', 'Top', 'Right']);\n      // orientation = [-1, 0];\n    }\n  }\n\n  switch (orientation) {\n    case 'Left':\n      return [-1, 0];\n    case 'Right':\n      return [1, 0];\n    case 'Top':\n      return [0, -1];\n    case 'Bottom':\n      return [0, 1];\n  }\n}\n\nfunction _findControlPoint(point, sourcePoint, targetPoint, _so, _to) {\n\n  // 曲率，可配置的\n  let majorAnchor = 10;\n  // 偏移，定死的\n  let minorAnchor = 10;\n\n  let result = [];\n\n  // 特殊处理完全水平和垂直的情况\n  if (sourcePoint.pos[0] === targetPoint.pos[0] && _so[1] !== _to[1] && _so[0] === 0 && _to[0] === 0) {\n    result = [point[0], point[1] + majorAnchor * _so[1]];\n    return result;\n  }\n\n  if (sourcePoint.pos[1] === targetPoint.pos[1] && _so[0] !== _to[0] && _so[1] === 0 && _to[1] === 0) {\n    result = [point[0] + majorAnchor * _so[0], point[1]];\n    return result;\n  }\n\n  // 平常情况\n  var perpendicular = _so[0] !== _to[0] || _so[1] === _to[1];\n  if (!perpendicular) {\n    if (_so[0] === 0) {\n      result.push(sourcePoint.pos[0] < targetPoint.pos[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\n    } else {\n      result.push(point[0] - (majorAnchor * _so[0]));\n    }\n\n    if (_so[1] === 0) {\n      result.push(sourcePoint.pos[1] < targetPoint.pos[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\n    } else {\n      result.push(point[1] - (majorAnchor * _to[1]));\n    }\n  } else {\n    if (_to[0] === 0) {\n      result.push(targetPoint.pos[0] < sourcePoint.pos[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\n    } else {\n      result.push(point[0] + (majorAnchor * _to[0]));\n    }\n\n    if (_to[1] === 0) {\n      result.push(targetPoint.pos[1] < sourcePoint.pos[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\n    } else {\n      result.push(point[1] + (majorAnchor * _so[1]));\n    }\n  }\n  return result;\n}\n\n// 曼哈顿折线路由算法\nfunction _route(conn, fromPt, fromDir, toPt, toDir) {\n\n  // 防止图上节点隐藏NaN的死循环问题\n  fromPt.x = fromPt.x || 0;\n  fromPt.y = fromPt.y || 0;\n  toPt.x = toPt.x || 0;\n  toPt.y = toPt.y || 0;\n\n  const xDiff = fromPt.x - toPt.x;\n  const yDiff = fromPt.y - toPt.y;\n  let point;\n  let dir;\n  let pos;\n\n  conn.push(new Point(fromPt.x, fromPt.y));\n\n  if (((xDiff * xDiff) < (TOLxTOL)) && ((yDiff * yDiff) < (TOLxTOL))) {\n    conn.push(new Point(toPt.x, toPt.y));\n    return;\n  }\n\n  if (fromDir === LEFT) {\n    if ((xDiff > 0) && ((yDiff * yDiff) < TOL) && (toDir === RIGHT)) {\n      point = toPt\n      dir = toDir\n    }\n    else {\n      if (xDiff < 0) {\n        point = new Point(fromPt.x - MINDIST, fromPt.y);\n      }\n      else if (((yDiff > 0) && (toDir === BOTTOM)) || ((yDiff < 0) && (toDir === TOP))) {\n        point = new Point(toPt.x, fromPt.y);\n      }\n      else if (fromDir === toDir) {\n        pos = Math.min(fromPt.x, toPt.x) - MINDIST\n        point = new Point(pos, fromPt.y);\n      }\n      else {\n        point = new Point(fromPt.x - (xDiff / 2), fromPt.y);\n      }\n\n      if (yDiff > 0) {\n        dir = TOP\n      }\n      else {\n        dir = BOTTOM\n      }\n    }\n  } else if (fromDir === RIGHT) {\n    if ((xDiff < 0) && ((yDiff * yDiff) < TOL) && (toDir === LEFT)) {\n      point = toPt\n      dir = toDir\n    }\n    else {\n      if (xDiff > 0) {\n        point = new Point(fromPt.x + MINDIST, fromPt.y);\n      }\n      else if (((yDiff > 0) && (toDir === BOTTOM)) || ((yDiff < 0) && (toDir === TOP))) {\n        point = new Point(toPt.x, fromPt.y);\n      }\n      else if (fromDir === toDir) {\n        pos = Math.max(fromPt.x, toPt.x) + MINDIST\n        point = new Point(pos, fromPt.y);\n      }\n      else {\n        point = new Point(fromPt.x - (xDiff / 2), fromPt.y);\n      }\n\n      if (yDiff > 0) {\n        dir = TOP\n      }\n      else {\n        dir = BOTTOM\n      }\n    }\n  } else if (fromDir === BOTTOM) {\n    if (((xDiff * xDiff) < TOL) && (yDiff < 0) && (toDir === TOP)) {\n      point = toPt\n      dir = toDir\n    }\n    else {\n      if (yDiff > 0) {\n        point = new Point(fromPt.x, fromPt.y + MINDIST)\n      }\n      else if (((xDiff > 0) && (toDir === RIGHT)) || ((xDiff < 0) && (toDir === LEFT))) {\n        point = new Point(fromPt.x, toPt.y)\n      }\n      else if (fromDir === toDir) {\n        pos = Math.max(fromPt.y, toPt.y) + MINDIST\n        point = new Point(fromPt.x, pos)\n      }\n      else {\n        point = new Point(fromPt.x, fromPt.y - (yDiff / 2))\n      }\n\n      if (xDiff > 0) {\n        dir = LEFT\n      }\n      else {\n        dir = RIGHT\n      }\n    }\n  } else if (fromDir === TOP) {\n    if (((xDiff * xDiff) < TOL) && (yDiff > 0) && (toDir === BOTTOM)) {\n      point = toPt\n      dir = toDir\n    }\n    else {\n      if (yDiff < 0) {\n        point = new Point(fromPt.x, fromPt.y - MINDIST)\n      }\n      else if (((xDiff > 0) && (toDir === RIGHT)) || ((xDiff < 0) && (toDir === LEFT))) {\n        point = new Point(fromPt.x, toPt.y)\n      }\n      else if (fromDir === toDir) {\n        pos = Math.min(fromPt.y, toPt.y) - MINDIST\n        point = new Point(fromPt.x, pos)\n      }\n      else {\n        point = new Point(fromPt.x, fromPt.y - (yDiff / 2))\n      }\n\n      if (xDiff > 0) {\n        dir = LEFT\n      }\n      else {\n        dir = RIGHT\n      }\n    }\n  }\n  _route(conn, point, dir, toPt, toDir);\n}\n\nexport default {\n  drawBezier,\n  drawAdvancedBezier,\n  drawStraight,\n  drawFlow,\n  drawManhattan\n};\n","'use strict';\nimport _ from 'lodash';\n\n// todo:丰富箭头样式\nconst arrow = {\n    default1: 'M0 0 L-3 3 L2 0 L-3 -3 Z',\n    default: `M5 0 L0 -2 Q 1.0 0 0 2 Z`,\n    length: 5,\n};\n\n// 计算线条某个位置的斜率\nfunction calcSlope(opts) {\n  let shapeType = _.get(opts, 'shapeType');\n  let dom = _.get(opts, 'dom');\n  let arrowPosition = _.get(opts, 'arrowPosition', 0.5);\n  let path = _.get(opts, 'path');\n  let coordinates = path.split(' ');\n  let x = 0;\n  let y = 0;\n  \n  if (shapeType === 'BezierTest' || shapeType === 'AdvancedBezierTest') {\n    let p0 = {x: coordinates[8], y: coordinates[9]};\n    let p1 = {x: coordinates[1], y: coordinates[2]};\n\n    if (arrowPosition !== 1) {\n      p0 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition + 0.001);\n      p1 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition);\n    } else {\n      p0 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition);\n      p1 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition - 0.001);\n    }\n\n    x = p1.x - p0.x;\n    y = p1.y - p0.y;\n  } else if (shapeType === 'Straight') {\n    let p0 = {x: coordinates[1], y: coordinates[2]};\n    let p1 = {x: coordinates[4], y: coordinates[5]};\n\n    x = p1.x - p0.x;\n    y = p1.y - p0.y;\n  } else {\n    let p0 = 0;\n    let p1 = 1;\n\n    if (arrowPosition !== 1) {\n      p0 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition);\n      p1 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition + 0.001);\n    } else {\n      p0 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition - 0.001);\n      p1 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition);\n    }\n    \n\n    x = p1.x - p0.x;\n    y = p1.y - p0.y;\n  }\n  \n  return {x, y};\n}\n\nexport default {\n  calcSlope,\n  arrow\n};\n","'use strict';\n\nconst $ = require('jquery');\n\nlet svg = null;\n\nlet _initTime = new Date().getTime();\n\nlet init = (_svg) => {\n  svg = _svg;\n  _initTime = new Date().getTime();\n}\n\nlet addAnimate = (targetDom, path, options = {}, animateDom) => {\n  let _animateDom = animateDom;\n  let circle = null;\n  let motion = null;\n  if (!_animateDom) {\n    circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n    motion = document.createElementNS('http://www.w3.org/2000/svg', 'animateMotion');\n    circle.append(motion);\n  }\n\n  if (options._isContinue) {\n    $(_animateDom).find('animateMotion').attr('path', path);\n  } else {\n    let _startTime = (new Date().getTime() - _initTime) / 1000;\n\n    if (_animateDom) {\n      circle = _animateDom;\n      motion = $(_animateDom).find('animateMotion')[0];\n      $(circle).css('display', 'block');\n    }\n\n    circle.setAttribute('cx', 0);\n    circle.setAttribute('cy', 0);\n    circle.setAttribute('r', options.radius || 2);\n    circle.setAttribute('fill', options.color || '#999');\n\n    motion.setAttribute('path', path);\n    motion.setAttribute('begin', `${_startTime}s`);\n    motion.setAttribute('dur', options.dur || '8s');\n    motion.setAttribute('fill', 'freeze');\n    motion.setAttribute('repeatCount', options.repeatCount || 'indefinite');\n\n    if (options.repeatCount && options.repeatCount !== 'indefinite') {\n      setTimeout(() => {\n        $(circle).css('display', 'none');\n      }, parseFloat(options.dur) * parseInt(options.repeatCount) * 1000);\n    }\n  }\n\n  if (!_animateDom) {\n    _animateDom = circle;\n    $(_animateDom).insertAfter(targetDom);\n  }\n\n  return _animateDom;\n}\n\nexport default {\n  init,\n  addAnimate\n}","'use strict';\n\nconst EventEmit3 = require('eventemitter3');\n\nclass Edge extends EventEmit3 {\n  constructor() {\n    // id                 节点唯一标志\n    // targetNode         目标节点\n    // targetEndpoint     目标锚点\n    // sourceNode         源节点\n    // sourceEndpoint     源锚点\n    // type               \"node\" or \"endpoint\"，标志类型的\n    // shapeType          线条类型\n    // label              设置线条上的字体\n    // options            数据的透传\n    // dom                线条dom\n    // labelDom           label的dom\n    // arrowDom           箭头的dom\n\n    \n    // 箭头部分看看需要优化不？\n    // arrow              是否有箭头\n    // arrowPosition      箭头的位置\n    // arrowOffset        箭头起始点\n\n    // 需要优化的\n    // isExpandWidth      拓展线条\n    // eventHandlerDom    代替绑定事件的dom\n    // orientationLimit   限制方向\n\n\n    // 需要优化的\n    // scope           scope相同可拉进group里面\n    // endpoints       endpoint对象\n    // _endpointsData  真实的endpoint数据\n\n    // 需要悬空\n    super();\n  }\n\n  // 渲染节点\n  draw() {}\n\n  // 重绘节点\n  redraw() {}\n\n  // 渲染label\n  drawLabel() {}\n\n  // 重绘label\n  redrawLabel() {}\n\n  // 渲染arrow\n  drawArrow() {}\n\n  // 重回arrow\n  redrawArrow() {}\n\n  // 判断是否能连接的方法\n  isConnect() {}\n\n  // 销毁节点\n  destroy() {}\n\n  // ********* 需要新增的api ********* \n\n  // 删除线条\n  remove() {}\n\n  // 单击的回调\n  click() {}\n\n  // hover的回调\n  hover() {}\n\n  // focus回调\n  focus() {}\n\n  // unFocus回调\n  unFocus() {}\n\n}\n\nexport default Edge;\n","'use strict';\n\nconst _ = require('lodash');\nconst $ = require('jquery');\nimport DrawUtil from '../utils/link';\nimport ArrowUtil from '../utils/arrow';\nimport LinkAnimateUtil from '../utils/link_animate'\n\nimport './baseEdge.less';\n\nimport Edge from '../interface/edge';\nclass BaseEdge extends Edge {\n  constructor(opts) {\n    super(opts);\n    this.id = _.get(opts, 'id');\n    this.targetNode = _.get(opts, 'targetNode');\n    this._targetType = _.get(opts, '_targetType');\n    this.targetEndpoint = _.get(opts, 'targetEndpoint');\n    this.sourceNode = _.get(opts, 'sourceNode');\n    this._sourceType = _.get(opts, '_sourceType');\n    this.sourceEndpoint = _.get(opts, 'sourceEndpoint');\n    this.type = _.get(opts, 'type') || 'endpoint';\n    this.orientationLimit = _.get(opts, 'orientationLimit');\n    this.shapeType = _.get(opts, 'shapeType');\n    this.label = _.get(opts, 'label');\n    this.arrow = _.get(opts, 'arrow');\n    this.arrowPosition = _.get(opts, 'arrowPosition', 0.5);\n    this.arrowOffset = _.get(opts, 'arrowOffset', 0),\n    this.isExpandWidth = _.get(opts, 'isExpandWidth', false);\n    this.defaultAnimate = _.get(opts, 'defaultAnimate', false);\n    this.dom = null;\n    this.labelDom = null;\n    this.arrowDom = null;\n    this.eventHandlerDom = null;\n    // 鸭子辨识手动判断类型\n    this.__type = 'edge';\n    this._path = null;\n    // 业务和库内addEdges写法上有区别，需要兼容\n    this.options = _.get(opts, 'options') || opts;\n    this._isDeletingEdge = opts._isDeletingEdge;\n    this._global = opts._global;\n    this._on = opts._on;\n    this._emit = opts._emit;\n    // 性能优化\n    this._labelWidth = 0;\n    this._labelHeight = 0;\n    // 函数节流\n    this._updateTimer = null;\n    this._UPDATE_INTERVAL = 20;\n  }\n  _init() {\n    if (this._isInited) {\n      return;\n    }\n    this._isInited = true;\n    this.dom = this.draw({\n      id: this.id,\n      dom: this.dom,\n      options: this.options\n    });\n    this.labelDom = this.drawLabel(this.label);\n    this.arrowDom = this.drawArrow(this.arrow);\n\n    this._addEventListener();\n  }\n  draw(obj) {\n    let path = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n    path.setAttribute('class', 'butterflies-link');\n    \n    if (this.isExpandWidth) {\n      // 扩大线选中范围\n      this.eventHandlerDom = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n      this.eventHandlerDom.setAttribute('class', 'butterflies-link-event-handler');\n    }\n    return path;\n  }\n  mounted() {\n    if(this.defaultAnimate) {\n      this.addAnimate();\n    }\n  }\n  _calcPath(sourcePoint, targetPoint) {\n    if (!sourcePoint) {\n      sourcePoint = {\n        pos: [\n          // this.type === 'endpoint' ? this.sourceEndpoint._posLeft + this.sourceEndpoint._width / 2 : this.sourceNode.left + this.sourceNode.dom.offsetWidth / 2,\n          // this.type === 'endpoint' ? this.sourceEndpoint._posTop + this.sourceEndpoint._height / 2 : this.sourceNode.top + this.sourceNode.dom.offsetHeight / 2\n          this.type === 'endpoint' ? this.sourceEndpoint._posLeft + this.sourceEndpoint._width / 2 : this.sourceNode.left + $(this.sourceNode.dom).width() / 2,\n          this.type === 'endpoint' ? this.sourceEndpoint._posTop + this.sourceEndpoint._height / 2 : this.sourceNode.top + $(this.sourceNode.dom).height() / 2\n        ],\n        orientation: (this.type === 'endpoint' && this.sourceEndpoint.orientation) ? this.sourceEndpoint.orientation : undefined\n      };\n    }\n\n    if (!targetPoint) {\n      targetPoint = {\n        pos: [\n          // this.type === 'endpoint' ? this.targetEndpoint._posLeft + this.targetEndpoint._width / 2 : this.targetNode.left + this.targetNode.dom.offsetWidth / 2,\n          // this.type === 'endpoint' ? this.targetEndpoint._posTop + this.targetEndpoint._height / 2 : this.targetNode.top + this.targetNode.dom.offsetHeight / 2\n          this.type === 'endpoint' ? this.targetEndpoint._posLeft + this.targetEndpoint._width / 2 : this.targetNode.left + $(this.targetNode.dom).width() / 2,\n          this.type === 'endpoint' ? this.targetEndpoint._posTop + this.targetEndpoint._height / 2 : this.targetNode.top + $(this.targetNode.dom).height() / 2\n        ],\n        orientation: (this.type === 'endpoint' && this.targetEndpoint.orientation) ? this.targetEndpoint.orientation : undefined\n      };\n    }\n    let path = '';\n    if (this.calcPath) {\n      path = this.calcPath(sourcePoint, targetPoint);\n    } else if (this.shapeType === 'Bezier') {\n      path = DrawUtil.drawBezier(sourcePoint, targetPoint);\n    } else if (this.shapeType === 'Straight') {\n      path = DrawUtil.drawStraight(sourcePoint, targetPoint);\n    } else if (this.shapeType === 'Flow') {\n      path = DrawUtil.drawFlow(sourcePoint, targetPoint, this.orientationLimit);\n    } else if (this.shapeType === 'Manhattan') {\n      path = DrawUtil.drawManhattan(sourcePoint, targetPoint);\n    } else if (this.shapeType === 'AdvancedBezier') {\n      path = DrawUtil.drawAdvancedBezier(sourcePoint, targetPoint);\n    }\n    this._path = path;\n    return path;\n  }\n  redrawLabel() {\n    let pathLength = this.dom.getTotalLength() / 2;\n    let centerPoint = this.dom.getPointAtLength(pathLength);\n    $(this.labelDom)\n      .css('left', centerPoint.x - this.labelDom.offsetWidth / 2)\n      .css('top', centerPoint.y - this.labelDom.offsetHeight / 2);\n  }\n  drawLabel(label) {\n    let isDom = typeof HTMLElement === 'object' ? (obj) => {\n      return obj instanceof HTMLElement;\n    } : (obj) => {\n      return obj && typeof obj === 'object' && obj.nodeType === 1 && typeof obj.nodeName === 'string';\n    };\n    if (label) {\n      if (isDom(label)) {\n        $(label).addClass('butterflies-label');\n        return label;\n      } else {\n        let dom = document.createElement('span');\n        dom.className = 'butterflies-label';\n        dom.innerText = label;\n        return dom;\n      }\n    }\n  }\n  updateLabel(label) {\n    let labelDom = this.drawLabel(label);\n    if (this.labelDom) {\n      $(this.labelDom).off();\n      $(this.labelDom).remove();\n    }\n    this.label = label;\n    this.labelDom = labelDom;\n    this.emit('InnerEvents', {\n      type: 'edge:updateLabel',\n      data: this\n    });\n  }\n  redrawArrow(path) {\n    const length = this.dom.getTotalLength();\n    if(!length) {\n      return;\n    }\n    this.arrowFinalPosition = (length * this.arrowPosition + this.arrowOffset) / length;\n    if (this.arrowFinalPosition > 1) {\n      this.arrowFinalPosition = 1;\n    }\n    if (this.arrowFinalPosition < 0) {\n      this.arrowFinalPosition = 0;\n    }\n    // 防止箭头窜出线条\n    if (1 - this.arrowFinalPosition < ArrowUtil.arrow.length / length) {\n      this.arrowFinalPosition = (length * this.arrowFinalPosition - ArrowUtil.arrow.length) / length;\n    }\n    // 贝塞尔曲线是反着画的，需要调整\n    if (this.shapeType === 'Bezier') {\n      this.arrowFinalPosition = 1 - this.arrowFinalPosition;\n    }\n\n    let point = this.dom.getPointAtLength(length * this.arrowFinalPosition);\n    let x = point.x;\n    let y = point.y;\n\n    let vector = ArrowUtil.calcSlope({\n      shapeType: this.shapeType,\n      dom: this.dom,\n      arrowPosition: this.arrowFinalPosition,\n      path: path\n    });\n    let deg = Math.atan2(vector.y, vector.x) / Math.PI * 180;\n\n    this.arrowDom.setAttribute('d', ArrowUtil.arrow.default);\n    this.arrowDom.setAttribute('transform', `rotate(${deg}, ${x}, ${y})translate(${x}, ${y})`);\n  }\n  drawArrow(arrow) {\n    if (arrow) {\n      let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n      path.setAttribute('class', 'butterflies-arrow');\n      return path;\n    }\n  }\n  redraw(sourcePoint, targetPoint, options) {\n    // 重新计算线条path\n    let path = this._calcPath(sourcePoint, targetPoint);\n\n    this.dom.setAttribute('d', path);\n    if (this.isExpandWidth) {\n      this.eventHandlerDom.setAttribute('d', path);\n      $(this.eventHandlerDom).insertAfter(this.dom);\n    }\n    // 函数节流\n    if (!this._updateTimer) {\n      this._updateTimer = setTimeout(() => {\n        // 重新计算label\n        if (this.labelDom) {\n          this.redrawLabel();\n        }\n        // 重新计算arrow\n        if (this.arrowDom) {\n          this.redrawArrow(path);\n        }\n        // 重新计算动画path\n        if (this.animateDom) {\n          this.redrawAnimate(path);\n        }\n        this._updateTimer = null;\n      }, this._UPDATE_INTERVAL);\n    }\n\n    this.updated && this.updated();\n  }\n  isConnect() {\n    return true;\n  }\n  addAnimate(options) {\n    this.animateDom = LinkAnimateUtil.addAnimate(this.dom, this._path, _.assign({},{\n      num: 1, // 现在只支持1个点点\n      radius: 3,\n      color: '#776ef3'\n    }, options), this.animateDom);\n  }\n  redrawAnimate(path) {\n    LinkAnimateUtil.addAnimate(this.dom, this._path, {\n      _isContinue: true\n    }, this.animateDom);\n  }\n  emit(type, data) {\n    super.emit(type, data);\n    this._emit(type, data);\n  }\n  remove() {\n    this.emit('InnerEvents', {\n      type: 'edge:delete',\n      data: this\n    });\n  }\n  destroy(isNotEventEmit) {\n    if (this.labelDom) {\n      $(this.labelDom).remove();\n    }\n    if (this.arrowDom) {\n      $(this.arrowDom).remove();\n    }\n    if (this.eventHandlerDom) {\n      $(this.eventHandlerDom).remove();\n    }\n    if (this.animateDom) {\n      $(this.animateDom).remove();\n    }\n    $(this.dom).remove();\n    if (this.id && !isNotEventEmit) {\n      this.removeAllListeners();\n    }\n  }\n  _addEventListener() {\n    $(this.dom).on('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.emit('system.link.click', {\n        edge: this\n      });\n      this.emit('events', {\n        type: 'link:click',\n        edge: this\n      });\n\n      this.emit('InnerEvents', {\n        type: 'link:click',\n        data: this\n      });\n    });\n  }\n  _create(opts) {\n    this.id = _.get(opts, 'id') || this.id;\n    this.targetNode = _.get(opts, 'targetNode') || this.targetNode;\n    this._targetType = _.get(opts, '_targetType') || this._targetType;\n    this.targetEndpoint = _.get(opts, 'targetEndpoint') || this.targetEndpoint;\n    this.sourceNode = _.get(opts, 'sourceNode') || this.sourceNode;\n    this._sourceType = _.get(opts, '_sourceType') || this._sourceType;\n    this.sourceEndpoint = _.get(opts, 'sourceEndpoint') || this.sourceEndpoint;\n    this.type = _.get(opts, 'type') || this.type;\n    _.set(this, 'options.targetNode', _.get(this, 'targetNode.id'));\n    _.set(this, 'options.targetEndpoint', _.get(this, 'targetEndpoint.id'));\n    this.redraw();\n  }\n}\n\nexport default BaseEdge;\n","'use strict';\n\nconst EventEmit3 = require('eventemitter3');\n\nclass Group extends EventEmit3 {\n  constructor() {\n    // id        节点唯一标志\n    // top       坐标y\n    // left      坐标x\n    // width     节点组宽度\n    // height    节点组高度\n    // resize    标志是否能resize\n    // dom       实际的dom\n    // nodes     里面包含的节点对象\n    // options   数据的透传\n    // _on       节点发送事件\n    // _emit     节点发送事件\n    // _global   全局的配置\n\n\n\n    // 需要优化的\n    // scope           scope相同可拉进group里面\n    // endpoints       endpoint对象\n    // _endpointsData  真实的endpoint数据\n    super();\n  }\n\n  // 渲染节点\n  draw() {}\n\n  // 添加节点\n  addNode() {}\n\n  // 批量添加节点\n  addNodes() {}\n\n  // 获取宽度\n  getWidth() {}\n\n  // 获取高度\n  getHeight() {}\n\n  // 删除节点\n  removeNode() {}\n\n  // 批量删除节点\n  removeNodes() {}\n\n  // 设置是否可缩放\n  setResize() {}\n\n  // 设置大小\n  setSize() {}\n  \n  // 移动group\n  moveTo() {}\n\n  // 获取锚点\n  getEndpoint() {}\n\n  // 添加锚点\n  addEndpoint() {}\n\n  // remove的方法\n  remove() {}\n\n  // 销毁的方法\n  destroy() {}\n\n  // ********* 需要新增的api ********* \n\n  // 删除锚点\n  removeEndpoint() {}\n\n  // 折叠的方法\n  collapse() {}\n\n  // 伸展的方法\n  stretch() {}\n\n  // 单击的回调\n  click() {}\n\n  // 双击的回调\n  doubleClick() {}\n\n  // 右键的回调\n  onContextmenu() {}\n\n  // hover的回调\n  hover() {}\n\n  // focus回调\n  focus() {}\n\n  // unFocus回调\n  unFocus() {}\n}\n\nexport default Group;\n","'use strict';\n\nconst _ = require('lodash');\n\n// 检验scope是否匹配\nexport default (scope1, scope2, isScopeStrict) => {\n  let _scope1 = (scope1 || '').split(' ').filter(item => !!item);\n  let _scope2 = (scope2 || '').split(' ').filter(item => !!item);\n  if (!isScopeStrict && (!scope1 || !scope2)) {\n    return true;\n  } else if (isScopeStrict && !scope1 && !scope2) {\n    return true;\n  }\n  let totalScope = _scope1.concat(_scope2);\n  let uniqScope = _.uniq(totalScope);\n  \n  if (totalScope.length === uniqScope.length) {\n    return false;\n  } else {\n    return true;\n  }\n};\n","'use strict';\n\nimport './baseGroup.less';\n\nconst $ = require('jquery');\nconst _ = require('lodash');\n\nimport Group from '../interface/group';\nimport Endpoint from '../endpoint/baseEndpoint';\n\n// scope的比较\nimport ScopeCompare from '../utils/scopeCompare';\n\nclass BaseGroup extends Group {\n  constructor(opts) {\n    super(opts);\n    this.id = opts.id;\n    this.scope = opts.scope;\n    this.top = opts.top;\n    this.left = opts.left;\n    this.width = opts.width || 300;\n    this.height = opts.height || 150;\n    this.resize = opts.resize;\n    this.draggable = opts.draggable;\n    this.dom = null;\n    this.nodes = [];\n    this.options = opts.options;\n    // 鸭子辨识手动判断类型\n    this.__type = 'group';\n    this._global = opts._global;\n    this._on = opts._on;\n    this._emit = opts._emit;\n    this._container = null;\n    // endpoint 这部分需要考虑\n    this.endpoints = [];\n    this._endpointsData = opts.endpoints;\n  }\n  init() {\n    this.dom = this.draw({\n      id: this.id,\n      top: this.top,\n      left: this.left,\n      width: this.width,\n      height: this.height,\n      dom: this.dom,\n      options: this.options\n    });\n    this._addEventListener();\n  }\n  draw(obj) {\n    let _dom = obj.dom;\n    if (!_dom) {\n      _dom = $('<div></div>')\n        .attr('class', 'group')\n        .attr('id', obj.id);\n    }\n    let group = $(_dom);\n    \n    let titleDom = $('<div></div>')\n      .attr('class', 'title');\n    \n    if (_.get(this, 'options.title')) {\n      titleDom.text(_.get(this, 'options.title'));\n    }\n\n    group.append(titleDom);\n\n    this._container = $('<div></div>')\n      .attr('class', 'container');\n    \n    group.append(this._container);\n\n    // 默认resize打开\n    if (this.resize !== false) {\n      this.setResize(true, group);\n    }\n\n    if (obj.top !== undefined) {\n      group.css('top', obj.top + 'px');\n    }\n    if (obj.left !== undefined) {\n      group.css('left', obj.left + 'px');\n    }\n    if (obj.width !== undefined) {\n      group.css('width', obj.width + 'px');\n    }\n    if (obj.height !== undefined) {\n      group.css('height', obj.height + 'px');\n    }\n\n    this.updated && this.updated();\n    return group[0];\n  }\n  addNodes(nodes = [], isNotEventEmit) {\n    let _nodes = [];\n    nodes.forEach((item) => {\n      if (ScopeCompare(item.scope, this.scope, _.get(this, '_global.isScopeStrict'))) {\n        _nodes.push(item);\n      } else {\n        console.log(`nodeId为${item.id}的节点和groupId${this.id}的节点组scope值不符，无法加入`);\n      }\n    });\n    this.emit('InnerEvents', {\n      type: 'group:addNodes',\n      nodes: nodes,\n      group: this,\n      isNotEventEmit\n    });\n  }\n  addNode(node) {\n    this.addNodes([node]);\n  }\n  removeNodes(nodes = [], isNotEventEmit) {\n    let rmNodes = [];\n    this.nodes.forEach((item) => {\n      let _node = _.find(nodes, (_node) => {\n        return _node.id === item.id;\n      });\n      if (_node) {\n        rmNodes.push(_node);\n      }\n    })\n    // this.nodes.forEach((item) => {\n    //   let _node = _.find(nodes, (_node) => {\n    //     return _node.id === item.id;\n    //   });\n    //   if (_node) {\n    //     rmNodes.push(_node);\n    //   }\n    // });\n    this.emit('InnerEvents', {\n      type: 'group:removeNodes',\n      group: this,\n      nodes: rmNodes,\n      isNotEventEmit\n    });\n    if (!isNotEventEmit) {\n      this.emit('events', {\n        type: 'system.group.removeNodes',\n        group: this,\n        nodes: rmNodes,\n        group: targetGroup\n      });\n      this.emit('system.group.removeNodes', {\n        group: this,\n        nodes: rmNodes,\n        group: targetGroup\n      });\n    }\n    return rmNodes;\n  }\n  removeNode(node) {\n    return this.removeNodes([node]);\n  }\n  setResize(flat, container = this.dom, resizeDom) {\n    let mouseDown = (event) => {\n      const LEFT_KEY = 0;\n      if (event.button !== LEFT_KEY) {\n        return;\n      }\n      event.preventDefault();\n      // event.stopPropagation();\n      this.emit('InnerEvents', {\n        type: 'group:resize',\n        group: this\n      });\n    };\n    if (flat) {\n      let icon = null;\n      if (resizeDom) {\n        icon = $(resizeDom);\n        icon.addClass('butterfly-group-icon-resize');\n      } else {\n        icon = $('<span class=\"butterfly-group-icon-resize group-icon-resize butterfly-icon icon-drag\"></span>')\n      }\n      icon.appendTo(container);\n      icon.on('mousedown', mouseDown);\n    }\n  }\n  setSize(width = this.width, height = this.height) {\n    this.width = width;\n    this.height = height;\n    $(this.dom).css('width', this.width).css('height', this.height);\n  }\n  remove() {\n    this.emit('InnerEvents', {\n      type: 'group:delete',\n      data: this\n    });\n  }\n  _moveTo(x, y) {\n    // 自身移动\n    $(this.dom).css('top', y).css('left', x);\n    // 所在节点的锚点移动\n    this.nodes.forEach((node) => {\n      node.endpoints.forEach((point) => {\n        point.updatePos();\n      });\n    });\n    // 节点组的锚点移动\n    this.endpoints.forEach((item) => {\n      item.moveTo(x - this.left + item._left, y - this.top + item._top);\n    });\n    this.top = y;\n    this.left = x;\n  }\n  moveTo(x, y, isNotEventEmit) {\n    this.emit('InnerEvents', {\n      type: 'group:move',\n      group: this,\n      x,\n      y,\n      isNotEventEmit\n    });\n  }\n  focus() {\n\n  }\n  unFocus() {\n    \n  }\n  getWidth() {\n    return this.width;\n  }\n  getHeight() {\n    return this.height;\n  }\n  getEndpoint(pointId) {\n    return _.find(this.endpoints, point => pointId === point.id);\n  }\n  _appendNodes(nodes = []) {\n    nodes.forEach((item) => {\n      item._group = this;\n      item.group = this.id;\n      $(this.dom).append(item.dom);\n      this.nodes.push(item);\n    });\n  }\n  _addEventListener() {\n    $(this.dom).on('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.emit('system.group.click', {\n        group: this\n      });\n      this.emit('events', {\n        type: 'group:click',\n        group: this\n      });\n    });\n    $(this.dom).on('mousedown', (e) => {\n      // 兼容节点冒泡上来的事件\n      let isChildNodeMoving = _.some(this.nodes, (item) => {\n        return item._isMoving;\n      });\n      if (isChildNodeMoving) {\n        return;\n      }\n      // 兼容resize按钮冒泡上来的事件\n      if($(e.target).attr('class').indexOf('butterfly-group-icon-resize') !== -1) {\n        return;\n      }\n\n      const LEFT_KEY = 0;\n      if (e.button !== LEFT_KEY) {\n        return;\n      }\n      e.preventDefault();\n      // e.stopPropagation();\n      if (this.draggable) {\n        this.emit('InnerEvents', {\n          type: 'group:dragBegin',\n          data: this\n        });\n      }\n    });\n  }\n  _createEndpoint(isInited) {\n    if (isInited) {\n      this.endpoints.forEach(item => this.addEndpoint(item, isInited));\n    } else if (this._endpointsData) {\n      this._endpointsData.map(item => this.addEndpoint(item));\n    }\n  }\n  addEndpoint(obj, isInited) {\n    if (isInited) {\n      this.emit('InnerEvents', {\n        type: 'group:addEndpoint',\n        data: obj,\n        isInited\n      });\n      return obj;\n    }\n    // 这部分可能还需要想一下\n    const EndpointClass = obj.Class || Endpoint;\n    const endpoint = new EndpointClass(_.assign({\n      _on: this._on,\n      _emit: this._emit,\n      _node: this,\n      _global: this._global,\n    }, obj));\n\n    this.emit('InnerEvents', {\n      type: 'group:addEndpoint',\n      data: endpoint,\n    });\n    this.endpoints.push(endpoint);\n    return endpoint;\n  }\n  emit(type, data) {\n    super.emit(type, data);\n    this._emit(type, data);\n  }\n  destroy(isNotEventEmit) {\n    this.endpoints.forEach((item) => {\n      !item._isInitedDom && item.destroy();\n    });\n    $(this.dom).off();\n    $(this.dom).remove();\n    if (!isNotEventEmit) {\n      this._emit('system.group.delete', {\n        group: this\n      });\n      this._emit('events', {\n        type: 'group:delete',\n        group: this\n      });\n      this.removeAllListeners();\n    }\n  }\n}\n\nexport default BaseGroup;\n","'use strict';\n\nfunction circleLayout(params) {\n  let radius = params.radius;\n  let nodes = params.data.nodes.filter((node) => {\n    return node._isCircle;\n  });\n\n  let _preAngle = 360 / nodes.length;\n  let _halfWidth = 0;\n  if (params.getWidth) {\n    _halfWidth = params.getWidth() / 2;\n  }\n  let _halfHeight = 0;\n  if (params.getHeight) {\n    _halfWidth = params.getHeight() / 2;\n  }\n\n  nodes.forEach((item, index) => {\n    let radian = (2 * Math.PI) / 360;\n    let angle = index * _preAngle;\n    let _top = (radius * Math.sin(angle * radian) - _halfHeight);\n    let _left = (radius * Math.cos(angle * radian) - _halfWidth);\n\n    let _textTop = ((radius + 30) * Math.sin(angle * radian) - _halfHeight);\n    let _textLeft = ((radius + 30) * Math.cos(angle * radian) - _halfWidth);\n\n    item.top = _top;\n    item.left = _left;\n    item.posInfo = {\n      angle: angle,\n      _textTop: _textTop,\n      _textLeft: _textLeft\n    };\n  });\n}\n\n// module.exports = circleLayout;\nexport default {\n  circleLayout\n};","'use strict';\nconst SPEED_DIVISOR = 800;\nfunction fruchterman (param) {\n    const self = param.opts\n    const nodes = param.data.nodes;\n  \n    const center = self.center;\n  \n    if (!nodes || nodes.length === 0) {\n      return;\n    }\n    if (nodes.length === 1) {\n      nodes[0].x = center[0];\n      nodes[0].y = center[1];\n      return;\n    }\n    const nodeMap = {};\n    const nodeIdxMap = {};\n    nodes.forEach((node, i) => {\n      if ( !_.isNumber(node.x)) node.x = Math.random() * self.width;\n      if ( !_.isNumber(node.y)) node.y = Math.random() * self.height;\n      nodeMap[node.id] = node;\n      nodeIdxMap[node.id] = i;\n    });\n    self.nodeMap = nodeMap;\n    self.nodeIdxMap = nodeIdxMap;\n    \n    // layout\n    run(param);\n  }\n  \n   function run(param) {\n    const self = param.opts;\n    const nodes = param.data.nodes;\n    const edges = param.data.edges;\n    const maxIteration = self.maxIteration;\n    if (!self.width && typeof window !== 'undefined') {\n      self.width = window.innerWidth;\n    }\n    if (!self.height && typeof window !== 'undefined') {\n      self.height = window.innerHeight;\n    }\n    const center = self.center;\n    const maxDisplace = self.width / 10;\n    const k = Math.sqrt((self.width * self.height) / (nodes.length + 1));\n    const gravity = self.gravity;\n    const speed = self.speed;\n    const clustering = self.clustering;\n    const clusterMap= {};\n    if (clustering) {\n      nodes.forEach((n) => {\n        if (clusterMap[n.cluster] === undefined) {\n          const cluster = {\n            name: n.cluster,\n            cx: 0,\n            cy: 0,\n            count: 0,\n          };\n          clusterMap[n.cluster] = cluster;\n        }\n        const c = clusterMap[n.cluster];\n        if ( _.isNumber( n.x)) {\n          c.cx += n.x;\n        }\n        if ( _.isNumber( n.y)) {\n          c.cy += n.y;\n        }\n        c.count++;\n      });\n      for (const key in clusterMap) {\n        clusterMap[key].cx /= clusterMap[key].count;\n        clusterMap[key].cy /= clusterMap[key].count;\n      }\n    }\n    for (let i = 0; i < maxIteration; i++) {\n      const displacements = [];\n      nodes.forEach((_, j) => {\n        displacements[j] = { x: 0, y: 0 };\n      });\n  \n      applyCalculate(nodes, edges, displacements, k,self);\n  \n      // gravity for clusters\n      if (clustering) {\n        const clusterGravity = self.clusterGravity || gravity;\n        nodes.forEach((n, j) => {\n          if ( !_.isNumber(n.x) ||  !_.isNumber(n.y)) return;\n          const c = clusterMap[n.cluster];\n          const distLength = Math.sqrt((n.x - c.cx) * (n.x - c.cx) + (n.y - c.cy) * (n.y - c.cy));\n          const gravityForce = k * clusterGravity;\n          displacements[j].x -= (gravityForce * (n.x - c.cx)) / distLength;\n          displacements[j].y -= (gravityForce * (n.y - c.cy)) / distLength;\n        });\n  \n        for (const key in clusterMap) {\n          clusterMap[key].cx = 0;\n          clusterMap[key].cy = 0;\n          clusterMap[key].count = 0;\n        }\n  \n        nodes.forEach((n) => {\n          const c = clusterMap[n.cluster];\n          if ( _.isNumber(n.x )) {\n            c.cx += n.x;\n          }\n          if ( _.isNumber(n.y )) {\n            c.cy += n.y;\n          }\n          c.count++;\n        });\n        for (const key in clusterMap) {\n          clusterMap[key].cx /= clusterMap[key].count;\n          clusterMap[key].cy /= clusterMap[key].count;\n        }\n      }\n  \n     // gravity\n     nodes.forEach((n, j) => {\n        if (!_.isNumber(n.x) || !_.isNumber(n.y)) return;\n        const gravityForce = 0.01 * k * gravity;\n        displacements[j].x -= gravityForce * (n.x - center[0]);\n        displacements[j].y -= gravityForce * (n.y - center[1]);\n      });\n      // move\n      nodes.forEach((n, j) => {\n        if (!_.isNumber(n.x) || !_.isNumber(n.y)) return;\n        const distLength = Math.sqrt(\n          displacements[j].x * displacements[j].x + displacements[j].y * displacements[j].y,\n        );\n        if (distLength > 0) {\n          // && !n.isFixed()\n          const limitedDist = Math.min(maxDisplace * (speed / SPEED_DIVISOR), distLength);\n          n.x += (displacements[j].x / distLength) * limitedDist;\n          n.y += (displacements[j].y / distLength) * limitedDist;\n        }\n      });\n    }\n  }\n  \n   function applyCalculate(nodes, edges, displacements, k,self) {\n    calRepulsive(nodes, displacements, k);\n    calAttractive(edges, displacements, k,self);\n  }\n  \n  function calRepulsive(nodes , displacements, k) {\n    nodes.forEach((v, i) => {\n      displacements[i] = { x: 0, y: 0 };\n      nodes.forEach((u, j) => {\n        if (i === j) {\n          return;\n        }\n        if (!_.isNumber(v.x) || !_.isNumber(u.x) || !_.isNumber(v.y) || !_.isNumber(u.y)) return;\n        let vecX = v.x - u.x;\n        let vecY = v.y - u.y;\n        let vecLengthSqr = vecX * vecX + vecY * vecY;\n        if (vecLengthSqr === 0) {\n          vecLengthSqr = 1;\n          const sign = i > j ? 1 : -1;\n          vecX = 0.01 * sign;\n          vecY = 0.01 * sign;\n        }\n        const common = (k * k) / vecLengthSqr;\n        displacements[i].x += vecX * common;\n        displacements[i].y += vecY * common;\n      });\n    });\n  }\n  \n  function calAttractive(edges, displacements, k,self) {\n    edges.forEach((e) => {\n      if (!e.source || !e.target) return;\n      const uIndex = self.nodeIdxMap[e.source];\n      const vIndex = self.nodeIdxMap[e.target];\n      if (uIndex === vIndex) {\n        return;\n      }\n      const u = self.nodeMap[e.source];\n      const v = self.nodeMap[e.target];\n      if (!_.isNumber(v.x) || !_.isNumber(u.x) || !_.isNumber(v.y) || !_.isNumber(u.y)) return;\n      const vecX = v.x - u.x;\n      const vecY = v.y - u.y;\n      const vecLength = Math.sqrt(vecX * vecX + vecY * vecY);\n      const common = (vecLength * vecLength) / k;\n      displacements[vIndex].x -= (vecX / vecLength) * common;\n      displacements[vIndex].y -= (vecY / vecLength) * common;\n      displacements[uIndex].x += (vecX / vecLength) * common;\n      displacements[uIndex].y += (vecY / vecLength) * common;\n    });\n  }\nmodule.exports = fruchterman;\n//   export default {\n//     fruchterman\n//   };","\nfunction gridLayout (param) {\n    const self = param.opts;\n    const nodes = param.data.nodes;\n    const n = nodes.length;\n    const center = self.center;\n    if (n === 0) {\n      return;\n    }\n    if (n === 1) {\n      nodes[0].x = center[0];\n      nodes[0].y = center[1];\n      return;\n    }\n  \n    const edges = param.data.edges;\n    const layoutNodes = [];\n    nodes.forEach((node) => {\n      layoutNodes.push(node);\n    });\n    const nodeIdxMap = {};\n    layoutNodes.forEach((node, i) => {\n      nodeIdxMap[node.id] = i;\n    });\n  \n    // 排序\n    if (\n      self.sortBy === 'degree' ||\n      typeof self.sortBy === 'string' ||\n      layoutNodes[0][self.sortBy] === undefined\n    ) {\n      self.sortBy = 'degree';\n      if (isNaN(nodes[0].degree)) {\n        const values = getDegree(layoutNodes.length, nodeIdxMap, edges);\n        layoutNodes.forEach((node, i) => {\n          node.degree = values[i];\n        });\n      }\n    }\n    // sort nodes by value\n    layoutNodes.sort((n1, n2) => (n2)[self.sortBy] - (n1)[self.sortBy]);\n  \n    if (!self.width && typeof window !== 'undefined') {\n      self.width = window.innerWidth;\n    }\n    if (!self.height && typeof window !== 'undefined') {\n      self.height = window.innerHeight;\n    }\n  \n    const oRows = self.rows;\n    const oCols = self.cols != null ? self.cols : self.columns;\n    self.cells = n;\n  \n    // if rows or columns were set in self, use those values\n    if (oRows != null && oCols != null) {\n      self.rows = oRows;\n      self.cols = oCols;\n    } else if (oRows != null && oCols == null) {\n      self.rows = oRows;\n      self.cols = Math.ceil(self.cells / self.rows);\n    } else if (oRows == null && oCols != null) {\n      self.cols = oCols;\n      self.rows = Math.ceil(self.cells / self.cols);\n    } else {\n      // otherwise use the automatic values and adjust accordingly\t      // otherwise use the automatic values and adjust accordingly\n      // width/height * splits^2 = cells where splits is number of times to split width\n      self.splits = Math.sqrt((self.cells * self.height) / self.width);\n      self.rows = Math.round(self.splits);\n      self.cols = Math.round((self.width / self.height) * self.splits);\n    }\n  \n    self.cellWidth = self.width / self.cols;\n    self.cellHeight = self.height / self.rows;\n  \n    if (self.condense) {\n      self.cellWidth = 0;\n      self.cellHeight = 0;\n    }\n  \n    if (self.preventOverlap) {\n      layoutNodes.forEach((node) => {\n        if (!node.x || !node.y) {\n          // for bb\n          node.x = 0;\n          node.y = 0;\n        }\n  \n        let nodew;\n        let nodeh;\n        // if (isArray(node.size)) {\n        //   nodew = node.size[0];\n        //   nodeh = node.size[1];\n        // } else \n        if ( typeof node.size === 'number') {\n          nodew = node.size;\n          nodeh = node.size;\n        }\n        if (nodew === undefined || nodeh === undefined) {\n          // if (isArray(self.nodeSize)) {\n          //   nodew = self.nodeSize[0];\n          //   nodeh = self.nodeSize[1];\n          // } else \n          if ( typeof node.nodeSize === 'number') {\n            nodew = self.nodeSize;\n            nodeh = self.nodeSize;\n          } else {\n            nodew = 30;\n            nodeh = 30;\n          }\n        }\n  \n        const p = self.preventOverlapPadding;\n  \n        const w = nodew + p;\n        const h = nodeh + p;\n  \n        self.cellWidth = Math.max(self.cellWidth, w);\n        self.cellHeight = Math.max(self.cellHeight, h);\n      });\n    }\n  \n    self.cellUsed = {}; // e.g. 'c-0-2' => true\n  \n    // to keep track of current cell position\n    self.row = 0;\n    self.col = 0;\n  \n    // get a cache of all the manual positions\n    self.id2manPos = {};\n    for (let i = 0; i < layoutNodes.length; i++) {\n      const node = layoutNodes[i];\n      let rcPos;\n      if (self.position) {\n        rcPos = self.position(node);\n      }\n  \n      if (rcPos && (rcPos.row !== undefined || rcPos.col !== undefined)) {\n        // must have at least row or col def'd\n        const pos = {\n          row: rcPos.row,\n          col: rcPos.col,\n        };\n  \n        if (pos.col === undefined) {\n          // find unused col\n          pos.col = 0;\n  \n          while (used(pos.row, pos.col,self)) {\n            pos.col++;\n          }\n        } else if (pos.row === undefined) {\n          // find unused row\n          pos.row = 0;\n  \n          while (used(pos.row, pos.col,self)) {\n            pos.row++;\n          }\n        }\n  \n        self.id2manPos[node.id] = pos;\n        use(pos.row, pos.col);\n      }\n      getPos(node,self);\n    }\n    \n  }\n  \n  function getDegree (n, nodeIdxMap, edges) {\n    const degrees = [];\n    for (let i = 0; i < n; i++) {\n      degrees[i] = 0;\n    }\n    edges.forEach((e) => {\n      if (e.source) {\n        degrees[nodeIdxMap[e.source]] += 1;\n      }\n      if (e.target) {\n        degrees[nodeIdxMap[e.target]] += 1;\n      }\n    });\n    return degrees;\n  };\n  \n  function use(row, col,self) {\n    self.cellUsed[`c-${row}-${col}`] = true;\n  }\n  \n  function used(row, col,self) {\n    return self.cellUsed[`c-${row}-${col}`] || false;\n  }\n  \n  function moveToNextCell(param) {\n    const self = param;\n    const cols = self.cols || 5;\n    self.col++;\n    if (self.col >= cols) {\n      self.col = 0;\n      self.row++;\n    }\n  }\n  \n  function getPos(node,param) {\n    const self = param;\n    const begin = self.begin;\n    const cellWidth = self.width;\n    const cellHeight = self.height;\n    let x;\n    let y;\n  \n    // see if we have a manual position set\n    const rcPos = self.id2manPos[node.id];\n    if (rcPos) {\n      x = rcPos.col * cellWidth + cellWidth / 2 + begin[0];\n      y = rcPos.row * cellHeight + cellHeight / 2 + begin[1];\n    } else {\n      // otherwise set automatically\n      while (used(self.row, self.col,self)) {\n        moveToNextCell(param);\n      }\n  \n      x = self.col * cellWidth + cellWidth / 2 + begin[0];\n      y = self.row * cellHeight + cellHeight / 2 + begin[1];\n      use(self.row, self.col,self);\n  \n      moveToNextCell(param);\n    }\n    node.x = x;\n    node.y = y;\n    node.left = x;\n    node.top = y\n  }\n  \n  module.exports = gridLayout;","const d3 = require('d3-force');\n// 离散布局\nfunction forceLayout(param) {\n    let opts = param.opts;\n    let data = _.cloneDeep(param.data);\n  \n    // 处理groups的布局,把group当成一个节点\n    let nodes = data.nodes.filter((item) => {\n      return !item.group;\n    });\n    let groupNodes = data.nodes.filter((item) => {\n      return item.group;\n    });\n  \n    nodes = nodes.concat(data.groups);\n  \n    // 在group内先random布局一下\n    groupNodes.forEach((item) => {\n      let group = _.find(data.groups, (_group) => {\n        return _group.id === item.group;\n      });\n      item.x = Math.random() * (group.width || 150);\n      item.y = Math.random() * (group.height || 120);\n    });\n  \n    let edges = data.edges.map((_edge) => {\n      let souceNode = _.find(groupNodes, (_node) => {\n        return _node.source === _edge.id;\n      });\n      if (souceNode) {\n        _edge.source = souceNode.group;\n      }\n      let targetNode = _.find(groupNodes, (_node) => {\n        return _node.target === _edge.id;\n      });\n      if (targetNode) {\n        _edge.target = souceNode.group;\n      }\n      return _edge;\n    });\n  \n  \n    let simulation = d3.forceSimulation(nodes)\n      .force('charge', (() => {\n        if (opts.chargeStrength) {\n          return d3.forceManyBody().strength(opts.chargeStrength);\n        } else {\n          return d3.forceManyBody();\n        }\n      })())\n      .force('center', d3.forceCenter(opts.width / 2, opts.height / 2))\n      .force('link', d3.forceLink(edges).id((node) => {\n        return node[_.get(opts.link, 'id', 'id')];\n      }).distance(opts.link.distance).strength(opts.link.strength))\n      .stop();\n  \n    for (var i = 0, n = Math.ceil(Math.log(simulation.alphaMin()) / Math.log(1 - simulation.alphaDecay())); i < n; ++i) {\n      simulation.tick();\n    }\n  \n  \n    param.data.nodes.forEach((node, index) => {\n      node.top = data.nodes[index].y;\n      node.left = data.nodes[index].x;\n    });\n  \n  \n    param.data.groups.forEach((group, index) => {\n      group.top = data.groups[index].y;\n      group.left = data.groups[index].x;\n    });\n    // 后续需要考虑group的布局\n  \n  }\n\nmodule.exports = forceLayout","// 同心圆布局\nfunction concentLayout(param) {\n    let {\n      center,\n      nodeSize,\n      minNodeSpacing,\n      preventOverlap,\n      sweep,\n      equidistant,\n      startAngle = (3 / 2) * Math.PI,\n      clockwise,\n      maxLevelDiff,\n      sortBy,\n      width,\n      height,\n      data,\n    } = param;\n    const curnode = data.nodes;\n    const curedges = data.edges;\n    let nodes = curnode.map((item) => {\n      return {\n        id: item.id,\n        top: item.top,\n        left: item.left,\n        degree: item.degree,\n        size: item.size,\n      }\n    });\n    let edges = curedges.map((item) => {\n      return {\n        source: item.source,\n        target: item.target,\n      }\n    });\n    const n = nodes.length;\n    let maxValueNode;\n    let counterclockwise;\n    if (n === 0) {\n      return;\n    }\n    if (n === 1) {\n      nodes[0].x = center[0];\n      nodes[0].y = center[1];\n      return;\n    }\n    const layoutNodes = [];\n    let maxNodeSize;\n    if (_.isArray(nodeSize)) {\n      maxNodeSize = Math.max(nodeSize[0], nodeSize[1]);\n    } else {\n      maxNodeSize = nodeSize;\n    }\n    nodes.forEach(node => {\n      layoutNodes.push(node);\n      let nodeSize = maxNodeSize;\n      if (_.isArray(node.size)) {\n        nodeSize = Math.max(node.size[0], node.size[1]);\n      } else if (_.isNumber(node.size)) {\n        nodeSize = node.size;\n      }\n      maxNodeSize = Math.max(maxNodeSize, nodeSize);\n    });\n    if (!width && typeof window !== 'undefined') {\n      width = window.innerWidth;\n    }\n    if (!height && typeof window !== 'undefined') {\n      height = window.innerHeight;\n    }\n    clockwise = counterclockwise !== undefined ? !counterclockwise : clockwise;\n  \n    // layout\n    const nodeMap = {};\n    const nodeIdxMap = {};\n    layoutNodes.forEach((node, i) => {\n      nodeMap[node.id] = node;\n      nodeIdxMap[node.id] = i;\n    });\n  \n    // get the node degrees\n    if (\n      sortBy === 'degree' ||\n      !_.isString(sortBy) ||\n      layoutNodes[0][sortBy] === undefined\n    ) {\n      sortBy = 'degree';\n      if (!_.isNumber(nodes[0].degree)) {\n        let values = [];\n        const len = nodes.length\n        for (let i = 0; i < len; i++) {\n          values[i] = 0;\n        }\n        edges.forEach(e => {\n          if (e.source) {\n            values[nodeIdxMap[e.source]] += 1;\n          }\n          if (e.target) {\n            values[nodeIdxMap[e.target]] += 1;\n          }\n        });\n        layoutNodes.forEach((node, i) => {\n          node.degree = values[i];\n        });\n      }\n    }\n    // sort nodes by value\n    layoutNodes.sort((n1, n2) => n2[sortBy] - n1[sortBy]);\n    maxValueNode = layoutNodes[0];\n    maxLevelDiff = maxLevelDiff || maxValueNode[sortBy] / 4;\n  \n    // put the values into levels\n    const levels = [[]];\n    let currentLevel = levels[0];\n    layoutNodes.forEach(node => {\n      if (currentLevel.length > 0) {\n        const diff = Math.abs(currentLevel[0][sortBy] - node[sortBy]);\n        if (maxLevelDiff && diff >= maxLevelDiff) {\n          currentLevel = [];\n          levels.push(currentLevel);\n        }\n      }\n      currentLevel.push(node);\n    });\n  \n    // create positions for levels\n    let minDist = maxNodeSize + minNodeSpacing; // min dist between nodes\n    if (!preventOverlap) {\n      // then strictly constrain to bb\n      const firstLvlHasMulti = levels.length > 0 && levels[0].length > 1;\n      const maxR = Math.min(width, height) / 2 - minDist;\n      const rStep = maxR / (levels.length + (firstLvlHasMulti ? 1 : 0));\n  \n      minDist = Math.min(minDist, rStep);\n    }\n  \n    // find the metrics for each level\n    let r = 0;\n    levels.forEach(level => {\n      let sweep = sweep;\n      if (sweep === undefined) {\n        sweep = 2 * Math.PI - (2 * Math.PI) / level.length;\n      }\n      const dTheta = (level.dTheta = sweep / Math.max(1, level.length - 1));\n  \n      // calculate the radius\n      if (level.length > 1 && preventOverlap) {\n        // but only if more than one node (can't overlap)\n        const dcos = Math.cos(dTheta) - Math.cos(0);\n        const dsin = Math.sin(dTheta) - Math.sin(0);\n        const rMin = Math.sqrt((minDist * minDist) / (dcos * dcos + dsin * dsin)); // s.t. no nodes overlapping\n  \n        r = Math.max(rMin, r);\n      }\n      level.r = r;\n      r += minDist;\n    });\n  \n    if (equidistant) {\n      let rDeltaMax = 0;\n      let rr = 0;\n      for (let i = 0; i < levels.length; i++) {\n        const level = levels[i];\n        const rDelta = level.r - rr;\n        rDeltaMax = Math.max(rDeltaMax, rDelta);\n      }\n      rr = 0;\n      levels.forEach((level, i) => {\n        if (i === 0) {\n          rr = level.r;\n        }\n        level.r = rr;\n        rr += rDeltaMax;\n      });\n    }\n  \n    // calculate the node positions\n    levels.forEach(level => {\n      const dTheta = level.dTheta;\n      const rr = level.r;\n      level.forEach((node, j) => {\n        const theta = startAngle + (clockwise ? 1 : -1) * dTheta * j;\n        node.x = center[0] + rr * Math.cos(theta);\n        node.y = center[1] + rr * Math.sin(theta);\n      });\n    });\n  \n    param.data.nodes.forEach((node, index) => {\n      node.top = nodes[index].y;\n      node.left = nodes[index].x;\n    });\n  }\n\nmodule.exports = concentLayout","const dagre = require('dagre');\n//drage布局\nfunction drageLayout(param) {\n    const {nodeSize, rankdir, nodesepFunc, ranksepFunc, nodesep, ranksep, controlPoints} = param;\n    const {edges = []} = param.data;\n    const curnode = param.data.nodes;\n    const nodes = curnode.map((item) => {\n      return {\n        id: item.id,\n        top: item.top,\n        left: item.left\n      }\n    });\n    // 形成新数组后布局失效\n    if (!nodes) return;\n    const g = new dagre.graphlib.Graph();\n    let nodeSizeFunc;\n    if (!nodeSize) {\n      nodeSizeFunc = (d) => {\n        if (d.size) {\n          if (_.isArray(d.size)) {\n            return d.size;\n          }\n          return [d.size, d.size];\n        }\n        return [40, 40];\n      };\n    } else if (_.isArray(nodeSize)) {\n      nodeSizeFunc = () => nodeSize;\n    } else {\n      nodeSizeFunc = () => [nodeSize, nodeSize];\n    }\n    let horisep = getFunc(nodesepFunc, nodesep, 50);\n    let vertisep = getFunc(ranksepFunc, ranksep, 50);\n    if (rankdir === 'LR' || rankdir === 'RL') {\n      horisep = getFunc(ranksepFunc, ranksep, 50);\n      vertisep = getFunc(nodesepFunc, nodesep, 50);\n    }\n    nodes.forEach(node => {\n      const size = nodeSizeFunc(node);\n      const verti = vertisep(node);\n      const hori = horisep(node);\n      const width = size[0] + 2 * hori;\n      const height = size[1] + 2 * verti;\n      g.setNode(node.id, {width, height});\n    });\n    edges.forEach(edge => {\n      // dagrejs Wiki https://github.com/dagrejs/dagre/wiki#configuring-the-layout\n      g.setEdge(edge.source, edge.target, {\n        weight: edge.weight || 1\n      });\n    });\n    g.setDefaultEdgeLabel(() => ({}));\n    param.nodes = nodes;\n    g.setGraph(param);\n    dagre.layout(g);\n    let coord;\n    // 重新布局时g.nodes()可能为undefined\n    g.nodes().forEach((node) => {\n      coord = g.node(node);\n      if (coord) {\n        const i = nodes.findIndex(it => it.id === node);\n        nodes[i].left = coord.x;\n        nodes[i].top = coord.y;\n        nodes[i].posInfo = {\n          _out: g._out[node],\n          _in: g._in[node],\n          _preds: g._preds[node],\n          _sucs: g._sucs[node]\n        }\n      }\n    });\n    g.edges().forEach((edge) => {\n      coord = g.edge(edge);\n      const i = edges.findIndex(it => it.source === edge.v && it.target === edge.w);\n      if (controlPoints && edges[i].type !== 'loop' && edges[i].shape !== 'loop') {\n        edges[i].controlPoints = coord.points.slice(1, coord.points.length - 1);\n      }\n    });\n    // 将数据挂载到原有数据上，以触发布局\n    nodes.forEach((item, index) => {\n      curnode[index].left = item.left;\n      curnode[index].top = item.top;\n      curnode[index].posInfo = item.posInfo;\n    });\n  }\n  \n  function getFunc(func, value, defaultValue) {\n    let resultFunc;\n    if (func) {\n      resultFunc = func;\n    } else if (_.isNumber(value)) {\n      resultFunc = () => value;\n    } else {\n      resultFunc = () => defaultValue;\n    }\n    return resultFunc;\n  }\n\n  module.exports = drageLayout","'use strict';\n\nconst d3 = require('d3-force');\nconst _ = require('lodash');\nimport Layout from './circleLayout.js';\nimport fruchterman from './fruchterman.js';\nimport gridLayout from './gridLayout.js'\nimport forceLayout from './forceLayout.js'\nimport concentLayout from './concentLayout.js'\nimport drageLayout from './drageLayout.js'\n\n\n// 离散树形布局\nfunction forceTreeLayout(param) {\n  let opts = param.opts;\n  let data = _.cloneDeep(param.data);\n\n  var simulation = d3.forceSimulation(data.nodes)\n    // d3.forceLink(links).distance(20).strength(1)\n    .force('charge', d3.forceManyBody().strength(opts.chargeStrength))\n    .force('center', d3.forceCenter(opts.width / 2, opts.height / 2))\n    .force('link', d3.forceLink(data.edges).distance(opts.link.distance).strength(opts.link.strength))\n    .force('x', d3.forceX())\n    .force('y', d3.forceY())\n    .stop();\n\n\n  for (var i = 0, n = Math.ceil(Math.log(simulation.alphaMin()) / Math.log(1 - simulation.alphaDecay())); i < n; ++i) {\n    simulation.tick();\n  }\n\n  param.data.nodes.forEach((node, index) => {\n    node.top = data.nodes[index].y;\n    node.left = data.nodes[index].x;\n  });\n\n  // 后续需要考虑group的布局\n}\n\n// 后续拓展树形布局\nfunction treeLayout(param) {\n\n}\n\n\n\n\n\nexport default {\n  forceLayout,\n  forceTreeLayout,\n  treeLayout,\n  drageLayout,\n  concentLayout,\n  gridLayout,\n  fruchterman,\n  circleLayout: Layout.circleLayout\n}\n","'use strict';\n\nconst $ = require('jquery');\n\nclass SelectCanvas {\n  constructor() {\n    this.dom = $('<canvas class=\"butterfly-selected-canvas\"></canvas>')[0];\n    this.cxt = this.dom.getContext('2d');\n    this.canvasTop = 0;\n    this.canvasLeft = 0;\n    this.canvasHeight = 0;\n    this.canvasWidth = 0;\n    this.canScrollX = 0;\n    this.canScrollY = 0;\n    this.startX = 0;\n    this.startY = 0;\n    this.endX = 0;\n    this.endY = 0;\n    this._on = null;\n    this._emit = null;\n    this.isDraw = false;\n    this.isActive = false;\n  }\n\n  init(opts) {\n    const root = opts.root;\n    const offset = $(root).offset();\n    this.canvasTop = offset.top;\n    this.canvasLeft = offset.left;\n    this.canvasHeight = $(root).height();\n    this.canvasWidth = $(root).width();\n    this._on = opts._on;\n    this._emit = opts._emit;\n    $(this.dom).attr('width', this.canvasWidth);\n    $(this.dom).attr('height', this.canvasHeight);\n    this.addEventListener();\n    $(this.dom).appendTo(root);\n  }\n\n  resize(opts) {\n    const root = opts.root;\n    const offset = $(root).offset();\n    this.canvasTop = offset.top;\n    this.canvasLeft = offset.left;\n    this.canvasHeight = $(root).height();\n    this.canvasWidth = $(root).width();\n    $(this.dom).attr('width', this.canvasWidth);\n    $(this.dom).attr('height', this.canvasHeight);\n  }\n\n  addEventListener() {\n    this.dom.addEventListener('mousedown', this.mouseDown.bind(this));\n    this.dom.addEventListener('mouseup', this.mouseUp.bind(this));\n    this.dom.addEventListener('mousemove', this.mouseMove.bind(this));\n    this.dom.addEventListener('mouseleave', this.mouseLeave.bind(this));\n  }\n\n  mouseDown(evt) {\n    this.startX = evt.clientX;\n    this.startY = evt.clientY;\n    this.isDraw = true;\n  }\n\n  mouseUp(evt) {\n    this.isDraw = false;\n    this.clearCanvas();\n    const startX = this.startX;\n    const startY = this.startY;\n    const endX = this.endX = evt.clientX;\n    const endY = this.endY = evt.clientY;\n    const toDirection = endX - startX > 0 ? 'right' : 'left'\n\n    const startLeft = startX > endX ? endX : startX;\n    const startTop = startY > endY ? endY : startY;\n    const endLeft = startX > endX ? startX : endX;\n    const endTop = startY > endY ? startY : endY;\n\n\n    this._emit('InnerEvents', {\n      type: 'multiple:select',\n      range: [startLeft, startTop, endLeft, endTop],\n      toDirection\n    });\n\n    this.unActive();\n  }\n\n  mouseMove(evt) {\n    if (!this.isDraw) {\n      return;\n    }\n\n    this.endX = evt.clientX;\n    this.endY = evt.clientY;\n    this.drawRect();\n  }\n\n  mouseLeave(evt) {\n    this.isDraw = false;\n    this.clearCanvas();\n  }\n\n  drawRect() {\n    if (!this.isDraw) {\n      return;\n    }\n    this.clearCanvas();\n    const startX = Math.min(this.startX, this.endX) - this.canvasLeft + this.canScrollX;\n    const startY = Math.min(this.startY, this.endY) - this.canvasTop + this.canScrollY;\n    const width = Math.abs(this.startX - this.endX);\n    const height = Math.abs(this.startY - this.endY);\n\n    this.cxt.beginPath();\n    this.cxt.rect(startX, startY, width, height);\n    this.cxt.fillStyle = '#b3dbff';\n    this.cxt.fill();\n    this.cxt.lineWidth = '1';\n    this.cxt.strokeStyle = '#3da4ff';\n    this.cxt.stroke();\n  }\n\n  clearCanvas() {\n    this.cxt.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\n  }\n\n  getCanvas() {\n    return this.dom;\n  }\n\n  active() {\n    if (!this.isActive) {\n      $(this.dom).addClass('wrapper-up');\n      this.isActive = true;\n    }\n  }\n\n  unActive() {\n    if (this.isActive) {\n      $(this.dom).removeClass('wrapper-up');\n      this.isActive = false;\n    }\n  }\n\n  _changeCanvasInfo(data) {\n    if (data.terScrollX !== undefined) {\n      this.canScrollX = data.terScrollX;\n    }\n    if (data.terScrollY !== undefined) {\n      this.canScrollY = data.terScrollY;\n    }\n  }\n}\n\nexport default SelectCanvas;\n","'use strict';\n\nconst _ = require('lodash');\n\nclass CoordinateService {\n  constructor(opts) {\n    this.canvas = opts.canvas;\n    this.terOffsetX = opts.terOffsetX || 0;\n    this.terOffsetY = opts.terOffsetY || 0;\n    this.terWidth = opts.terWidth || 0;\n    this.terHeight = opts.terHeight || 0;\n    this.canOffsetX = opts.canOffsetX || 0;\n    this.canOffsetY = opts.canOffsetY || 0;\n    this.scale = opts.scale || 1;\n\n    // 中心点\n    this.originX = undefined;\n    this.originY = undefined;\n    // 当前鼠标在容器内的坐标\n    this._currentTerX = 0;\n    this._currentTerY = 0;\n  }\n\n  _changeCanvasInfo(data) {\n    if (data.terOffsetX !== undefined) {\n      this.terOffsetX = data.terOffsetX;\n    }\n    if (data.terOffsetY !== undefined) {\n      this.terOffsetY = data.terOffsetY;\n    }\n    if (data.terWidth !== undefined) {\n      this.terWidth = data.terWidth;\n    }\n    if (data.terHeight !== undefined) {\n      this.terHeight = data.terHeight;\n    }\n    if (data.canOffsetX !== undefined) {\n      this.canOffsetX = data.canOffsetX;\n    }\n    if (data.canOffsetY !== undefined) {\n      this.canOffsetY = data.canOffsetY;\n    }\n    if (data.scale !== undefined) {\n      this._lastScale = this.scale;\n      this.scale = data.scale;\n    }\n    if (data.canvas) {\n      this.canvas = data.canvas;\n    }\n\n    let _isChangeOrigin = false;\n    if (data.originX !== undefined) {\n      this.originX = data.originX;\n      _isChangeOrigin = true;\n    }\n\n    if (data.originY !== undefined) {\n      this.originY = data.originY;\n      _isChangeOrigin = true;\n    }\n\n    if (_isChangeOrigin) {\n      this.canvas.wrapper.style.transformOrigin = `${this.originX}% ${this.originY}%`;\n    }\n\n    let _isChangeMouse = false;\n    if (data.mouseX !== undefined) {\n      if (this._currentTerX !== data.mouseX - this.terOffsetX) {\n        this._currentTerX = (data.mouseX - this.terOffsetX);\n        _isChangeMouse = true;\n      }\n    }\n    if (data.mouseY !== undefined) {\n      if (this._currentTerY !== data.mouseY - this.terOffsetY) {\n        this._currentTerY = (data.mouseY - this.terOffsetY);\n        _isChangeMouse = true;\n      }\n    }\n\n    if (_isChangeMouse) {\n\n      if (this.originX === undefined || this.originY === undefined) {\n        this.originX = 0;\n        this.originY = 0;\n      }\n\n      // i,j\n      let i = this.originX / 100 * this.terWidth;\n      let j = this.originY / 100 * this.terHeight;\n\n      let oldOffset = [parseInt(this.canOffsetX) , parseInt(this.canOffsetY)];\n\n      let _localtionX = (data.mouseX - (i * (1 - this._lastScale) + oldOffset[0]) - this.terOffsetX) / this._lastScale;\n      let _localtionY = (data.mouseY - (j * (1 - this._lastScale) + oldOffset[1]) - this.terOffsetY) / this._lastScale;\n\n      let newOriginX = _localtionX / this.terWidth * 100;\n      let newOriginY = _localtionY / this.terHeight * 100;\n\n      let e = -i * (1 - this._lastScale);\n      let f = -j * (1 - this._lastScale);\n\n      i = newOriginX / 100 * this.terWidth;\n      j = newOriginY / 100 * this.terHeight;\n\n      let g = -i * (1 - this._lastScale);\n      let h = -j * (1 - this._lastScale);\n\n      let _newLeft = g - e + oldOffset[0];\n      let _newTop = h - f + oldOffset[1];\n\n      this.canvas.wrapper.style.transformOrigin = `${newOriginX}% ${newOriginY}%`;\n      this.canvas.move([_newLeft, _newTop]);\n      this.originX = newOriginX;\n      this.originY = newOriginY;\n    }\n  }\n  canvas2terminal(coordinates, options) {\n    return [this._canvas2terminal('x', coordinates[0], options), this._canvas2terminal('y', coordinates[1], options)];\n  }\n  terminal2canvas(coordinates, options) {\n    return [this._terminal2canvas('x', coordinates[0], options), this._terminal2canvas('y', coordinates[1], options)];\n  }\n  _canvas2terminal(pos, coordinate, options) {\n    let scale = _.get(options, 'scale') || this.scale;\n    let canOffsetX = _.get(options, 'canOffsetX') !== undefined ? _.get(options, 'canOffsetX') : this.canOffsetX;\n    let canOffsetY = _.get(options, 'canOffsetY') !== undefined ? _.get(options, 'canOffsetY') : this.canOffsetY;\n    let terOffsetX = _.get(options, 'terOffsetX') !== undefined ? _.get(options, 'terOffsetX') : this.terOffsetX;\n    let terOffsetY = _.get(options, 'terOffsetY') !== undefined ? _.get(options, 'terOffsetY') : this.terOffsetY;\n    let originX = _.get(options, 'originX') !== undefined ? _.get(options, 'originX') : this.originX || 0;\n    let originY = _.get(options, 'originY') !== undefined ? _.get(options, 'originY') : this.originY || 0;\n    if (pos === 'x') {\n      let transformOriginX  = originX / 100 * this.terWidth;\n      return coordinate * scale + (transformOriginX * (1 - scale) + canOffsetX) + terOffsetX;\n    }\n    if (pos === 'y') {\n      let transformOriginY  = originY / 100 * this.terHeight;\n      return coordinate * scale + (transformOriginY * (1 - scale) + canOffsetY) + terOffsetY;\n    }\n  }\n\n  _terminal2canvas(pos, coordinate, options) {\n    let scale = _.get(options, 'scale') || this.scale;\n    let canOffsetX = _.get(options, 'canOffsetX') !== undefined ? _.get(options, 'canOffsetX') : this.canOffsetX;\n    let canOffsetY = _.get(options, 'canOffsetY') !== undefined ? _.get(options, 'canOffsetY') : this.canOffsetY;\n    let terOffsetX = _.get(options, 'terOffsetX') !== undefined ? _.get(options, 'terOffsetX') : this.terOffsetX;\n    let terOffsetY = _.get(options, 'terOffsetY') !== undefined ? _.get(options, 'terOffsetY') : this.terOffsetY;\n    let originX = _.get(options, 'originX') !== undefined ? _.get(options, 'originX') : this.originX || 0;\n    let originY = _.get(options, 'originY') !== undefined ? _.get(options, 'originY') : this.originY || 0;\n    if (pos === 'x') {\n      let transformOriginX  = originX / 100 * this.terWidth;\n      return (coordinate - (transformOriginX * (1 - scale) + canOffsetX) - terOffsetX) / scale;\n    }\n    if (pos === 'y') {\n      let transformOriginY  = originY / 100 * this.terHeight;\n      return (coordinate - (transformOriginY * (1 - scale) + canOffsetY) - terOffsetY) / scale;\n    }\n  }\n}\n\nexport default CoordinateService;\n","'use strict';\n\nconst $ = require('jquery');\nconst _ = require('lodash');\n\nclass GridService {\n  constructor(opts) {\n    this.root = opts.root;\n    this.canvas = opts.canvas;\n\n    this.domWrapper = _.get(opts, 'canvas.wrapper');\n    this.canvasHeight = 0;\n    this.canvasWidth = 0;\n\n    this.dom = null;\n    this.isActive = false;\n    this.theme = _.get(opts, 'theme', {}) || {\n      shapeType: 'circle',  // 展示的类型，支持line & circle\n      gap: 5,            // 网格间隙\n      adsorbGap: '5px',      // 吸附间距\n      backgroud: '#fff',  // 网格背景颜色\n      lineColor: '#000',  // 网格线条颜色\n      lineWidth: '1px',   // 网格粗细\n      circleRadiu: 2, // 圆点半径\n      circleColor: '#000' // 断电颜色\n    };\n  }\n  create(options = {}) {\n    this.theme = _.merge(this.theme, options.theme || {});\n\n    this.canvasHeight = $(this.root).height();\n    this.canvasWidth = $(this.root).width();\n\n    this.dom = $('<canvas class=\"butterfly-gird-canvas\"></canvas>')[0];\n    $(this.dom).attr('width', this.canvasWidth);\n    $(this.dom).attr('height', this.canvasHeight);\n\n    $(this.dom).appendTo(this.root);\n\n    if (this.theme.shapeType === 'circle') {\n      this.createCircle();\n    } else if (this.theme.shapeType === 'line') {\n      this.createLine();\n    }\n    this.isActive = true;\n  }\n  createCircle() {\n    let _ctx = this.dom.getContext('2d');\n    _ctx.fillStyle = this.theme.circleColor || '#000';\n    let _p = Math.PI * 2;\n    let _gap = parseInt(this.theme.gap);\n    _gap = _gap < 5 ? 5 : _gap;\n    for (let i = 0; i < this.canvasWidth; i += _gap) {\n      for (let j = 0; j < this.canvasHeight; j += _gap) {\n        _ctx.moveTo(i, j);\n        _ctx.arc(i, j, this.theme.circleRadiu, 0, _p);\n      }\n    }\n    _ctx.fill();\n  }\n  createLine() {\n    let _ctx = this.dom.getContext('2d');\n    _ctx.strokeStyle = this.theme.lineColor || '#000';\n    _ctx.lineWidth = this.theme.lineWidth || 1;\n    let _gap = parseInt(this.theme.gap);\n    _gap = _gap < 5 ? 5 : _gap;\n    for (let j = 0; j < this.canvasHeight; j += _gap) {\n      _ctx.beginPath();\n      _ctx.moveTo(0, j);\n      _ctx.lineTo(this.canvasWidth, j);\n      _ctx.stroke();\n      _ctx.closePath();\n    }\n    for (let i = 0; i < this.canvasWidth; i += _gap) {\n      _ctx.beginPath();\n      _ctx.moveTo(i, 0);\n      _ctx.lineTo(i, this.canvasHeight);\n      _ctx.stroke();\n      _ctx.closePath();\n    }\n    _ctx.stroke();\n  }\n  justifyAllCoordinate() {\n    let groups = this.canvas.groups;\n    let nodes = this.canvas.nodes;\n\n    let _justifyItem = (item, type) => {\n      let _sx = item.left;\n      let _sy = item.top;\n      let _ex = item.left + item.getWidth();\n      let _ey = item.top + item.getHeight();\n\n      let _left = _sx % this.theme.gap;\n      let _right = _ex % this.theme.gap;\n      let _top = _sy % this.theme.gap;\n      let _bottom = _ey % this.theme.gap;\n      let _posLeft = this.theme.gap - _left;\n      let _posRight = this.theme.gap - _right;\n      let _posTop = this.theme.gap - _top;\n      let _posBottom = this.theme.gap - _bottom;\n\n      let _pos = {\n        left: Infinity,\n        right: Infinity,\n        top: Infinity,\n        bottom: Infinity\n      };\n\n      if (_left < _right && _left < _pos['left']) {\n        _pos['left'] = _left;\n      }\n      if (_posLeft < _left && _posLeft < _pos['right']) {\n        _pos['right'] = _posLeft;\n      }\n\n      if (_right < _left && _right < _pos['right']) {\n        _pos['left'] = _right;\n      }\n      if (_posRight < _right && _posRight < _pos['left']) {\n        _pos['right'] = _posRight;\n      }\n\n      if (_top < _bottom && _top < _pos['top']) {\n        _pos['top'] = _top;\n      }\n      if (_posTop < _top && _posTop < _pos['bottom']) {\n        _pos['bottom'] = _posTop;\n      }\n\n      if (_bottom < _top && _bottom < _pos['bottom']) {\n        _pos['top'] = _bottom;\n      }\n      if (_posBottom < _bottom && _posBottom < _pos['top']) {\n        _pos['bottom'] = _posBottom;\n      }\n\n      let result = [item.left, item.top];\n\n      _pos['left'] = _pos['left'] <= this.theme.adsorbGap ? _pos['left'] : Infinity;\n      _pos['right'] = _pos['right'] <= this.theme.adsorbGap ? _pos['right'] : Infinity;\n      _pos['top'] = _pos['top'] <= this.theme.adsorbGap ? _pos['top'] : Infinity;\n      _pos['bottom'] = _pos['bottom'] <= this.theme.adsorbGap ? _pos['bottom'] : Infinity;\n\n      _pos['left'] < _pos['right'] && (result[0] -= _pos['left']);\n      _pos['right'] < _pos['left'] && (result[0] += _pos['right']);\n      _pos['top'] < _pos['bottom'] && (result[1] -= _pos['top']);\n      _pos['bottom'] < _pos['top'] && (result[1] += _pos['bottom']);\n\n      if (result[0] !== item.left || result[1] !== item.top) {\n        if (type === 'node') {\n          this.canvas._moveNode(item, result[0], result[1]);\n        } else if (type === 'group') {\n          this.canvas._moveGroup(item, result[0], result[1]);\n        }\n      }\n    };\n\n    groups.forEach((_group) => {\n      _justifyItem(_group, 'group');\n      (_group.nodes || []).forEach((_node) => {\n        _justifyItem(_node, 'node');\n      });\n    });\n\n    nodes.forEach((_node) => {\n      _justifyItem(_node, 'node');\n    });\n  }\n  destroy() {\n    this.dom.remove();\n    this.isActive = false;\n  }\n}\n\nexport default GridService;\n","'use strict';\n\nconst $ = require('jquery');\nconst _ = require('lodash');\n\nclass GuidelineService {\n  constructor(opts) {\n    this.root = opts.root;\n    this.canvas = opts.canvas;\n    this.dom = null;\n    this.cxt = null;\n\n    this.isActive = false;\n\n    this.limitNum = opts.limitNum;\n    this.theme = {\n      lineColor: '#9fd1ff',\n      lineWidth: 1\n    };\n  }\n  create(options = {}) {\n    this.theme = _.merge(this.theme, options.theme || {});\n\n    this.canvasHeight = $(this.root).height();\n    this.canvasWidth = $(this.root).width();\n\n    this.dom = $('<div class=\"butterfly-gird-canvas-wrapper\"></div>')[0];\n\n    this.guideLineCanvas = $('<canvas class=\"butterfly-guideline-canvas\"></canvas>')[0];\n    $(this.guideLineCanvas).attr('width', this.canvasWidth);\n    $(this.guideLineCanvas).attr('height', this.canvasHeight);\n    $(this.guideLineCanvas).appendTo(this.dom);\n\n    $(this.dom).appendTo(this.root);\n\n    this.cxt = this.guideLineCanvas.getContext('2d');\n    this.cxt.strokeStyle = this.theme.lineColor || '#000';\n    this.cxt.lineWidth = this.theme.lineWidth || 1;\n    this.isActive = true;\n  }\n  guidLine(\n    moveTo = [0, 0],\n    lineTo = [0, 0]\n  ) {\n    const process = (coord) => {\n      return Math.floor(coord) + 0.5;\n    };\n    this.cxt.beginPath();\n    this.cxt.moveTo(process(moveTo[0]), process(moveTo[1]));\n    this.cxt.lineTo(process(lineTo[0]), process(lineTo[1]));\n    this.cxt.stroke();\n    this.cxt.closePath();\n  } \n  draw(item, type) {\n\n    this.cxt.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\n\n    let _left = parseInt(item.left);\n    let _right = parseInt(item.left + item.getWidth());\n    let _top = parseInt(item.top);\n    let _bottom = parseInt(item.top + item.getHeight());\n    let _leftDis = Infinity;\n    let _rightDis = Infinity;\n    let _topDis = Infinity;\n    let _bottomDis = Infinity;\n\n    let _leftItem = null;\n    let _rightItem = null;\n    let _topItem = null;\n    let _bottomItem = null;\n\n    let groups = this.canvas.groups;\n    let nodes = this.canvas.nodes;\n    groups.forEach((_group) => {\n      if (type === 'group' && item.id === _group.id) {\n        return;\n      }\n\n      let _groupLeft = parseInt(_group.left);\n      let _groupRight = parseInt(_group.left + _group.getWidth());\n      let _groupTop = parseInt(_group.top);\n      let _groupBottom = parseInt(_group.top + _group.getHeight());\n\n      // 向左对齐的元素\n      if (_left === _groupLeft) {\n        if (Math.abs(_groupTop - _top) < _topDis) {\n          _topDis = Math.abs(_groupTop - _top);\n          _leftItem = _group;\n        }\n      }\n\n      // 向右对齐的元素\n      if (_right === _groupRight) {\n        if (Math.abs(_groupBottom - _bottom) < _bottomDis) {\n          _bottomDis = Math.abs(_groupBottom - _bottom);\n          _rightItem = _group;\n        }\n      }\n\n      // 向上对齐的元素\n      if (_top === _groupTop) {\n        if (Math.abs(_groupLeft - _left) < _leftDis) {\n          _leftDis = Math.abs(_groupLeft - _left);\n          _topItem = _group;\n        }\n      }\n\n      // 向下对齐的元素\n      if (_bottom === _groupBottom) {\n        if (Math.abs(_groupRight - _right) < _rightDis) {\n          _rightDis = Math.abs(_groupRight - _right);\n          _bottomItem = _group;\n        }\n      }\n    });\n    \n    nodes.forEach((_node) => {\n      if (type === 'node' && item.id === _node.id) {\n        return;\n      }\n\n      let _nodeLeft = parseInt(_node.left);\n      let _nodeRight = parseInt(_node.left + _node.getWidth());\n      let _nodeTop = parseInt(_node.top);\n      let _nodeBottom = parseInt(_node.top + _node.getHeight());\n\n      if (_node._group) {\n        _nodeLeft += _node._group.left;\n        _nodeRight += _node._group.left;\n        _nodeTop += _node._group.top;\n        _nodeBottom += _node._group.top;\n      }\n\n      // 向左对齐的元素\n      if (_left === _nodeLeft) {\n        if (Math.abs(_nodeTop - _top) < _topDis) {\n          _topDis = Math.abs(_nodeTop - _top);\n          _leftItem = _node;\n        }\n      }\n\n      // 向右对齐的元素\n      if (_right === _nodeRight) {\n        if (Math.abs(_nodeBottom - _bottom) < _bottomDis) {\n          _bottomDis = Math.abs(_nodeBottom - _bottom);\n          _rightItem = _node;\n        }\n      }\n\n      // 向上对齐的元素\n      if (_top === _nodeTop) {\n        if (Math.abs(_nodeLeft - _left) < _leftDis) {\n          _leftDis = Math.abs(_nodeLeft - _left);\n          _topItem = _node;\n        }\n      }\n\n      // 向下对齐的元素\n      if (_bottom === _nodeBottom) {\n        if (Math.abs(_nodeRight - _right) < _rightDis) {\n          _rightDis = Math.abs(_nodeRight - _right);\n          _bottomItem = _node;\n        }\n      }\n    });\n\n    if (_leftItem) {\n      let startY = _top > _leftItem.top ? _leftItem.top : _top;\n      let endY = _top > _leftItem.top ? _bottom : _leftItem.top + _leftItem.getHeight();\n      this.guidLine([_left, startY], [_left, endY]);\n    }\n\n    if (_rightItem) {\n      let startY = _top > _rightItem.top ? _rightItem.top : _top;\n      let endY = _top > _rightItem.top ? _bottom : _rightItem.top + _rightItem.getHeight();\n      this.guidLine([_right, startY], [_right, endY]);\n    }\n\n    if (_topItem) {\n      let startX = _left > _topItem.left ? _topItem.left : _left;\n      let endX = _left > _topItem.left ? _right : _topItem.left + _topItem.getWidth();\n      this.guidLine([startX, _top], [endX, _top]);\n    }\n\n    if (_bottomItem) {\n      let startX = _left > _bottomItem.left ? _bottomItem.left : _left;\n      let endX = _left > _bottomItem.left ? _right : _bottomItem.left + _bottomItem.getWidth();\n      this.guidLine([startX, _bottom], [endX, _bottom]);\n    }\n  }\n  zoom(scale) {\n    $(this.dom).css({\n      transform: `scale(${scale})`\n    });\n    this.clearCanvas();\n  }\n  move(x, y) {\n    $(this.dom)\n      .css('left', x)\n      .css('top', y);\n    this.clearCanvas();\n  }\n  clearCanvas() {\n    this.cxt && this.cxt.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\n  }\n  destroy() {\n    $(this.dom).destroy();\n    this.isActive = false;\n  }\n}\n\nexport default GuidelineService;\n","const _ = require('lodash');\nconst $ = require('jquery');\n\n// 每一个dot是一个圆形或者\nconst DOT_COLOR = 'rgba(76, 158, 164, 1)';\nconst GROUP_COLOR = 'rgba(61, 86, 92, 1)';\nconst DOT_ACTIVE_COLOR = 'rgba(255, 253, 76, 1)';\nconst GROUP_ACTIVE_COLOR = 'rgba(255, 253, 76, 1)';\nconst SAFE_DISTANCE = 20;\n\n// 修改一个element的css的属性\nconst modifyCSS = (ele, cssStyle) => {\n  if (!ele || !ele.style) {\n    return;\n  }\n\n  Object.keys(cssStyle).forEach(key => {\n    ele.style[key] = cssStyle[key];\n  });\n};\n\n// 获取Canvas缩放比，兼容高清屏\nconst getPixelRatio = function (context) {\n  const backingStore = context.backingStorePixelRatio ||\n  context.webkitBackingStorePixelRatio ||\n  context.mozBackingStorePixelRatio ||\n  context.msBackingStorePixelRatio ||\n  context.oBackingStorePixelRatio ||\n  context.backingStorePixelRatio || 1;\n  return (window.devicePixelRatio || 1) / backingStore;\n};\n\n// check constructor 的 options\nconst checkOpts = (options) => {\n  if(!options) {\n    throw new Error('options cant be empty');\n  }\n\n  if(!options.root || typeof options.root !== 'object' || !$(options.root)) {\n    throw new Error('options.root must be a html element');\n  }\n\n  if(!options.move || typeof options.move !== 'function') {\n    throw new Error('options.move must be a fuction');\n  }\n\n  if(!options.terminal2canvas || typeof options.terminal2canvas !== 'function') {\n    throw new Error('options.move must be a fuction');\n  }\n\n}\n\n/**\n * options:\n *  height {Number} 缩略图高度 default 200,\n *  width  {Number} 缩略图宽度 default 200,\n *  className {String} default: butterfly-minimap-container\n *  containerStyle {Object} 外层css\n *  viewportStyle {Object} 视口css\n *  backgroudStyle {Object} 底层css\n *  nodeColor {String} 节点颜色\n *  groupColor {String} 节点组颜色\n *  root {Element} 画布容器节点\n *  containerWidth {Number} 画布的宽度, 可自定义\n *  containerHeight {Number} 同上\n *  nodes {Pointer[]} 节点信息\n *    node.left, node.top 节点的坐标轴信息\n *  groups {Object[]} 节点组信息\n *    group.left, group.top, group.width, group.height 节点组的二维信息\n *  offset {Pointer} 偏移信息\n *  zoom {Number} 画布当前缩放比\n *  move {Function} 缩略图互动函数, 用于移动画布, 参考小蝴蝶的move\n *  terminal2canvas {Function} 互动函数, 屏幕坐标到画布坐标的转换\n *  safeDistance {Number} 画布视口在minimap距离边距的安全距离，默认20\n *  activeNodeColor {String} 选中的节点颜色\n *  activeGroupColor {String} 选中的节点组颜色\n *  events {String[]} 补充的监听事件\n */\nclass Minimap {\n  constructor(options) {\n    checkOpts(options);\n\n    this.root = options.root;\n    this.$root = $(this.root);\n\n    this.options = {\n      height: 200,\n      width: 200,\n      className: 'butterfly-minimap-container',\n      containerStyle: {},\n      viewportStyle: {},\n      backgroudStyle: {},\n      nodeColor: DOT_COLOR,\n      groupColor: GROUP_COLOR,\n      activeNodeColor: DOT_ACTIVE_COLOR,\n      activeGroupColor: GROUP_ACTIVE_COLOR,\n      containerWidth: $(this.root).width(),\n      containerHeight: $(this.root).height(),\n      nodes: [],\n      groups: [],\n      offset: [0, 0],\n      zoom: 1,\n      move: () => null,\n      terminal2canvas: () => null,\n      safeDistance: SAFE_DISTANCE,\n      ...options\n    };\n\n    // 画布到缩略图的缩放比\n    this.ratio = 1;    \n\n    // 初始化容器\n    this.initContainer();\n    // 渲染视口\n    this.renderViewPort();\n    // 渲染背景\n    this.renderBG();\n  }\n\n\n  // 获取所有元素的屏幕坐标\n  getItemsPoint = () => {\n    const nodes = _.cloneDeep(this.options.nodes);\n    const groups = _.cloneDeep(this.options.groups);\n    const {canvas2terminal} = this.options;\n    const height = this.$root.height();\n    const width = this.$root.width();\n\n    // 增加两个虚拟的点，防止只有一个node时宽度过大的问题\n    nodes.push({left: 0, top: 0, height: 1, width: 1});\n    nodes.push({left: width, top: height, height: 1, width: 1});\n\n    // 计算所有 nodes 的真实坐标\n    for(let node of nodes) {\n      if(node.group) {\n        const group = _.find(groups, {id: node.group});\n\n        if(!group) {\n          continue;\n        }\n\n        node.rleft = group.left + node.left;\n        node.rtop = group.top + node.top;\n\n        continue;\n      }\n\n      node.rleft = node.left;\n      node.rtop = node.top;\n    }\n\n    groups.forEach(group => {\n      const leftTop = [group.left, group.top];\n      const rightBottom = [group.left + group.width, group.top + group.height];\n\n      const screenLeftTop = canvas2terminal(leftTop);\n      const screenRightBottom =  canvas2terminal(rightBottom);\n\n      group.screenLeftTop = screenLeftTop;\n      group.screenRightBottom = screenRightBottom;\n\n      group.left = screenLeftTop[0];\n      group.top = screenLeftTop[1];\n      group.width = screenRightBottom[0] - screenLeftTop[0];\n      group.height = screenRightBottom[1] - screenLeftTop[1];\n    });\n\n    nodes.forEach(node => {\n      const leftTop = [node.rleft, node.rtop];\n      const rightBottom = [node.rleft + node.width, node.rtop + node.height];\n\n      const screenLeftTop = canvas2terminal(leftTop);\n      const screenRightBottom =  canvas2terminal(rightBottom);\n\n      node.left = screenLeftTop[0];\n      node.top = screenLeftTop[1];\n      node.width = screenRightBottom[0] - screenLeftTop[0];\n      node.height = screenRightBottom[1] - screenLeftTop[1];\n    });\n\n    return {\n      groups, nodes\n    }\n  }\n\n  // 获取画布的有内容的区域\n  getBBox() {\n    const {nodes, groups} = this.getItemsPoint()\n\n    const check = (v) => {\n      return _.isNumber(v) ? v : 0;\n    }\n\n    const allNTop = nodes.map(node => node.top);\n    const allNLeft = nodes.map(node => node.left);\n    const allNBottom = nodes.map(node => node.top + node.height);\n    const allNRight = nodes.map(node => node.left + node.width);\n\n    const allGTop = groups.map(group => group.top);\n    const allGLeft = groups.map(group => group.left);\n    const allGBottom = groups.map(group => group.top + group.height);\n    const allGRight = groups.map(group => group.left + group.width);\n\n    const allTop = allNTop.concat(allGTop);\n    const allLeft = allNLeft.concat(allGLeft);\n\n    const allBottom = allNBottom.concat(allGBottom);\n    const allRight = allNRight.concat(allGRight);\n\n    const minX = check(_.min(allLeft));\n    const minY = check(_.min(allTop));\n\n    const maxX = check(_.max(allRight));\n    const maxY = check(_.max(allBottom));\n\n    return {\n      minX: minX,\n      minY: minY,\n      width: maxX - minX,\n      height: maxY - minY,\n    }\n  }\n\n  // 获取画布和缩略图的缩放比\n  setRatio() {\n    const height = this.options.height;\n    const width = this.options.width;\n    const graphSize = this.getBBox();\n\n    if(graphSize.width === 0 || graphSize.height === 0) {\n      return 0;\n    }\n\n    const ratio = Math.min(width / graphSize.width, height / graphSize.height);\n\n    this.ratio = Number(ratio.toFixed(2));\n  }\n\n  // 更新小地图数据\n  update({\n    nodes = [],\n    groups = [],\n    zoom = 1,\n    offset = [0, 0],\n  }) {\n    this.options.nodes = nodes;\n    this.options.groups = groups;\n    this.options.zoom = zoom;\n    this.options.offset = offset;\n\n    this.debounceRender();\n  }\n\n  getViewportBBox = () => {\n    const $viewport = $(this.viewportDOM);\n    const parent = $viewport.offsetParent();\n    const offset = $viewport.offset();\n    const poffset = $(parent).offset();\n    const left = offset.left - poffset.left;\n    const top = offset.top - poffset.top;\n\n    const width = $viewport.width();\n    const height = $viewport.height();\n    const right = left + width;\n    const bottom = top + height;\n\n    return {\n      left, top, right,bottom, height, width\n    }\n  }\n\n  // 初始化画布\n  initContainer() {\n    const {\n      height, width, className, \n      viewportStyle, backgroudStyle, containerStyle\n    } = this.options;\n\n    this.container = document.createElement('div');\n    this.viewportDOM = document.createElement('div');\n    this.backgroundDOM = document.createElement('div');\n\n    this.container.setAttribute('class', className);\n\n    const initStyle = {\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      overflow: 'hidden',\n      height: height + 'px',\n      width: width + 'px'\n    };\n\n    modifyCSS(this.container, {\n      ...initStyle,\n      right: '10px',\n      bottom: '10px',\n      left: 'none',\n      top: 'none',\n      height:  height + 'px',\n      width: width + 'px',\n      border: '1px solid #aaa',\n      'z-index': 100,\n      ...containerStyle\n    });\n\n    modifyCSS(this.viewportDOM , {\n      ...initStyle,\n      left: 0,\n      top: 0,\n      // border: '1px solid pink',\n      'background-color': 'rgba(79, 111, 126, 0.4)',\n      ...viewportStyle,\n    });\n\n    modifyCSS(this.backgroundDOM , {      \n      ...initStyle,\n      ...backgroudStyle,\n      height: height + 'px',\n      width: width + 'px',      \n    });\n\n    this.root.appendChild(this.container);\n    this.container.appendChild(this.backgroundDOM);\n    this.container.appendChild(this.viewportDOM);\n\n    this.initBGCanvas();\n    this.initViewportEvts();\n  }\n\n  // 创建BG canvas\n  initBGCanvas() {\n    const {width, height} = this.options;\n    const canvasDom = document.createElement('canvas');\n    this.backgroundDOM.appendChild(canvasDom);\n\n    canvasDom.setAttribute('width', width);\n    canvasDom.setAttribute('height', height);\n    modifyCSS(canvasDom, {\n      position: 'absolute',\n      width: '100%',\n      height: '100%',\n      left: 0,\n      top: 0\n    });\n\n    const cvsCtx = canvasDom.getContext('2d');\n    // 初始化2D画布\n    this.cvsCtx = cvsCtx;\n    this.cvsRatio = getPixelRatio(cvsCtx);\n    cvsCtx.scale(this.cvsRatio, this.cvsRatio);\n  }\n\n  // 初始化视窗事件\n  initViewportEvts() {\n    let dragging = false;\n    let x = 0;\n    let y = 0;\n    let left = 0;\n    let top = 0;\n\n    this.viewportEvents = {\n      mousedown: (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        const viewportDOM = this.viewportDOM;\n\n        if (e.target !== this.viewportDOM) {\n          return;\n        }\n\n        const viewportBBox = this.getViewportBBox();\n\n        left = parseInt(viewportBBox.left, 10);\n        top = parseInt(viewportBBox.top, 10);\n\n        dragging = true;\n        x = e.clientX;\n        y = e.clientY;\n      },\n      mousemove: (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (!dragging || _.isNil(e.clientX) || _.isNil(e.clientY)) {\n          return;\n        }\n\n        let dx = x - e.clientX;\n        let dy = y - e.clientY;\n\n        left -= dx;\n        top -= dy;\n\n        const {width: mapWidth, height: mapHeight, safeDistance} = this.options;\n        const {width: vpWidth, height: vpHeight} = this.getViewportBBox();\n\n        // 限制视口不能够超出 minimap 的安全距离\n        if(\n          left >= mapWidth - safeDistance ||\n          top >= mapHeight - safeDistance ||\n          left + vpWidth <= safeDistance ||\n          top + vpHeight <= safeDistance\n        ) {\n          left += dx;\n          top += dy;\n\n          return;\n        }\n\n\n        modifyCSS(this.viewportDOM, {\n          left: left + 'px',\n          top: top + 'px'\n        });\n\n        const {minX, minY} = this.getBBox();\n        const offset = this.$root.offset();\n        const boffset = this.options.offset;\n\n        const ddx = (((-left / this.ratio) + offset.left) - minX) * this.ratio;\n        const ddy = (((-top / this.ratio) + offset.top) - minY) * this.ratio;\n        \n        this.options.move(\n          [\n            boffset[0] + ddx / this.ratio,\n            boffset[1] + ddy / this.ratio\n          ]\n        );\n\n        x = e.clientX;\n        y = e.clientY;\n      },\n      mouseleave: () => {\n        dragging = false;\n      },\n      mouseup: () => {\n        dragging = false;\n      }\n    };\n\n    Object.keys(this.viewportEvents).forEach(key => {\n      this.container.addEventListener(key, this.viewportEvents[key]);\n    });\n  }\n\n  // 渲染缩略图canvas\n  renderBG() {\n    const cvsCtx = this.cvsCtx;\n    const {width, height, nodeColor, groupColor, activeNodeColor, activeGroupColor} = this.options;\n    const cvsRatio = this.cvsRatio;\n\n    cvsCtx.clearRect(0, 0, width, height);\n\n    // 根据所有点的信息画出所有的点\n    const {nodes, groups} = this.getItemsPoint();\n    const {minX, minY} = this.getBBox();\n\n    groups.forEach(group => {\n      const left = (group.left - minX) * this.ratio;\n      const top = (group.top - minY) * this.ratio;\n      const width = group.width * this.ratio;\n      const height = group.height * this.ratio;\n      const minimapActive = group.minimapActive;\n\n      if(minimapActive) {\n        cvsCtx.fillStyle = activeGroupColor;\n      } else {\n        cvsCtx.fillStyle = groupColor;\n      }\n\n      cvsCtx.fillRect(left / cvsRatio, top / cvsRatio, width / cvsRatio, height / cvsRatio);\n    });\n\n    nodes.forEach(node => {\n      const left = (node.left - minX) * this.ratio;\n      const top = (node.top - minY) * this.ratio;\n      const width = node.width * this.ratio;\n      const height = node.height * this.ratio;\n\n      if(node.minimapActive) {\n        cvsCtx.fillStyle = activeNodeColor;\n      } else {\n        cvsCtx.fillStyle = nodeColor;\n      }\n\n      // cvsCtx.beginPath();\n      cvsCtx.fillRect(left / cvsRatio, top / cvsRatio, width / cvsRatio, height / cvsRatio);\n      // cvsCtx.arc(left / cvsRatio, top / cvsRatio, DOT_SIZE / cvsRatio, 0, 2*Math.PI);\n      // cvsCtx.closePath();\n      // cvsCtx.fill();\n    });\n  }\n\n  // 绘制出拖动框\n  renderViewPort() {\n    this.setRatio();\n\n    const {minX, minY} = this.getBBox();\n\n    const {top, left} = this.$root.offset();\n\n    const rootWidth = this.$root.width();\n    const rootHeight = this.$root.height();\n    const offset = [left - minX, top - minY];\n\n    // 获取画布到minimap的缩放比\n    const ratio = this.ratio;\n\n    const vwidth = rootWidth * this.ratio;\n    const vheight = rootHeight * this.ratio;\n    const vleft = Math.round(Math.round(offset[0]) * ratio);\n    const vtop = Math.round(Math.round(offset[1]) * ratio);\n\n    modifyCSS(this.viewportDOM, {\n      width: `${vwidth}px`,\n      height: `${vheight}px`,\n      left: `${vleft}px`,\n      top: `${vtop}px`,\n    });\n  }\n\n  // 延时渲染\n  debounceRender = _.debounce(() => {\n    this.renderViewPort();\n    this.renderBG();\n  }, 100)\n\n  destroy() {\n    // 销毁DOM\n    this.root.removeChild(this.container);\n  }\n}\n\nexport default Minimap;\n","'use strict';\n\nconst $ = require('jquery');\nconst _ = require('lodash');\nconst domtoimage = require('dom-to-image');\n\nimport Canvas from \"../interface/canvas\";\nimport Node from '../node/baseNode';\nimport Edge from '../edge/baseEdge';\nimport Group from '../group/baseGroup';\nimport Endpoint from '../endpoint/baseEndpoint';\nimport Layout from '../utils/layout/layout';\nimport SelectCanvas from '../utils/selectCanvas';\n// 画布和屏幕坐标地换算\nimport CoordinateService from '../utils/coordinate';\n// scope的比较\nimport ScopeCompare from '../utils/scopeCompare';\n// 网格模式\nimport GridService from '../utils/girdService';\n// 辅助线模式\nimport GuidelineService from '../utils/guidelineService';\n// 小地图模式\nimport Minimap from '../utils/minimap';\n// 线段动画\nimport LinkAnimateUtil from '../utils/link_animate';\n\n\nimport './baseCanvas.less';\n\nclass BaseCanvas extends Canvas {\n  constructor(options) {\n    super(options);\n    this.root = options.root;\n    this.layout = options.layout; // layout部分也需要重新review\n    this.zoomable = options.zoomable || false; // 可缩放\n    this.moveable = options.moveable || false; // 可平移\n    this.draggable = options.draggable || false; // 可拖动\n    this.linkable = options.linkable || false; // 可连线\n    this.disLinkable = options.disLinkable || false; // 可拆线\n\n    this.theme = {\n      edge: {\n        type: _.get(options, 'theme.edge.type') || 'Bezier',\n        Class: _.get(options, 'theme.edge.Class') || Edge,\n        arrow: _.get(options, 'theme.edge.arrow'),\n        arrowPosition: _.get(options, 'theme.edge.arrowPosition'),\n        arrowOffset: _.get(options, 'theme.edge.arrowOffset'),\n        label: _.get(options, 'theme.edge.label'),\n        isRepeat: _.get(options, 'theme.edge.isRepeat') || false,\n        isLinkMyself: _.get(options, 'theme.edge.isLinkMyself') || false,\n        isExpandWidth: _.get(options, 'theme.edge.isExpandWidth') || false,\n        defaultAnimate: _.get(options, 'theme.edge.defaultAnimate') || false,\n      },\n      endpoint: {\n        position: _.get(options, 'theme.endpoint.position'),\n        linkableHighlight: _.get(options, 'theme.endpoint.linkableHighlight') || false,\n        limitNum: _.get(options, 'theme.endpoint.limitNum'),\n        expandArea: {\n          left: _.get(options, 'theme.endpoint.expandArea.left') || 10,\n          right: _.get(options, 'theme.endpoint.expandArea.right') || 10,\n          top: _.get(options, 'theme.endpoint.expandArea.top') || 10,\n          bottom: _.get(options, 'theme.endpoint.expandArea.bottom') || 10,\n        },\n      },\n      zoomGap: _.get(options, 'theme.zoomGap') || 0.001,\n      // 鼠标到达边缘画布自动移动\n      autoFixCanvas: {\n        enable: _.get(options, 'theme.autoFixCanvas.enable', false),\n        autoMovePadding: _.get(options, 'theme.autoFixCanvas.autoMovePadding') || [20, 20, 20, 20] // 上，右，下，左\n      },\n      // 自动适配父级div大小\n      autoResizeRootSize: _.get(options, 'theme.autoResizeRootSize', true)\n    };\n\n    // 贯穿所有对象的配置\n    this.global = _.get(options, 'global', {\n      isScopeStrict: _.get(options, 'global.isScopeStrict'), // 是否为scope的严格模式\n      limitQueueLen: 5 // 默认操作队列只有5步\n    });\n\n    // 放大缩小和平移的数值\n    this._zoomData = 1;\n    this._moveData = [0, 0];\n    this._zoomTimer = null;\n\n    this.groups = [];\n    this.nodes = [];\n    this.edges = [];\n\n    // 框选模式，需要重新考虑(默认单选)\n    this.isSelectMode = false;\n    this.selecContents = [];\n    this.selecMode = 'include';\n    this.selectItem = {\n      nodes: [],\n      edges: [],\n      groups: [],\n      endpoints: []\n    };\n    // 框选前需要纪录状态\n    this._remarkZoom = undefined;\n    this._remarkMove = undefined;\n\n    this.svg = null;\n    this.wrapper = null;\n    this.canvasWrapper = null;\n    // 加一层wrapper方便处理缩放，平移\n    this._genWrapper();\n    // 加一层svg画线条\n    this._genSvgWrapper();\n    // 加一层canvas方便处理辅助\n    this._genCanvasWrapper();\n    // 动画初始化\n    LinkAnimateUtil.init(this.svg);\n\n    // 统一处理画布拖动事件\n    this._dragType = null;\n    this._dragNode = null;\n    this._dragEndpoint = null;\n    this._dragEdges = [];\n    this._dragGroup = null;\n\n    // 初始化一些参数\n    this._rootWidth = $(this.root).width();\n    this._rootHeight = $(this.root).height();\n\n    // 网格布局\n    this._gridService = new GridService({\n      root: this.root,\n      canvas: this\n    });\n\n    // 辅助线\n    this._guidelineService = new GuidelineService({\n      root: this.root,\n      canvas: this\n    });\n\n    // 坐标转换服务\n    this._coordinateService = new CoordinateService({\n      canvas: this,\n      terOffsetX: $(this.root).offset().left,\n      terOffsetY: $(this.root).offset().top,\n      terWidth: $(this.root).width(),\n      terHeight: $(this.root).height(),\n      canOffsetX: this._moveData[0],\n      canOffsetY: this._moveData[1],\n      scale: this._zoomData\n    });\n\n    this._addEventListener();\n\n    this._unionData = {\n      __system: {\n        nodes: [],\n        edges: [],\n        groups: [],\n        endpoints: []\n      }\n    };\n\n    this._NodeClass = Node;\n\n    // undo & redo队列\n    this.actionQueue = [];\n    this.actionQueueIndex = -1;\n\n    // 画布边缘\n    this._autoMoveDir = [];\n    this._autoMoveTimer = null;\n  }\n\n  updateRootResize(opts = {}) {\n    this._coordinateService._changeCanvasInfo({\n      terOffsetX: opts.terOffsetX || $(this.root).offset().left,\n      terOffsetY: opts.terOffsetY || $(this.root).offset().top,\n      terWidth: opts.terWidth || $(this.root).width(),\n      terHeight: opts.terHeight || $(this.root).height()\n    });\n    this.canvasWrapper._changeCanvasInfo({\n      terScrollX: opts.terScrollX || 0,\n      terScrollY: opts.terScrollY || 0\n    });\n  }\n\n  draw(opts, callback) {\n    const groups = opts.groups || [];\n    const nodes = opts.nodes || [];\n    const edges = opts.edges || [];\n\n    // 自动布局需要重新review\n    if (this.layout) {\n      this._autoLayout({\n        groups,\n        nodes,\n        edges\n      });\n    }\n\n    // 首次加载，异步逐步加载\n    let groupPromise = new Promise((resolve, reject) => {\n      setTimeout(() => {\n        // 生成groups\n        this.addGroups(groups);\n        resolve();\n      });\n    });\n    let nodePromise = new Promise((resolve, reject) => {\n      setTimeout(() => {\n        // 生成nodes\n        this.addNodes(nodes);\n        resolve();\n      }, 10);\n    });\n    let edgePromise = new Promise((resolve, reject) => {\n      setTimeout(() => {\n        // 生成edges\n        this.addEdges(edges);\n        resolve();\n      }, 20);\n    });\n    Promise.all([groupPromise, nodePromise, edgePromise]).then(() => {\n      this.actionQueue = [];\n      this.actionQueueIndex = -1;\n      callback && callback({\n        nodes: this.nodes,\n        edges: this.edges,\n        groups: this.groups\n      });\n    });\n  }\n\n  redraw (opts, callback) {\n    this.removeNodes(this.nodes);\n    this.removeGroups(this.groups);\n    this.clearActionQueue();\n    this.draw(opts, callback);\n  }\n\n  getNode(id) {\n    return _.find(this.nodes, item => item.id === id);\n  }\n\n  getEdge(id) {\n    return _.find(this.edges, item => item.id === id);\n  }\n\n  getGroup(id) {\n    return _.find(this.groups, item => item.id === id);\n  }\n\n  addGroup(group, nodes, options, isNotEventEmit) {\n    const container = $(this.wrapper);\n    const GroupClass = group.Class || Group;\n    let _newNodes = [];\n    const _groupObj = new GroupClass(_.assign(_.cloneDeep(group), {\n      _global: this.global,\n      _emit: this.emit.bind(this),\n      _on: this.on.bind(this),\n      draggable: group.draggable !== undefined ? group.draggable : this.draggable\n    }));\n    if (this._isExistGroup(_groupObj)) {\n      // 后续用新的group代码旧的group\n      console.warn(`group:${_groupObj.id} has existed`);\n      return;\n    }\n    _groupObj.init();\n    container.prepend(_groupObj.dom);\n    this.groups.push(_groupObj);\n\n    _groupObj._createEndpoint();\n\n    _groupObj.mounted && _groupObj.mounted();\n\n    if (nodes && nodes.length > 0) {\n      // 过滤掉scope不匹配的节点 和 已存在其他组的node\n      nodes = nodes.filter((_node) => {\n        return ScopeCompare(_node.scope, _groupObj.scope, _.get(this, 'global.isScopeStrict')) && (_node.group === _groupObj.id || _node.group == undefined);\n      });\n\n      let _isAbsolutePos = _.get(options, 'posType', 'absolute') === 'absolute';\n      // 重新计算group的位置\n      let _groupLeft = Infinity;\n      let _groupTop = Infinity;\n      nodes.forEach((_node) => {\n        if (_isAbsolutePos) {\n          if (_node.left < _groupLeft) {\n            _groupLeft = _node.left;\n          }\n          if (_node.top < _groupTop) {\n            _groupTop = _node.top;\n          }\n        }\n      });\n      _groupObj._moveTo(_groupLeft - _.get(options, 'padding', 5), _groupTop - _.get(options, 'padding', 5));\n\n      // 添加节点\n      _newNodes = nodes.map((_node) => {\n        let newNode = null;\n        // 已存在节点\n        let _existNode = _.find(this.nodes, (__node) => {\n          return __node.id === _node.id;\n        });\n        if (_existNode) {\n          this.removeNode(_existNode.id, true, true);\n          _existNode._init({\n            dom: _existNode.dom,\n            top: _existNode.top - _groupObj.top,\n            left: _existNode.left - _groupObj.left,\n            group: _groupObj.id\n          })\n          newNode = this.addNode(_existNode, true);\n        } else {\n          let _nodeObj = null;\n          if (_node instanceof Node || _node.__type === 'node') {\n            _nodeObj = _node;\n          } else {\n            const _NodeClass = _node.Class || this._NodeClass;\n            _nodeObj = new _NodeClass(_.assign(_.cloneDeep(_node), {\n              _global: this.global,\n              _on: this.on.bind(this),\n              _emit: this.emit.bind(this),\n              _endpointLimitNum: this.theme.endpoint.limitNum,\n              draggable: _node.draggable !== undefined ? _node.draggable : this.draggable\n            }));\n          }\n          if (_isAbsolutePos) {\n            _nodeObj.top = _nodeObj.top - _groupObj.top;\n            _nodeObj.left = _nodeObj.left - _groupObj.left;\n          }\n          _nodeObj.group = _groupObj.id;\n          newNode = this.addNode(_nodeObj);\n        }\n        return newNode;\n      });\n\n      // 重新计算group的大小\n      let _groupWidth = -Infinity;\n      let _groupHeight = -Infinity;\n      _newNodes.forEach((_node) => {\n        let _w = $(_node.dom).width();\n        let _h = $(_node.dom).height();\n        if (_groupWidth < _node.left + _w) {\n          _groupWidth = _node.left + _w;\n        }\n        if (_groupHeight < _node.top + _h) {\n          _groupHeight = _node.top + _h;\n        }\n      });\n      _groupObj.setSize(_groupWidth + _.get(options, 'padding', 5) * 2, _groupHeight + _.get(options, 'padding', 5) * 2);\n    }\n\n    if (!isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:addGroups',\n        data: [{\n          group: _groupObj,\n          nodes: _newNodes\n        }]\n      });\n      this.emit('events', {\n        type: 'group:add',\n        group: _groupObj\n      });\n    }\n\n    return _groupObj;\n  }\n\n  addNodes(nodes, isNotEventEmit) {\n    const _canvasFragment = document.createDocumentFragment();\n    const container = $(this.wrapper);\n    const result = nodes.filter((node) => {\n      if (node.group) {\n        let _existGroup = this.getGroup(node.group);\n        if (!_existGroup) {\n          console.warn(`\bnodeId为${node.id}的节点找不到groupId为${node.group}的节点组，因此无法渲染`);\n          return false;\n        }\n      }\n      return true;\n    }).map((node) => {\n      let _nodeObj = null;\n      if (node instanceof Node || node.__type === 'node') {\n        _nodeObj = node;\n      } else {\n        const _NodeClass = node.Class || this._NodeClass;\n        _nodeObj = new _NodeClass(_.assign(_.cloneDeep(node), {\n          _global: this.global,\n          _on: this.on.bind(this),\n          _emit: this.emit.bind(this),\n          _endpointLimitNum: this.theme.endpoint.limitNum,\n          draggable: node.draggable !== undefined ? node.draggable : this.draggable\n        }));\n      }\n\n      if (this._isExistNode(_nodeObj)) {\n        // 后续用新的node代码旧的node\n        console.warn(`node:${_nodeObj.id} has existed`);\n        return;\n      }\n\n      // 节点初始化，假如已经存在过的节点就不需要重绘了\n      let initObj = {};\n      if (_nodeObj.dom) {\n        initObj['dom'] = _nodeObj.dom\n      }\n      _nodeObj._init(initObj);\n      // 一定要比group的addNode执行的之前，不然会重复把node加到this.nodes里面\n      this.nodes.push(_nodeObj);\n\n      // 假如节点存在group，即放进对应的节点组里\n      const existGroup = _nodeObj.group ? this.getGroup(_nodeObj.group) : null;\n      if (existGroup) {\n        if (ScopeCompare(_nodeObj.scope, existGroup.scope, _.get(this, 'global.isScopeStrict'))) {\n          existGroup._appendNodes([_nodeObj]);\n        } else {\n          console.warn(`nodeId为${_nodeObj.id}的节点和groupId${existGroup.id}的节点组scope值不符，无法加入`);\n        }\n      } else {\n        _canvasFragment.appendChild(_nodeObj.dom);\n      }\n      return _nodeObj;\n    }).filter((item) => {\n      return !!item;\n    });\n\n    // 批量插入dom，性能优化\n    container.append(_canvasFragment);\n\n    result.forEach((item) => {\n      // 渲染endpoint\n      item._createEndpoint(isNotEventEmit);\n\n      // 节点挂载\n      !isNotEventEmit && item.mounted && item.mounted();\n    });\n\n    if (result && result.length > 0 && !isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:addNodes',\n        data: result\n      });\n      this.emit('system.nodes.add', {\n        nodes: result\n      });\n      this.emit('events', {\n        type: 'nodes:add',\n        nodes: result\n      });\n    }\n    return result;\n  }\n\n  addNode(node, isNotEventEmit) {\n    return this.addNodes([node], isNotEventEmit)[0];\n  }\n\n  addEdges(links, isNotEventEmit) {\n    $(this.svg).css('visibility', 'hidden');\n\n    const _edgeFragment = document.createDocumentFragment();\n    const _labelFragment = document.createDocumentFragment();\n    const result = links.map((link) => {\n\n      // link已经存在\n      if (link instanceof Edge) {\n        link._init();\n\n        _edgeFragment.appendChild(link.dom);\n\n        if (link.labelDom) {\n          _labelFragment.appendChild(link.labelDom);\n        }\n\n        if (link.arrowDom) {\n          _edgeFragment.appendChild(link.arrowDom);\n        }\n\n        this.edges.push(link);\n\n        link.mounted && link.mounted();\n        return link;\n      }\n\n      // link不存在的话\n      const EdgeClass = link.Class || this.theme.edge.Class;\n      if (link.type === 'endpoint') {\n        let sourceNode = null;\n        let targetNode = null;\n        let _sourceType = link._sourceType;\n        let _targetType = link._targetType;\n\n        if (link.sourceNode instanceof Node || link.sourceNode.__type === 'node') {\n          _sourceType = 'node';\n          sourceNode = link.sourceNode;\n        } else if (link.sourceNode instanceof Group || link.sourceNode.__type === 'group') {\n          _sourceType = 'group';\n          sourceNode = link.sourceNode;\n        } else {\n          if (link._sourceType) {\n            sourceNode = _sourceType === 'node' ? this.getNode(link.sourceNode) : this.getGroup(link.sourceNode);\n          } else {\n            let _node = this.getNode(link.sourceNode);\n            if (_node) {\n              _sourceType = 'node';\n              sourceNode = _node;\n            } else {\n              _sourceType = 'group';\n              sourceNode = this.getGroup(link.sourceNode);\n            }\n          }\n        }\n\n        if (link.targetNode instanceof Node || link.targetNode.__type === 'node') {\n          _targetType = 'node';\n          targetNode = link.targetNode;\n        } else if (link.targetNode instanceof Group || link.targetNode.__type === 'group') {\n          _targetType = 'group';\n          targetNode = link.targetNode;\n        } else {\n          if (link._targetType) {\n            targetNode = _targetType === 'node' ? this.getNode(link.targetNode) : this.getGroup(link.targetNode);\n          } else {\n            let _node = this.getNode(link.targetNode);\n            if (_node) {\n              _targetType = 'node';\n              targetNode = _node;\n            } else {\n              _targetType = 'group';\n              targetNode = this.getGroup(link.targetNode);\n            }\n          }\n        }\n\n        if (!sourceNode || !targetNode) {\n          console.warn(`butterflies error: can not connect edge. link sourceNodeId:${link.sourceNode};link targetNodeId:${link.targetNode}`);\n          return;\n        }\n\n        let sourceEndpoint = null;\n        let targetEndpoint = null;\n\n        if (link.sourceEndpoint && (link.sourceEndpoint instanceof Endpoint || link.sourceEndpoint.__type === 'endpoint')) {\n          sourceEndpoint = link.sourceEndpoint;\n        } else {\n          sourceEndpoint = sourceNode.getEndpoint(link.source, 'source');\n        }\n\n        if (link.targetEndpoint && (link.targetEndpoint instanceof Endpoint || link.targetEndpoint.__type === 'endpoint')) {\n          targetEndpoint = link.targetEndpoint;\n        } else {\n          targetEndpoint = targetNode.getEndpoint(link.target, 'target');\n        }\n\n        if (!sourceEndpoint || !targetEndpoint) {\n          console.warn(`butterflies error: can not connect edge. link sourceId:${link.source};link targetId:${link.target}`);\n          return;\n        }\n\n        // 线条去重\n        if (!this.theme.edge.isRepeat) {\n          let _isRepeat = _.some(this.edges, (_edge) => {\n            let _result = false;\n            if (sourceNode) {\n              _result = sourceNode.id === _edge.sourceNode.id && sourceEndpoint.id === _edge.sourceEndpoint.id && _sourceType === _edge.sourceEndpoint.nodeType;\n            }\n\n            if (targetNode) {\n              _result = _result && (targetNode.id === _edge.targetNode.id && targetEndpoint === _edge.targetEndpoint.id && _targetType === _edge.targetEndpoint.nodeType);\n            }\n\n            return _result;\n          });\n          if (_isRepeat) {\n            console.warn(`id为${sourceEndpoint.id}-${targetEndpoint.id}的线条连接重复，请检查`);\n            return;\n          }\n        }\n\n        let edge = new EdgeClass({\n          type: 'endpoint',\n          id: link.id,\n          label: link.label,\n          shapeType: link.shapeType || this.theme.edge.type,\n          orientationLimit: this.theme.endpoint.position,\n          isExpandWidth: this.theme.edge.isExpandWidth,\n          defaultAnimate: this.theme.edge.defaultAnimate,\n          sourceNode,\n          targetNode,\n          sourceEndpoint,\n          targetEndpoint,\n          arrow: link.arrow === undefined ? _.get(this, 'theme.edge.arrow') : link.arrow,\n          arrowPosition: link.arrowPosition === undefined ? _.get(this, 'theme.edge.arrowPosition') : link.arrowPosition,\n          arrowOffset: link.arrowOffset === undefined ? _.get(this, 'theme.edge.arrowOffset') : link.arrowOffset,\n          options: link,\n          _sourceType,\n          _targetType,\n          _global: this.global,\n          _on: this.on.bind(this),\n          _emit: this.emit.bind(this),\n        });\n\n        edge._init();\n\n        _edgeFragment.appendChild(edge.dom);\n\n        if (edge.labelDom) {\n          _labelFragment.appendChild(edge.labelDom);\n        }\n\n        if (edge.arrowDom) {\n          _edgeFragment.appendChild(edge.arrowDom);\n        }\n\n        this.edges.push(edge);\n\n        edge.mounted && edge.mounted();\n\n        // 假如sourceEndpoint和targetEndpoint没属性，则自动添加上\n        if (sourceEndpoint.type === undefined) {\n          sourceEndpoint._tmpType = 'source';\n        }\n        if (targetEndpoint.type === undefined) {\n          targetEndpoint._tmpType = 'target';\n        }\n\n        return edge;\n      } else {\n        const sourceNode = this.getNode(link.source);\n        const targetNode = this.getNode(link.target);\n\n        if (!sourceNode || !targetNode) {\n          console.warn(`butterflies error: can not connect edge. link sourceId:${link.source};link targetId:${link.target}`);\n          return;\n        }\n\n        let edge = new EdgeClass({\n          type: 'node',\n          id: link.id,\n          label: link.label,\n          sourceNode,\n          targetNode,\n          shapeType: link.shapeType || this.theme.edge.type,\n          orientationLimit: this.theme.endpoint.position,\n          arrow: link.arrow === undefined ? _.get(this, 'theme.edge.arrow') : link.arrow,\n          arrowPosition: link.arrowPosition === undefined ? _.get(this, 'theme.edge.arrowPosition') : link.arrowPosition,\n          arrowOffset: link.arrowOffset === undefined ? _.get(this, 'theme.edge.arrowOffset') : link.arrowOffset,\n          isExpandWidth: this.theme.edge.isExpandWidth,\n          defaultAnimate: this.theme.edge.defaultAnimate,\n          _global: this.global,\n          _on: this.on.bind(this),\n          _emit: this.emit.bind(this),\n        });\n\n        edge._init();\n\n        _edgeFragment.appendChild(edge.dom);\n\n        if (edge.labelDom) {\n          _labelFragment.appendChild(edge.labelDom);\n        }\n\n        if (edge.arrowDom) {\n          _edgeFragment.appendChild(edge.arrowDom);\n        }\n\n        this.edges.push(edge);\n\n        edge.mounted && edge.mounted();\n\n        return edge;\n      }\n    }).filter(item => item);\n\n    $(this.svg).append(_edgeFragment);\n\n    $(this.wrapper).append(_labelFragment);\n\n    result.forEach((link) => {\n      let _soucePoint = {};\n      let _targetPoint = {};\n      if (link.type === 'endpoint') {\n        _soucePoint = {\n          pos: [link.sourceEndpoint._posLeft + link.sourceEndpoint._width / 2, link.sourceEndpoint._posTop + link.sourceEndpoint._height / 2],\n          orientation: link.sourceEndpoint.orientation ? link.sourceEndpoint.orientation : undefined\n        };\n        _targetPoint = {\n          pos: [link.targetEndpoint._posLeft + link.targetEndpoint._width / 2, link.targetEndpoint._posTop + link.targetEndpoint._height / 2],\n          orientation: link.targetEndpoint.orientation ? link.targetEndpoint.orientation : undefined\n        };\n      } else if (link.type === 'node') {\n        _soucePoint = {\n          pos: [link.sourceNode.left + link.sourceNode.getWidth() / 2, link.sourceNode.top + link.sourceNode.getHeight() / 2]\n        };\n\n        _targetPoint = {\n          pos: [link.targetNode.left + link.targetNode.getWidth() / 2, link.targetNode.top + link.targetNode.getHeight() / 2]\n        };\n      }\n      link.redraw(_soucePoint, _targetPoint);\n    });\n\n    if (!isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:addEdges',\n        data: result\n      });\n      this.emit('system.link.connect', {\n        links: result\n      });\n      this.emit('events', {\n        type: 'link:connect',\n        links: result\n      });\n    }\n\n    $(this.svg).css('visibility', 'visible');\n\n    return result;\n  }\n\n  addEdge(link, isNotEventEmit) {\n    return this.addEdges([link], isNotEventEmit)[0];\n  }\n\n  addGroups(datas) {\n    return datas.map(item => this.addGroup(item)).filter(item => item);\n  }\n\n  removeNode(nodeId, isNotDelEdge, isNotEventEmit) {\n    return this.removeNodes([nodeId], isNotDelEdge, isNotEventEmit);\n  }\n\n  removeNodes(nodes, isNotDelEdge, isNotEventEmit) {\n\n    let nodeIds = [];\n    nodeIds = nodes.map((item) => {\n      if (item instanceof Node) {\n        return item.id\n      } else {\n        return item;\n      }\n    });\n\n\n    let rmNodes = [];\n    let rmEdges = [];\n    nodeIds.forEach((nodeId) => {\n      const index = _.findIndex(this.nodes, _node => _node.id === nodeId);\n      if (index === -1) {\n        console.warn(`找不到id为：${nodeId}的节点`);\n        return;\n      }\n\n      // 删除邻近的线条\n      const neighborEdges = this.getNeighborEdges(nodeId);\n      if (!isNotDelEdge) {\n        this.removeEdges(neighborEdges, true, true);\n      }\n\n      // 删除节点\n      const node = this.nodes[index];\n      node.destroy(isNotEventEmit);\n\n      const _rmNodes = this.nodes.splice(index, 1);\n      // 假如在group里面\n      if (node.group) {\n        const group = this.getGroup(node.group);\n        if (group) {\n          group.nodes = group.nodes.filter(item => item.id !== node.id);\n        }\n      }\n\n      if (_rmNodes.length > 0) {\n        rmNodes = rmNodes.concat(_rmNodes);\n        rmEdges = rmEdges.concat(neighborEdges);\n      }\n\n    });\n\n    if (rmNodes.length > 0) {\n      if (!isNotEventEmit) {\n        this.pushActionQueue({\n          type: 'system:removeNodes',\n          data: {\n            nodes: rmNodes,\n            edges: rmEdges\n          }\n        });\n        this.emit('system.nodes.delete', {\n          nodes: rmNodes,\n          edges: rmEdges\n        });\n        this.emit('events', {\n          type: 'nodes:delete',\n          nodes: rmNodes,\n          edges: rmEdges\n        });\n      }\n    }\n\n    return {\n      nodes: rmNodes,\n      edges: rmEdges\n    };\n  }\n\n  removeEdges(edges, isNotEventEmit, isNotPushActionQueue) {\n    let result = [];\n    edges.forEach((_edge) => {\n      let edgeIndex = -1;\n      if (_edge instanceof Edge || _edge.__type === 'edge') {\n        edgeIndex = _.findIndex(this.edges, (item) => {\n          if (item.type === 'node') {\n            return _edge.sourceNode.id === item.sourceNode.id && _edge.targetNode.id === item.targetNode.id;\n          } else {\n            return (\n              _.get(_edge, 'sourceNode.id') === _.get(item, 'sourceNode.id') &&\n              _.get(_edge, 'sourceEndpoint.id') === _.get(item, 'sourceEndpoint.id') &&\n              _.get(_edge, 'sourceEndpoint.nodeType') === _.get(item, 'sourceEndpoint.nodeType')\n            ) && (\n                _.get(_edge, 'targetNode.id') === _.get(item, 'targetNode.id') &&\n                _.get(_edge, 'targetEndpoint.id') === _.get(item, 'targetEndpoint.id') &&\n                _.get(_edge, 'targetEndpoint.nodeType') === _.get(item, 'targetEndpoint.nodeType')\n              );\n          }\n        });\n      } else if (_.isString(_edge)) {\n        edgeIndex = _.findIndex(this.edges, (item) => {\n          return _edge === item.id;\n        });\n      } else {\n        console.warn(`删除线条错误，传入参数有误，请检查`);\n        return;\n      }\n      if (edgeIndex !== -1) {\n        result = result.concat(this.edges.splice(edgeIndex, 1));\n      } else {\n        console.warn(`删除线条错误，不存在值为${_edge.id}的线`);\n      }\n    });\n\n    if (!isNotPushActionQueue) {\n      this.pushActionQueue({\n        type: 'system:removeEdges',\n        data: result\n      });\n    }\n\n    if (!isNotEventEmit) {\n      this.emit('system.links.delete', {\n        links: result\n      });\n      this.emit('events', {\n        type: 'links:delete',\n        links: result\n      });\n    }\n\n\n    result.forEach((item) => {\n      item.destroy(isNotEventEmit);\n    });\n\n    // 把endpoint重新赋值\n    result.forEach((_rmEdge) => {\n      if (_.get(_rmEdge, 'sourceEndpoint._tmpType') === 'source') {\n        let isExistEdge = _.some(this.edges, (edge) => {\n          return _rmEdge.sourceNode.id === edge.sourceNode.id && _rmEdge.sourceEndpoint.id === edge.sourceEndpoint.id;\n        });\n        !isExistEdge && (_rmEdge.sourceEndpoint._tmpType = undefined);\n      }\n      if (_.get(_rmEdge, 'targetEndpoint._tmpType') === 'target') {\n        let isExistEdge = _.some(this.edges, (edge) => {\n          return _rmEdge.targetNode.id === edge.targetNode.id && _rmEdge.targetEndpoint.id === edge.targetEndpoint.id;\n        });\n        !isExistEdge && (_rmEdge.targetEndpoint._tmpType = undefined);\n      }\n    });\n    return result;\n  }\n\n  removeEdge(edge, isNotEventEmit, isNotPushActionQueue) {\n    return this.removeEdges([edge], isNotEventEmit, isNotPushActionQueue)[0];\n  }\n\n  removeGroup(data, isNotEventEmit) {\n    let groupId = undefined;\n    if (data instanceof Group) {\n      groupId = data.id;\n    } else {\n      groupId = data;\n    }\n\n    const group = this.getGroup(groupId);\n    if (!group) {\n      console.warn(`未找到id为${groupId}的节点组`);\n    }\n    group._isDeleting = true;\n    let insideNodes = group.nodes.map((_node) => {\n      let rmItem = this.removeNode(_node.id, true, true);\n      let rmNode = rmItem.nodes[0];\n      let neighborEdges = rmItem.edges;\n      rmNode._init({\n        top: _node.top + group.top,\n        left: _node.left + group.left,\n        dom: _node.dom,\n        _isDeleteGroup: true\n      });\n      this.addNode(rmNode, true);\n      neighborEdges.forEach((item) => {\n        item.redraw();\n      });\n      return rmNode;\n    });\n    // 删除邻近的线条\n    const neighborEdges = this.getNeighborEdges(group.id, 'group');\n    this.removeEdges(neighborEdges, isNotEventEmit);\n    // 删除group\n    const index = _.findIndex(this.groups, _group => _group.id === groupId);\n    this.groups.splice(index, 1)[0];\n    group.destroy(isNotEventEmit);\n\n    if (isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:removeGroup',\n        data: {\n          group: group,\n          nodes: insideNodes\n        }\n      });\n    }\n    return group;\n  }\n\n  removeGroups(groups, isNotEventEmit) {\n    let groupIds = [];\n    groupIds = groups.map((item) => {\n      if (item instanceof Group) {\n        return item.id\n      } else {\n        return item;\n      }\n    });\n\n    let rmGroups = groupIds.map((item) => {\n      return this.removeGroup(item, isNotEventEmit);\n    });\n\n    return {\n      groups: rmGroups\n    }\n  }\n\n  getNeighborEdges(id, type) {\n\n    let node = undefined;\n    let group = undefined;\n    if (type === 'node') {\n      node = _.find(this.nodes, item => id === item.id);\n    } else if (type === 'group') {\n      group = _.find(this.groups, item => id === item.id);\n    } else {\n      node = _.find(this.nodes, item => id === item.id);\n      node && !type && (type = 'node');\n      group = _.find(this.groups, item => id === item.id);\n      group && !type && (type = 'group');\n    }\n\n    return this.edges.filter((item) => {\n      if (type === 'node') {\n        return _.get(item, 'sourceNode.id') === node.id || _.get(item, 'targetNode.id') === node.id;\n      } else {\n        return _.get(item, 'sourceNode.id') === group.id || _.get(item, 'targetNode.id') === group.id;\n      }\n    });\n  }\n\n  getNeighborNodes(nodeId) {\n    const result = [];\n    const node = _.find(this.nodes, item => nodeId === item.id);\n    if (!node) {\n      console.warn(`找不到id为${nodeId}的节点`);\n    }\n    this.edges.forEach((item) => {\n      if (item.sourceNode && item.sourceNode.id === nodeId) {\n        result.push(item.targetNode.id);\n      } else if (item.targetNode && item.targetNode.id === nodeId) {\n        result.push(item.sourceNode.id);\n      }\n    });\n\n    return result.map(id => this.getNode(id));\n  }\n\n  /**\n   * 查找 N 层节点\n   * \n   * @param {Object} options \n   * @param {Node} options.node\n   * @param {Endpoint} options.endpoint\n   * @param {String} options.type\n   * @param {Number} options.level\n   * @param {Function} options.iteratee\n   * @returns {Object} filteredGraph\n   */\n  getNeighborNodesAndEdgesByLevel({node, endpoint, type = 'out', level = Infinity, iteratee = () => true}) {\n    // 先求source-target level 层\n    if (!node || !this.nodes.length) return {nodes: [], edges: []};\n    if (level == 0 || !this.edges.length) return {nodes: [node], edges: []};\n    let quene = [];\n    let neighbors = [];\n    const visited = new Set();\n\n    // 1. 生成邻接表\n    // adjTable = {[nodeId]: {[endpointId]: [[targetNode, targetEndpoint]]}}\n    const adjTable = this.getAdjcentTable(type);\n\n    if (endpoint) {\n      quene = _.get(adjTable, [node.id, endpoint.id], []).map(d => [...d, 1]);\n    } else {\n      quene = (Object.values(_.get(adjTable, node.id, {})) || []).flatMap(d => d.map(n => n.concat(1)));\n    }\n\n    visited.add(node.id);\n\n    if (!quene.length) return {nodes: [node], edges: []};\n    // 2. BFS,得到 nodes 集合\n    while (quene.length) {\n      const [$node, $endpoint, $level] = quene.shift();\n      if (\n        visited.has($node.id) ||\n        $level > level ||\n        !iteratee($node, $endpoint, $level)\n      ) continue;\n\n      // TODO: 锚点向后传递？节点向后传递？\n      neighbors = (Object.values(_.get(adjTable, $node.id, {})) || []).forEach((neighborsWithEndpoint) => {\n        neighborsWithEndpoint.forEach(neighbor => {\n          const [$nNode, $nEndpoint] = neighbor;\n          if (visited.has($nNode.id)) return;\n          quene.push([...neighbor, $level + 1]);\n        });\n      });\n      visited.add($node.id);\n    }\n    const nodes = new Set();\n    const edges = new Set();\n    // 4. 获取 edges，1. 只考虑点集 2. 考虑边\n    // 目前只考虑点集内的全部边\n    this.edges.forEach(edge => {\n      const {sourceNode, sourceEndpoint, targetNode, targetEndpoint} = edge;\n      if (visited.has(sourceNode.id) && visited.has(targetNode.id)) {\n        nodes.add(sourceNode);\n        nodes.add(targetNode);\n        edges.add(edge);\n      }\n    });\n\n    return {\n      nodes: [...nodes],\n      edges: [...edges]\n    }\n  }\n\n  getAdjcentTable(type) {\n    // 包含正逆的邻接表\n    // {[nodeId]: {[endpointId]: [[targetNode, targetEndpoint]]}}\n    const adjTable = {};\n    this.edges.forEach(edge => {\n      const {sourceNode, sourceEndpoint, targetNode, targetEndpoint} = edge;\n      const sourceNodeId = sourceNode.id;\n      const sourceEndpointId = sourceEndpoint.id;\n      const targetNodeId = targetNode.id;\n      const targetEndpointId = targetEndpoint.id;\n      // in and all\n      if (type !== 'out') {\n        if (!adjTable[targetNodeId]) adjTable[targetNodeId] = {};\n        if (!adjTable[targetNodeId][targetEndpointId]) adjTable[targetNodeId][targetEndpointId] = [];\n\n        adjTable[targetNodeId][targetEndpointId].push([sourceNode, sourceEndpoint]);\n      }\n      // out and all\n      if (type !== 'in') {\n        if (!adjTable[sourceNodeId]) adjTable[sourceNodeId] = {};\n        if (!adjTable[sourceNodeId][sourceEndpointId]) adjTable[sourceNodeId][sourceEndpointId] = [];\n\n        adjTable[sourceNodeId][sourceEndpointId].push([targetNode, targetEndpoint]);\n      }\n\n    });\n    this.nodes.forEach(node => {\n      if (!adjTable[node.id]) adjTable[node.id] = {};\n    });\n    return adjTable;\n  }\n\n  setZoomable(flat, zoomDirection = this._zoomDirection) {\n    if (zoomDirection !== undefined) {\n      this._zoomDirection = zoomDirection;\n    }\n    if (!this._zoomCb) {\n      this._zoomCb = (event) => {\n        event.preventDefault();\n        const deltaY = event.deltaY;\n        if (this._zoomDirection) {\n          this._zoomData -= deltaY * this.theme.zoomGap;\n        } else {\n          this._zoomData += deltaY * this.theme.zoomGap;\n        }\n\n        if (this._zoomData < 0.25) {\n          this._zoomData = 0.25;\n          return;\n        } if (this._zoomData > 5) {\n          this._zoomData = 5;\n          return;\n        }\n\n        const platform = ['webkit', 'moz', 'ms', 'o'];\n        const scale = `scale(${this._zoomData})`;\n        for (let i = 0; i < platform.length; i++) {\n          this.wrapper.style[`${platform[i]}Transform`] = scale;\n        }\n        this.wrapper.style.transform = scale;\n        this._coordinateService._changeCanvasInfo({\n          wrapper: this.wrapper,\n          girdWrapper: this._guidelineService.dom,\n          mouseX: event.clientX,\n          mouseY: event.clientY,\n          scale: this._zoomData\n        });\n        this._guidelineService.zoom(this._zoomData);\n        this.emit('system.canvas.zoom', {\n          zoom: this._zoomData\n        });\n        this.emit('events', {\n          type: 'canvas.zoom',\n          zoom: this._zoomData\n        });\n      };\n    }\n\n    if (flat) {\n      // 双指Mac下缩放正常，Window鼠标滑轮方向相反\n      this.root.addEventListener('wheel', this._zoomCb);\n    } else {\n      this.root.removeEventListener('wheel', this._zoomCb);\n    }\n  }\n\n  setMoveable(flat) {\n    if (flat) {\n      this.moveable = true;\n      if (this._dragType === 'canvas:drag') {\n        this.moveable = false;\n      }\n    } else {\n      this.moveable = false;\n    }\n  }\n\n  setLinkable(flat) {\n    this.linkable = !!flat;\n  }\n\n  setDisLinkable(flat) {\n    this.disLinkable = !!flat;\n  }\n\n  setDraggable(flat) {\n    this.nodes.forEach((node) => {\n      node.setDraggable(flat);\n    });\n    this.draggable = flat;\n  }\n\n  focusNodesWithAnimate(param, type = ['node'], options, callback) {\n    // 画布里的可视区域\n    let canLeft = Infinity;\n    let canRight = -Infinity;\n    let canTop = Infinity;\n    let canBottom = -Infinity;\n\n    if (_.includes(type, 'node')) {\n      let nodeIds = param.nodes;\n      this.nodes.filter((_node) => {\n        return _.find(nodeIds, (id) => {\n          return _node.id === id;\n        }) !== undefined;\n      }).forEach((_node) => {\n        let _nodeLeft = _node.left;\n        let _nodeRight = _node.left + _node.getWidth();\n        let _nodeTop = _node.top;\n        let _nodeBottom = _node.top + _node.getHeight();\n        if (_node.group) {\n          let group = this.getGroup(_node.group);\n          if (group) {\n            _nodeLeft += group.left;\n            _nodeRight += group.left;\n            _nodeTop += group.top;\n            _nodeBottom += group.top;\n          }\n        }\n        if (_nodeLeft < canLeft) {\n          canLeft = _nodeLeft;\n        }\n        if (_nodeRight > canRight) {\n          canRight = _nodeRight;\n        }\n        if (_nodeTop < canTop) {\n          canTop = _nodeTop;\n        }\n        if (_nodeBottom > canBottom) {\n          canBottom = _nodeBottom;\n        }\n      });\n    }\n\n    if (_.includes(type, 'group')) {\n      let groupIds = param.groups;\n      this.groups.filter((_group) => {\n        return _.find(groupIds, (id) => {\n          return id === _group.id;\n        });\n      }).forEach((_group) => {\n        let _groupLeft = _group.left;\n        let _groupRight = _group.left + _group.getWidth();\n        let _groupTop = _group.top;\n        let _groupBottom = _group.top + _group.getHeight();\n        if (_groupLeft < canLeft) {\n          canLeft = _groupLeft;\n        }\n        if (_groupRight > canRight) {\n          canRight = _groupRight;\n        }\n        if (_groupTop < canTop) {\n          canTop = _groupTop;\n        }\n        if (_groupBottom > canBottom) {\n          canBottom = _groupBottom;\n        }\n      });\n    }\n    let customOffset = _.get(options, 'offset') || [0, 0];\n    let canDisX = canRight - canLeft;\n    let terDisX = this._rootWidth - customOffset[0];\n    let canDisY = canBottom - canTop;\n    let terDisY = this._rootHeight - customOffset[1];\n    let scaleX = terDisX / canDisX;\n    let scaleY = terDisY / canDisY;\n\n    // 这里要根据scale来判断\n    let scale = scaleX < scaleY ? scaleX : scaleY;\n    scale = 1 < scale ? 1 : scale;\n\n    let terLeft = this._coordinateService._canvas2terminal('x', canLeft, {\n      scale: scale,\n      canOffsetX: 0,\n      canOffsetY: 0,\n      terOffsetX: 0,\n      terOffsetY: 0,\n      originX: 50,\n      originY: 50\n    });\n    let terRight = this._coordinateService._canvas2terminal('x', canRight, {\n      scale: scale,\n      canOffsetX: 0,\n      canOffsetY: 0,\n      terOffsetX: 0,\n      terOffsetY: 0,\n      originX: 50,\n      originY: 50\n    });\n    let terTop = this._coordinateService._canvas2terminal('y', canTop, {\n      scale: scale,\n      canOffsetX: 0,\n      canOffsetY: 0,\n      terOffsetX: 0,\n      terOffsetY: 0,\n      originX: 50,\n      originY: 50\n    });\n    let terBottom = this._coordinateService._canvas2terminal('y', canBottom, {\n      scale: scale,\n      canOffsetX: 0,\n      canOffsetY: 0,\n      terOffsetX: 0,\n      terOffsetY: 0,\n      originX: 50,\n      originY: 50\n    });\n\n    let offsetX = (terLeft + terRight - this._rootWidth) / 2;\n    let offsetY = (terTop + terBottom - this._rootHeight) / 2;\n\n    offsetX = -offsetX + customOffset[0];\n    offsetY = -offsetY + customOffset[1];\n\n    const time = 500;\n    $(this.wrapper).animate({\n      top: offsetY,\n      left: offsetX,\n    }, time);\n    this._moveData = [offsetX, offsetY];\n\n    this._coordinateService._changeCanvasInfo({\n      canOffsetX: offsetX,\n      canOffsetY: offsetY,\n      scale: scale,\n      originX: 50,\n      originY: 50\n    });\n\n    this.zoom(scale, callback);\n  }\n  focusCenterWithAnimate(options, callback) {\n    let nodeIds = this.nodes.map((item) => {\n      return item.id;\n    });\n    let groupIds = this.groups.map((item) => {\n      return item.id;\n    });\n\n    this.focusNodesWithAnimate({\n      nodes: nodeIds,\n      groups: groupIds\n    }, ['node', 'group'], options, callback);\n  }\n  focusNodeWithAnimate(param, type = 'node', options, callback) {\n    let node = null;\n\n    if (_.isFunction(param)) { // 假如传入的是filter，则按照用户自定义的规则来寻找\n      node = type === 'node' ? _.find(this.nodes, param) : _.find(this.groups, param);\n    } else { // 假如传入的是id，则按照默认规则寻找\n      node = type === 'node' ? _.find(this.nodes, item => item.id === param) : _.find(this.groups, item => item.id === param);\n    }\n\n    let top = 0;\n    let left = 0;\n    if (!node) {\n      return;\n    }\n    top = node.top || node.y;\n    left = node.left || node.x;\n    if (node.height) {\n      top += node.height / 2;\n    }\n    if (node.width) {\n      left += node.width / 2;\n    }\n\n    if (node.group) {\n      const group = _.find(this.groups, _group => _group.id === node.group);\n      if (!group) return;\n      top += group.top || group.y;\n      left += group.left || group.x;\n      if (group.height) {\n        top += group.height / 2;\n      }\n      if (group.width) {\n        left += group.width / 2;\n      }\n    }\n\n    let customOffset = _.get(options, 'offset') || [0, 0];\n\n    const containerW = this._rootWidth;\n    const containerH = this._rootHeight;\n\n    const targetY = containerH / 2 - top + customOffset[1];\n    const targetX = containerW / 2 - left + customOffset[0];\n\n    const time = 500;\n\n    // animate不支持scale，使用setInterval自己实现\n    $(this.wrapper).animate({\n      top: targetY,\n      left: targetX,\n    }, time);\n    this._moveData = [targetX, targetY];\n\n    this._coordinateService._changeCanvasInfo({\n      canOffsetX: targetX,\n      canOffsetY: targetY,\n      originX: 50,\n      originY: 50,\n      scale: 1\n    });\n\n    this.zoom(1, callback);\n\n    this._guidelineService.isActive && this._guidelineService.clearCanvas();\n  }\n\n  zoom(param, callback) {\n    if (param < 0.25) {\n      param = 0.25;\n    } if (param > 5) {\n      param = 5;\n    }\n    const time = 50;\n    let frame = 1;\n    const gap = param - this._zoomData;\n    const interval = gap / 20;\n    clearInterval(this._zoomTimer);\n    this._zoomTimer = null;\n    if (gap !== 0) {\n      this._zoomTimer = setInterval(() => {\n        this._zoomData += interval;\n        let _canvasInfo = {\n          scale: this._zoomData\n        };\n        if (this._coordinateService.originX === undefined || this._coordinateService.originY === undefined) {\n          _canvasInfo['originX'] = 50;\n          _canvasInfo['originY'] = 50;\n        }\n        this._coordinateService._changeCanvasInfo(_canvasInfo);\n        this._guidelineService.zoom(this._zoomData);\n        $(this.wrapper).css({\n          transform: `scale(${this._zoomData})`\n        });\n        if (frame === 20) {\n          clearInterval(this._zoomTimer);\n          this.emit('system.canvas.zoom', {\n            zoom: this._zoomData\n          });\n          this.emit('events', {\n            type: 'canvas.zoom',\n            zoom: this._zoomData\n          });\n          callback && callback();\n        }\n        frame++;\n      }, time / 20);\n    } else {\n      callback && callback();\n    }\n  }\n\n  setOrigin(data) {\n    let originX = (data[0] || '0').toString().replace('%', '');\n    let originY = (data[1] || '0').toString().replace('%', '');\n    this._coordinateService._changeCanvasInfo({\n      originX: parseFloat(originX),\n      originY: parseFloat(originY)\n    });\n  }\n\n  move(position) {\n    $(this.wrapper)\n      .css('left', position[0])\n      .css('top', position[1]);\n    this._coordinateService._changeCanvasInfo({\n      canOffsetX: position[0],\n      canOffsetY: position[1]\n    });\n    this._guidelineService.isActive && this._guidelineService.move(position[0], position[1]);\n    this._moveData = position;\n    this.emit('system.canvas.move');\n    this.emit('events', {type: 'system.canvas.move'});\n  }\n\n  getZoom() {\n    return this._zoomData;\n  }\n\n  getOffset() {\n    return this._moveData;\n  }\n\n  getOrigin() {\n    return [this._coordinateService.originX + '%', this._coordinateService.originY + '%']\n  }\n\n  getDataMap() {\n    return {\n      nodes: this.nodes,\n      edges: this.edges,\n      groups: this.groups\n    };\n  }\n\n  setSelectMode(flat = true, contents = ['node'], selecMode = 'include') {\n    if (flat) {\n      this.isSelectMode = true;\n      this._rmSystemUnion();\n      this.selecContents = contents;\n      this.selecMode = selecMode;\n      this.canvasWrapper.active();\n      this._remarkMove = this.moveable;\n      this._remarkZoom = this.zoomable;\n      this.setZoomable(false);\n      this.setMoveable(false);\n    } else {\n      this.isSelectMode = false;\n      this.canvasWrapper.unActive();\n      if (this._remarkMove) {\n        this.setMoveable(true);\n      }\n      if (this._remarkZoom) {\n        this.setZoomable(true);\n      }\n    }\n  }\n\n  setGirdMode(flat = true, options) {\n    if (flat) {\n      this._gridService.create(options);\n    } else {\n      this._gridService.destroy();\n    }\n  }\n\n  setGuideLine(flat = true, options) {\n    if (flat) {\n      this._guidelineService.create(options);\n    } else {\n      this._guidelineService.destroy();\n    }\n  }\n\n  setMinimap(flat = true, options = {}) {\n    if (!options.events) {\n      options.events = [];\n    }\n\n    const updateEvts = [\n      'system.canvas.zoom',\n      'system.node.delete',\n      'system.node.move',\n      'system.nodes.add',\n      'system.group.delete',\n      'system.group.move',\n      'system.drag.move',\n      'system.canvas.move',\n      ...options.events\n    ];\n\n    const getNodes = () => {\n      return this.nodes.map(node => {\n        return {\n          id: node.id,\n          left: node.left,\n          top: node.top,\n          width: node.getWidth(),\n          height: node.getHeight(),\n          group: node.group,\n          minimapActive: _.get(node, 'options.minimapActive')\n        }\n      });\n    }\n\n    const getGroups = () => {\n      return this.groups.map(group => {\n        return {\n          id: group.id,\n          left: group.left,\n          top: group.top,\n          width: group.getWidth(),\n          height: group.getHeight(),\n          minimapActive: _.get(group, 'options.minimapActive')\n        }\n      });\n    }\n\n    if (flat && !this.minimap) {\n      this.minimap = new Minimap({\n        root: this.root,\n        move: this.move.bind(this),\n        terminal2canvas: this.terminal2canvas.bind(this),\n        canvas2terminal: this.canvas2terminal.bind(this),\n        nodes: getNodes(),\n        groups: getGroups(),\n        zoom: this.getZoom(),\n        offset: this.getOffset(),\n        ...options\n      });\n\n      this.updateFn = () => {\n        this.minimap.update({\n          nodes: getNodes(),\n          groups: getGroups(),\n          zoom: this.getZoom(),\n          offset: this.getOffset()\n        });\n      };\n\n      for (let ev of updateEvts) {\n        this.on(ev, this.updateFn);\n      }\n\n      return;\n    }\n\n    if (!this.minimap) {\n      return;\n    }\n\n    this.minimap.destroy();\n    for (let ev of updateEvts) {\n      this.off(ev, this.updateFn);\n    }\n\n    delete this.minimap;\n    delete this.updateFn;\n  }\n\n  getUnion(name) {\n    if (!name) {\n      console.error('传入正确的name');\n      return;\n    }\n    return this._unionData[name];\n  }\n\n  getAllUnion() {\n    return this._unionData;\n  }\n\n  add2Union(name, obj) {\n    if (!name || !obj) {\n      return;\n    }\n\n    if (!this._unionData[name]) {\n      this._unionData[name] = {\n        nodes: [],\n        groups: [],\n        edges: [],\n        endpoints: []\n      }\n    }\n\n    let _data = this._unionData[name];\n    if (obj.nodes) {\n      obj.nodes.forEach((item) => {\n        let isId = _.isString(item);\n        let node = isId ? this.getNode(item) : item;\n        _data.nodes.push(node);\n      });\n      _data.nodes = _.uniqBy(_data.nodes, 'id');\n    }\n\n    if (obj.groups) {\n      obj.groups.forEach((item) => {\n        let isId = _.isString(item);\n        let group = isId ? this.getGroup(item) : item;\n        _data.groups.push(group);\n      });\n      _data.groups = _.uniqBy(_data.groups, 'id');\n    }\n\n    if (obj.edges) {\n      obj.edges.forEach((item) => {\n        let isId = _.isString(item);\n        let edge = isId ? this.getEdge(item) : item;\n        _data.edges.push(edge);\n      });\n      _data.edges = _.uniqBy(_data.edges, 'id');\n    }\n\n    if (obj.endpoints) {\n      _data.endpoints = _data.endpoints.concat(obj.endpoints);\n    }\n  }\n\n  removeUnion(name) {\n    this._unionData[name] = {\n      nodes: [],\n      edges: [],\n      groups: [],\n      endpoints: []\n    };\n  }\n\n  removeAllUnion() {\n    this._unionData = {\n      __system: {\n        nodes: [],\n        edges: [],\n        groups: [],\n        endpoints: []\n      }\n    };\n  }\n\n  _rmSystemUnion() {\n    this._unionData['__system'].nodes = [];\n    this._unionData['__system'].edges = [];\n    this._unionData['__system'].groups = [];\n    this._unionData['__system'].endpoints = [];\n  }\n\n  _findUnion(type, item) {\n    let result = [];\n    for (let key in this._unionData) {\n      let isExist = _.find(_.get(this._unionData, [key, type], []), (_item) => {\n        return _.toString(_item.id) === _.toString(item.id);\n      });\n      if (isExist) {\n        result.push(key);\n      }\n    }\n    return result;\n  }\n\n  canvas2terminal(coordinates, options) {\n    return this._coordinateService.canvas2terminal(coordinates, options);\n  }\n  terminal2canvas(coordinates, options) {\n    return this._coordinateService.terminal2canvas(coordinates, options);\n  }\n\n  save2img(options) {\n    let method = 'toPng';\n\n    switch (options.type) {\n      case 'jpeg':\n      case '.jpeg':\n        method = 'toJpeg';\n        break;\n      case 'png':\n      case '.png':\n        method = 'toPng';\n        break;\n      case 'svg':\n      case '.svg':\n        method = 'toSvg';\n        break;\n    }\n\n    return domtoimage[method](this.root, options)\n      .then(function (dataUrl) {\n        return dataUrl;\n      })\n      .catch(function (error) {\n        console.error('oops, something went wrong!', error);\n      });\n  }\n\n  justifyCoordinate() {\n    this._gridService.justifyAllCoordinate();\n  }\n\n  _genSvgWrapper() {\n\n\n    function _detectMob() {\n      const toMatch = [\n          /Android/i,\n          /webOS/i,\n          /iPhone/i,\n          /iPad/i,\n          /iPod/i,\n          /BlackBerry/i,\n          /Windows Phone/i\n      ];\n      return toMatch.some((toMatchItem) => {\n          return window.navigator.userAgent.match(toMatchItem);\n      });\n    }\n    let _isMobi = _detectMob();\n    let _SVGWidth = '100%';\n    let _SVGHeight = '100%';\n    \n    let _detectZoom = () => {\n      let ratio = 0;\n      let screen = window.screen;\n      let ua = navigator.userAgent.toLowerCase();\n\n      if (window.devicePixelRatio !== undefined) {\n        ratio = window.devicePixelRatio;\n      }\n      else if (~ua.indexOf('msie')) {\n        if (screen.deviceXDPI && screen.logicalXDPI) {\n          ratio = screen.deviceXDPI / screen.logicalXDPI;\n        }\n      }\n      else if (window.outerWidth !== undefined && window.innerWidth !== undefined) {\n        ratio = window.outerWidth / window.innerWidth;\n      }\n\n      if (ratio) {\n        ratio = Math.round(ratio * 100);\n      }\n      return ratio;\n    };\n\n    // hack 适配浏览器的缩放比例\n    if (!_isMobi) {\n      let _sclae = 1 / (_detectZoom() / 200);\n      _SVGWidth = (1 * _sclae) + 'px';\n      _SVGHeight = (1 * _sclae) + 'px';\n    }\n\n    // 生成svg的wrapper\n    const svg = $(document.createElementNS('http://www.w3.org/2000/svg', 'svg'))\n      .attr('class', 'butterfly-svg')\n      .attr('width', _SVGWidth)\n      .attr('height', _SVGHeight)\n      .attr('version', '1.1')\n      .attr('xmlns', 'http://www.w3.org/2000/svg')\n      .appendTo(this.wrapper);\n\n    if(!_isMobi) {\n      // hack 监听浏览器的缩放比例并适配\n      window.onresize = () => {\n        let _sclae = 1 / (_detectZoom() / 200);\n        svg.attr('width', (1 * _sclae) + 'px').attr('height', (1 * _sclae) + 'px');\n      }\n\n      // hack 因为width和height为1的时候会有偏移\n      let wrapperOffset = $(this.wrapper)[0].getBoundingClientRect();\n      let svgOffset = svg[0].getBoundingClientRect();\n      svg.css('top', (wrapperOffset.top - svgOffset.top) + 'px').css('left', (wrapperOffset.left - svgOffset.left) + 'px');\n    }\n\n    return this.svg = svg;\n  }\n\n  _genWrapper() {\n    // 生成wrapper\n    const wrapper = $('<div class=\"butterfly-wrapper\"></div>')\n      .appendTo(this.root);\n    return this.wrapper = wrapper[0];\n  }\n\n  _genCanvasWrapper() {\n    // 生成canvas wrapper\n    this.canvasWrapper = new SelectCanvas();\n    this.canvasWrapper.init({\n      root: this.root,\n      _on: this.on.bind(this),\n      _emit: this.emit.bind(this)\n    });\n  }\n\n  _addEventListener() {\n    if (this.zoomable) {\n      this.setZoomable(true);\n    }\n    if (this.moveable) {\n      this.setMoveable(true);\n    }\n\n    let _isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\n    let _getChromeVersion = () => {\n      var raw = window.navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n      return raw ? parseInt(raw[2], 10) : false;\n    };\n    let _isHightVerChrome = _isChrome && _getChromeVersion() >= 64;\n\n    // todo：chrome64版本ResizeObserver对象不存在，但官方文档说64支持，所以加强判断下\n    if (_isHightVerChrome && window.ResizeObserver && this.theme.autoResizeRootSize) {\n      // 监听某个dom的resize事件\n      const _resizeObserver = new ResizeObserver(entries => {\n        this._rootWidth = $(this.root).width();\n        this._rootHeight = $(this.root).height();\n        this._coordinateService._changeCanvasInfo({\n          terOffsetX: $(this.root).offset().left,\n          terOffsetY: $(this.root).offset().top,\n          terWidth: $(this.root).width(),\n          terHeight: $(this.root).height()\n        });\n        this.canvasWrapper.resize({root: this.root});\n      });\n      _resizeObserver.observe(this.root);\n    } else {\n      //  降级处理，监控窗口的resize事件\n      window.addEventListener('resize', () => {\n        this._rootWidth = $(this.root).width();\n        this._rootHeight = $(this.root).height();\n        this._coordinateService._changeCanvasInfo({\n          terOffsetX: $(this.root).offset().left,\n          terOffsetY: $(this.root).offset().top,\n          terWidth: $(this.root).width(),\n          terHeight: $(this.root).height()\n        });\n        this.canvasWrapper.resize({root: this.root});\n      })\n    }\n\n    // 绑定一大堆事件，group:addMember，groupDragStop，group:removeMember，beforeDetach，connection，\n    this.on('InnerEvents', (data) => {\n      if (data.type === 'node:addEndpoint') {\n        this._addEndpoint(data.data, 'node', data.isInited);\n      } else if (data.type === 'node:removeEndpoint') {\n        let _point = data.data;\n        let rmEdges = this.edges.filter((item) => {\n          return (item.sourceNode.id === _point.nodeId && item.sourceEndpoint.id === _point.id) ||\n                 (item.targetNode.id === _point.nodeId && item.targetEndpoint.id === _point.id);\n        });\n        this.removeEdges(rmEdges);\n      } else if (data.type === 'group:addEndpoint') {\n        this._addEndpoint(data.data, 'group', data.isInited);\n      } else if (data.type === 'node:dragBegin') {\n        this._dragType = 'node:drag';\n        this._dragNode = data.data;\n      } else if (data.type === 'node:mouseDown') {\n        this._dragType = 'node:mouseDown';\n      } else if (data.type === 'group:dragBegin') {\n        this._dragType = 'group:drag';\n        this._dragNode = data.data;\n      } else if (data.type === 'endpoint:drag') {\n        this._dragType = 'endpoint:drag';\n        this._dragEndpoint = data.data;\n      } else if (data.type === 'node:move') {\n        this._moveNode(data.node, data.x, data.y, data.isNotEventEmit);\n      } else if (data.type === 'group:move') {\n        this._moveGroup(data.group, data.x, data.y, data.isNotEventEmit);\n      } else if (data.type === 'link:click') {\n        this._dragType = 'link:click';\n      } else if (data.type === 'multiple:select') {\n        const result = this._selectMultiplyItem(data.range, data.toDirection);\n        // 把框选的加到union的数组\n        _.assign(this._unionData['__system'], this.selectItem);\n\n        this.emit('system.multiple.select', {\n          data: result\n        });\n        this.emit('events', {\n          type: 'multiple:select',\n          data: result\n        });\n\n        this.selectItem = {\n          nodes: [],\n          edges: [],\n          endpoints: []\n        };\n      } else if (data.type === 'group:resize') {\n        this._dragType = 'group:resize';\n        this._dragGroup = data.group;\n      } else if (data.type === 'node:delete') {\n        this.removeNode(data.data.id);\n      } else if (data.type === 'edge:delete') {\n        this.removeEdge(data.data);\n      } else if (data.type === 'group:delete') {\n        this.removeGroup(data.data.id);\n      } else if (data.type === 'group:addNodes') {\n        _.get(data, 'nodes', []).forEach((item) => {\n          let _hasNode = _.find(this.nodes, (_node) => {\n            return item.id === _node.id;\n          });\n          if (!_hasNode) {\n            this.addNode(item);\n          } else {\n            let neighborEdges = [];\n            let rmItem = this.removeNode(item.id, true, true);\n            let rmNode = rmItem.nodes[0];\n            let _group = data.group;\n            neighborEdges = rmItem.edges;\n            rmNode._init({\n              top: item.top - _group.top,\n              left: item.left - _group.left,\n              dom: rmNode.dom,\n              group: _group.id\n            });\n            this.addNode(rmNode, true);\n          }\n        });\n        if (!data.isNotEventEmit) {\n          this.emit('events', {\n            type: 'system.group.addMembers',\n            nodes: data.nodes,\n            group: data.group\n          });\n          this.emit('system.group.addMembers', {\n            nodes: data.nodes,\n            group: data.group\n          });\n        }\n      } else if (data.type === 'group:removeNodes') {\n        let _group = data.group;\n        _.get(data, 'nodes', []).forEach((item) => {\n          this.removeNode(item.id, true, true);\n          item._init({\n            group: undefined,\n            left: item.left + _group.left,\n            top: item.top + _group.top,\n            dom: item.dom,\n            _isDeleteGroup: true\n          });\n          this.addNode(item, true);\n        });\n      } else if (data.type === 'edge:updateLabel') {\n        let labelDom = data.data.labelDom;\n        $(this.wrapper).append(labelDom);\n      }\n    });\n\n    // 绑定拖动事件\n    this._attachMouseDownEvent();\n  }\n\n  _isExistNode(node) {\n    const hasNodes = this.nodes.filter(item => item.id === node.id);\n    return hasNodes.length > 0;\n  }\n\n  _isExistGroup(group) {\n    const hasGroups = this.groups.filter(item => item.id === group.id);\n    return hasGroups.length > 0;\n  }\n\n  _addEndpoint(endpoint, type, isInited) {\n    let initOtps = {\n      nodeType: type,\n      _coordinateService: this._coordinateService\n    };\n    endpoint._init(initOtps);\n\n    // 非自定义dom，自定义dom不需要定位\n    if (!endpoint._isInitedDom) {\n      const endpointDom = endpoint.dom;\n      if (_.get(endpoint, '_node.group')) {\n        const group = this.getGroup(endpoint._node.group);\n        $(group.dom).append(endpointDom);\n      } else {\n        $(this.wrapper).prepend(endpointDom);\n      }\n      endpoint.updatePos();\n    }\n    endpoint.mounted && endpoint.mounted();\n  }\n\n  _attachMouseDownEvent() {\n    let canvasOriginPos = {\n      x: 0,\n      y: 0\n    };\n    let nodeOriginPos = {\n      x: 0,\n      y: 0\n    };\n\n    let _isActiveEndpoint = false;\n    let _activeItems = [];\n    // 把其他可连接的point高亮\n    let _activeLinkableEndpoint = (target) => {\n      if (_isActiveEndpoint) {\n        return;\n      }\n      let _allPoints = this._getAllEndpoints();\n      _allPoints.forEach((_point) => {\n        if (target === _point || _point.type === 'source' || _point._tmpType === 'source') {\n          return;\n        }\n        if (_point.canLink && _point.canLink(target)) {\n          if (_point.linkable) {\n            _point.linkable();\n            _point._linkable = true;\n          }\n          return;\n        }\n        if (ScopeCompare(target.scope, _point.scope)) {\n          if (_point.linkable) {\n            _point.linkable();\n            _point._linkable = true;\n          }\n          _activeItems.push(_point);\n          return;\n        }\n      });\n      _isActiveEndpoint = true;\n    };\n    // 把其他可连接的point取消高亮\n    let _unActiveLinkableEndpoint = () => {\n      _isActiveEndpoint = false;\n      _activeItems.forEach((item) => {\n        item.unLinkable && item.unLinkable();\n        item.unHoverLinkable && item.unHoverLinkable();\n        item._linkable = false;\n      });\n      _activeItems = [];\n    };\n\n\n    let _oldFocusPoint = null;\n    let _isFocusing = false;\n    // 检查鼠标是否在可连的锚点上\n    let _focusLinkableEndpoint = (cx, cy) => {\n      if (!_isFocusing) {\n        // if (_focusPoint) {\n        //   _focusPoint.unHoverLinkable && _focusPoint.unHoverLinkable();\n        //   _focusPoint = null;\n        // }\n        _isFocusing = true;\n        setTimeout(() => {\n          let _points = this._getAllEndpoints();\n          let x = this._coordinateService._terminal2canvas('x', cx);\n          let y = this._coordinateService._terminal2canvas('y', cy);\n          let _focusPoint = null;\n          _points.forEach((_point) => {\n            const _maxX = _point._posLeft + _point._width + (_.get(_point, 'expandArea.right') || this.theme.endpoint.expandArea.right);\n            const _maxY = _point._posTop + _point._height + (_.get(_point, 'expandArea.bottom') || this.theme.endpoint.expandArea.bottom);\n            const _minX = _point._posLeft - (_.get(_point, 'expandArea.left') || this.theme.endpoint.expandArea.left);\n            const _minY = _point._posTop - (_.get(_point, 'expandArea.top') || this.theme.endpoint.expandArea.top);\n            if (x > _minX && x < _maxX && y > _minY && y < _maxY) {\n              _focusPoint = _point;\n            }\n          });\n          if (_focusPoint) {\n            if (_focusPoint !== _oldFocusPoint) {\n              _focusPoint.hoverLinkable && _focusPoint.hoverLinkable();\n              _oldFocusPoint = _focusPoint;\n            }\n          } else {\n            if (_oldFocusPoint) {\n              _oldFocusPoint.unHoverLinkable && _oldFocusPoint.unHoverLinkable();\n              _oldFocusPoint = null;\n            }\n          }\n          _isFocusing = false;\n        }, 100);\n      }\n    };\n\n    const mouseDownEvent = (event) => {\n      const LEFT_BUTTON = 0;\n      if (event.button !== LEFT_BUTTON) {\n        return;\n      }\n\n      if (!this._dragType && this.moveable) {\n        this._dragType = 'canvas:drag';\n      }\n\n      // 假如点击在空白地方且在框选模式下\n      if ((event.target === this.svg[0] || event.target === this.root) && this.isSelectMode) {\n        this.canvasWrapper.active();\n        this.canvasWrapper.dom.dispatchEvent(new MouseEvent('mousedown', {\n          clientX: event.clientX,\n          clientY: event.clientY\n        }));\n        return;\n      }\n\n      canvasOriginPos = {\n        x: event.clientX,\n        y: event.clientY\n      };\n\n      this.emit('system.drag.start', {\n        dragType: this._dragType,\n        dragNode: this._dragNode,\n        dragEndpoint: this._dragEndpoint,\n        dragEdges: this._dragEdges,\n        dragGroup: this._dragGroup,\n        position: {\n          clientX: event.clientX,\n          clientY: event.clientY,\n          canvasX: this._coordinateService._terminal2canvas('x', event.clientX),\n          canvasY: this._coordinateService._terminal2canvas('y', event.clientY)\n        }\n      });\n      this.emit('events', {\n        type: 'drag:start',\n        dragType: this._dragType,\n        dragNode: this._dragNode,\n        dragEndpoint: this._dragEndpoint,\n        dragEdges: this._dragEdges,\n        dragGroup: this._dragGroup,\n        position: {\n          clientX: event.clientX,\n          clientY: event.clientY,\n          canvasX: this._coordinateService._terminal2canvas('x', event.clientX),\n          canvasY: this._coordinateService._terminal2canvas('y', event.clientY)\n        }\n      });\n      this._autoMoveDir = [];\n    };\n\n    const mouseMoveEvent = (event) => {\n      const LEFT_BUTTON = 0;\n      if (event.button !== LEFT_BUTTON) {\n        return;\n      }\n      if (this._dragType) {\n        const canvasX = this._coordinateService._terminal2canvas('x', event.clientX);\n        const canvasY = this._coordinateService._terminal2canvas('y', event.clientY);\n        const offsetX = event.clientX - canvasOriginPos.x;\n        const offsetY = event.clientY - canvasOriginPos.y;\n        if (this._dragType === 'canvas:drag') {\n          this.move([offsetX + this._moveData[0], offsetY + this._moveData[1]]);\n          canvasOriginPos = {\n            x: event.clientX,\n            y: event.clientY\n          };\n        } else if (this._dragType === 'node:drag') {\n          if (nodeOriginPos.x === 0 && nodeOriginPos.y === 0) {\n            nodeOriginPos = {\n              x: canvasX,\n              y: canvasY\n            };\n            return;\n          }\n          if (this._dragNode) {\n            let moveNodes = [this._dragNode];\n            const unionKeys = this._findUnion('nodes', this._dragNode);\n            if (unionKeys && unionKeys.length > 0) {\n              unionKeys.forEach((key) => {\n                moveNodes = moveNodes.concat(this._unionData[key].nodes);\n              });\n              moveNodes = _.uniqBy(moveNodes, 'id');\n            } else {\n              this._rmSystemUnion();\n            }\n            $(this.svg).css('visibility', 'hidden');\n            $(this.wrapper).css('visibility', 'hidden');\n            moveNodes.forEach((node) => {\n              this._moveNode(node, node.left + (canvasX - nodeOriginPos.x), node.top + (canvasY - nodeOriginPos.y));\n              if (this._guidelineService.isActive) {\n                this._guidelineService.draw(node, 'node');\n              }\n            });\n            $(this.svg).css('visibility', 'visible');\n            $(this.wrapper).css('visibility', 'visible');\n            nodeOriginPos = {\n              x: canvasX,\n              y: canvasY\n            };\n            this.emit('system.node.move', {\n              nodes: moveNodes\n            });\n            this.emit('events', {\n              type: 'node:move',\n              nodes: moveNodes\n            });\n            this._autoMoveCanvas(event.clientX, event.clientY, {\n              type: 'node:drag',\n              nodes: moveNodes\n            }, (gap) => {\n              nodeOriginPos.x += gap[0];\n              nodeOriginPos.y += gap[1];\n            });\n          }\n        } else if (this._dragType === 'group:drag') {\n          if (nodeOriginPos.x === 0 && nodeOriginPos.y === 0) {\n            nodeOriginPos = {\n              x: canvasX,\n              y: canvasY\n            };\n            return;\n          }\n          if (this._dragNode) {\n            $(this.svg).css('visibility', 'hidden');\n            $(this.wrapper).css('visibility', 'hidden');\n            const group = this._dragNode;\n            this._moveGroup(group, group.left + (canvasX - nodeOriginPos.x), group.top + (canvasY - nodeOriginPos.y));\n            if (this._guidelineService.isActive) {\n              this._guidelineService.draw(group, 'group');\n            }\n            $(this.svg).css('visibility', 'visible');\n            $(this.wrapper).css('visibility', 'visible');\n            nodeOriginPos = {\n              x: canvasX,\n              y: canvasY\n            };\n            this.emit('system.group.move', {\n              group: group\n            });\n            this.emit('events', {\n              type: 'group:move',\n              group: group\n            });\n            this._autoMoveCanvas(event.clientX, event.clientY, {\n              type: 'group:drag',\n              group: group\n            }, (gap) => {\n              nodeOriginPos.x += gap[0];\n              nodeOriginPos.y += gap[1];\n            });\n          }\n        } else if (this._dragType === 'endpoint:drag') {\n          const endX = this._coordinateService._terminal2canvas('x', event.clientX);\n          const endY = this._coordinateService._terminal2canvas('y', event.clientY);\n\n          // 明确标记source或者是没有type且没有线连上\n          let _isSourceEndpoint = (this._dragEndpoint.type === 'source' || this._dragEndpoint.type === 'onlyConnect' || (!this._dragEndpoint.type && (!this._dragEndpoint._tmpType || this._dragEndpoint._tmpType === 'source')));\n          let _isTargetEndpoint = (this._dragEndpoint.type === 'target' || (!this._dragEndpoint.type && this._dragEndpoint._tmpType === 'target')) && !this._dragEndpoint.type === 'onlyConnect';\n\n          if (_isSourceEndpoint && this.linkable) {\n            let unionKeys = this._findUnion('endpoints', this._dragEndpoint);\n\n            let edges = [];\n            if (!this._dragEdges || this._dragEdges.length === 0) {\n              const EdgeClass = this.theme.edge.Class;\n              let endpoints = [];\n              if (unionKeys && unionKeys.length > 0) {\n                unionKeys.forEach((key) => {\n                  endpoints = endpoints.concat(this._unionData[key].endpoints);\n                });\n                endpoints = _.uniqBy(endpoints, (_point) => {return _point.nodeId + '||' + _point.id});\n              } else {\n                endpoints = [this._dragEndpoint];\n              }\n              endpoints.forEach((point) => {\n                let pointObj = {\n                  type: 'endpoint',\n                  shapeType: this.theme.edge.type,\n                  orientationLimit: this.theme.endpoint.position,\n                  _sourceType: point.nodeType,\n                  sourceNode: point.nodeType === 'node' ? this.getNode(point.nodeId) : this.getGroup(point.nodeId),\n                  sourceEndpoint: point,\n                  arrow: this.theme.edge.arrow,\n                  arrowPosition: this.theme.edge.arrowPosition,\n                  arrowOffset: this.theme.edge.arrowOffset,\n                  label: this.theme.edge.label,\n                  isExpandWidth: this.theme.edge.isExpandWidth\n                };\n                // 检查endpoint限制连接数目\n                let _linkNums = this.edges.filter((_edge) => {\n                  return _edge.sourceEndpoint.id === point.id;\n                }).length + 1;\n                if (_linkNums > point.limitNum) {\n                  console.warn(`id为${point.id}的锚点限制了${point.limitNum}条连线`);\n                  return;\n                }\n                let _newEdge = new EdgeClass(_.assign(pointObj, {\n                  _global: this.global,\n                  _on: this.on.bind(this),\n                  _emit: this.emit.bind(this),\n                }));\n                _newEdge._init();\n                $(this.svg).append(_newEdge.dom);\n                if (_newEdge.labelDom) {\n                  $(this.wrapper).append(_newEdge.labelDom);\n                }\n                if (_newEdge.arrowDom) {\n                  $(this.svg).append(_newEdge.arrowDom);\n                }\n                edges.push(_newEdge);\n              });\n              this._dragEdges = edges;\n            } else {\n              edges = this._dragEdges;\n            }\n\n            $(this.svg).css('visibility', 'hidden');\n            $(this.wrapper).css('visibility', 'hidden');\n            let _targetPoint = {\n              pos: [endX, endY],\n            };\n            edges.forEach((edge) => {\n              let beginX = edge.sourceEndpoint._posLeft + edge.sourceEndpoint._width / 2;\n              let beginY = edge.sourceEndpoint._posTop + edge.sourceEndpoint._height / 2;\n              const _soucePoint = {\n                pos: [beginX, beginY],\n                orientation: edge.sourceEndpoint.orientation\n              };\n              edge.redraw(_soucePoint, _targetPoint);\n            });\n            $(this.svg).css('visibility', 'visible');\n            $(this.wrapper).css('visibility', 'visible');\n\n            if (this.theme.endpoint.linkableHighlight) {\n              _activeLinkableEndpoint(this._dragEndpoint);\n              _focusLinkableEndpoint(event.clientX, event.clientY);\n            }\n\n            this._autoMoveCanvas(event.clientX, event.clientY, {\n              type: 'endpoint:drag',\n              edges: edges\n            }, (gap) => {\n              edges.forEach((edge) => {\n                let beginX = edge.sourceEndpoint._posLeft + edge.sourceEndpoint._width / 2;\n                let beginY = edge.sourceEndpoint._posTop + edge.sourceEndpoint._height / 2;\n                const _soucePoint = {\n                  pos: [beginX, beginY],\n                  orientation: edge.sourceEndpoint.orientation\n                };\n                _targetPoint.pos[0] += gap[0];\n                _targetPoint.pos[1] += gap[1];\n                edge.redraw(_soucePoint, _targetPoint);\n              });\n            });\n\n            this.emit('system.drag.move', {\n              dragType: this._dragType,\n              pos: [event.clientX, event.clientY],\n              dragNode: this._dragNode,\n              dragEndpoint: this._dragEndpoint,\n              dragEdges: edges\n            });\n            this.emit('events', {\n              type: 'drag:move',\n              dragType: this._dragType,\n              pos: [event.clientX, event.clientY],\n              dragNode: this._dragNode,\n              dragEndpoint: this._dragEndpoint,\n              dragEdges: edges\n            });\n          } else if (_isTargetEndpoint && this.disLinkable) {\n            // 从后面搜索线\n            let targetEdge = null;\n            for (let i = this.edges.length - 1; i >= 0; i--) {\n              if (this._dragEndpoint.id === _.get(this.edges, [i, 'targetEndpoint', 'id']) && this._dragEndpoint.nodeId === _.get(this.edges, [i, 'targetNode', 'id'])) {\n                targetEdge = this.edges[i];\n                break;\n              }\n            }\n            if (targetEdge && this._dragEdges.length === 0) {\n              targetEdge._isDeletingEdge = true;\n              this._dragEdges = [targetEdge];\n            }\n\n            if (this._dragEdges.length !== 0) {\n              let edge = this._dragEdges[0];\n              let beginX = edge.sourceEndpoint._posLeft + edge.sourceEndpoint._width / 2;\n              let beginY = edge.sourceEndpoint._posTop + edge.sourceEndpoint._height / 2;\n              const _soucePoint = {\n                pos: [beginX, beginY],\n                orientation: edge.sourceEndpoint.orientation\n              };\n              const _targetPoint = {\n                pos: [endX, endY],\n              };\n              edge.redraw(_soucePoint, _targetPoint);\n            }\n            if (this.theme.endpoint.linkableHighlight) {\n              _activeLinkableEndpoint(this._dragEndpoint);\n              _focusLinkableEndpoint(event.clientX, event.clientY);\n            }\n          }\n        } else if (this._dragType === 'group:resize') {\n          let canvasX = this._coordinateService._terminal2canvas('x', event.clientX);\n          let canvasY = this._coordinateService._terminal2canvas('y', event.clientY);\n\n          let _newWidth = canvasX - this._dragGroup.left;\n          let _newHeight = canvasY - this._dragGroup.top;\n          this._dragGroup.setSize(_newWidth, _newHeight);\n        }\n      }\n    };\n\n    const mouseEndEvent = (event) => {\n      const LEFT_BUTTON = 0;\n      if (event.button !== LEFT_BUTTON) {\n        return;\n      }\n\n      let _unionNodes = [];\n\n      _unActiveLinkableEndpoint();\n\n      // 处理线条的问题\n      if (this._dragType === 'endpoint:drag' && this._dragEdges && this._dragEdges.length !== 0) {\n        // 释放对应画布上的x,y\n        const x = this._coordinateService._terminal2canvas('x', event.clientX);\n        const y = this._coordinateService._terminal2canvas('y', event.clientY);\n\n        let _targetEndpoint = null;\n\n        let _nodes = _.concat(this.nodes, this.groups);\n        _nodes.forEach((_node) => {\n          if (_node.endpoints) {\n            _node.endpoints.forEach((_point) => {\n              const _maxX = _point._posLeft + _point._width + (_.get(_point, 'expandArea.right') || this.theme.endpoint.expandArea.right);\n              const _maxY = _point._posTop + _point._height + (_.get(_point, 'expandArea.bottom') || this.theme.endpoint.expandArea.bottom);\n              const _minX = _point._posLeft - (_.get(_point, 'expandArea.left') || this.theme.endpoint.expandArea.left);\n              const _minY = _point._posTop - (_.get(_point, 'expandArea.top') || this.theme.endpoint.expandArea.top);\n              if (x > _minX && x < _maxX && y > _minY && y < _maxY) {\n                _targetEndpoint = _point;\n              }\n            });\n          }\n        });\n\n        let isDestoryEdges = false;\n        // 找不到点 或者 目标节点不是target\n        if (!_targetEndpoint || _targetEndpoint.type === 'source' || _targetEndpoint._tmpType === 'source') {\n          isDestoryEdges = true;\n        }\n\n        // scope不同\n        if (!isDestoryEdges) {\n          isDestoryEdges = _.some(this._dragEdges, (edge) => {\n            return !ScopeCompare(edge.sourceEndpoint.scope, _targetEndpoint.scope, _.get(this, 'global.isScopeStrict'));\n          });\n        }\n\n        // 检查endpoint限制连接数目\n        if (_targetEndpoint && _targetEndpoint.limitNum !== undefined) {\n          let _linkNum = this.edges.filter((_edge) => {\n            return _edge.targetEndpoint.id === _targetEndpoint.id;\n          }).length + this._dragEdges.length;\n          if (_linkNum > _targetEndpoint.limitNum) {\n            console.warn(`id为${_targetEndpoint.id}的锚点限制了${_targetEndpoint.limitNum}条连线`);\n            isDestoryEdges = true;\n          }\n        }\n\n        if (isDestoryEdges) {\n          this._dragEdges.forEach((edge) => {\n            if (edge._isDeletingEdge) {\n              this.removeEdge(edge);\n            } else {\n              edge.destroy(!edge._isDeletingEdge);\n            }\n          });\n          // 把endpoint重新赋值\n          this._dragEdges.forEach((_rmEdge) => {\n            if (_.get(_rmEdge, 'sourceEndpoint._tmpType') === 'source') {\n              let isExistEdge = _.some(this.edges, (edge) => {\n                return _rmEdge.sourceNode.id === edge.sourceNode.id && _rmEdge.sourceEndpoint.id === edge.sourceEndpoint.id;\n              });\n              !isExistEdge && (_rmEdge.sourceEndpoint._tmpType = undefined);\n            }\n            if (_.get(_rmEdge, 'targetEndpoint._tmpType') === 'target') {\n              let isExistEdge = _.some(this.edges, (edge) => {\n                return _rmEdge.targetNode.id === edge.targetNode.id && _rmEdge.targetEndpoint.id === edge.targetEndpoint.id;\n              });\n              !isExistEdge && (_rmEdge.targetEndpoint._tmpType = undefined);\n            }\n          });\n        } else {\n          let _delEdges = [];\n          let _reconnectInfo = [];\n\n          let _emitEdges = this._dragEdges.filter((edge) => {\n            // 线条去重\n            if (!this.theme.edge.isRepeat) {\n              let _isRepeat = _.some(this.edges, (_edge) => {\n                let _result = false;\n                if (edge.sourceNode) {\n                  if (_edge.type === 'node') {\n                    _result = edge.sourceNode.id === _edge.sourceNode.id;\n                  } else {\n                    _result = edge.sourceNode.id === _edge.sourceNode.id && edge.sourceEndpoint.id === _edge.sourceEndpoint.id;\n                  }\n                }\n\n                if (_targetEndpoint.nodeId) {\n                  if (_edge.type === 'node') {\n                    _result = _result && (_.get(edge, 'targetNode.id') === _.get(_edge, 'targetNode.id'));\n                  } else {\n                    _result = _result && (_targetEndpoint.nodeId === _.get(_edge, 'targetNode.id') && _targetEndpoint.id === _.get(_edge, 'targetEndpoint.id'));\n                  }\n                }\n\n                if (_result && edge._isDeletingEdge) {\n                  _result = false;\n                }\n\n                return _result;\n              });\n              if (_isRepeat) {\n                console.warn(`id为${edge.sourceEndpoint.id}-${_targetEndpoint.id}的线条连接重复，请检查`);\n                edge.destroy();\n                return false;\n              }\n            }\n            let _preTargetNodeId = _.get(edge, 'targetNode.id');\n            let _preTargetPointId = _.get(edge, 'targetEndpoint.id');\n            let _currentTargetNode = _targetEndpoint.nodeType === 'node' ? this.getNode(_targetEndpoint.nodeId) : this.getGroup(_targetEndpoint.nodeId);\n            let _currentTargetEndpoint = _targetEndpoint;\n            if (_preTargetNodeId && _preTargetPointId && `${_preTargetNodeId}||${_preTargetPointId}` !== `${_currentTargetNode.id}||${_currentTargetEndpoint.id}`) {\n              _delEdges.push(_.cloneDeep(edge));\n              _reconnectInfo.push({\n                edge,\n                preTargetNodeId: _preTargetNodeId,\n                preTargetPointId: _preTargetPointId,\n                currentTargetNodeId: _currentTargetNode.id,\n                currentTargetPointId: _currentTargetEndpoint.id\n              });\n            }\n            edge._create({\n              id: edge.id && !edge._isDeletingEdge ? edge.id : `${edge.sourceEndpoint.id}-${_targetEndpoint.id}`,\n              targetNode: _currentTargetNode,\n              _targetType: _targetEndpoint.nodeType,\n              targetEndpoint: _currentTargetEndpoint,\n              type: 'endpoint'\n            });\n            let _isConnect = edge.isConnect ? edge.isConnect() : true;\n            if (!_isConnect) {\n              console.warn(`id为${edge.sourceEndpoint.id}-${_targetEndpoint.id}的线条无法连接，请检查`);\n              edge.destroy();\n              return false;\n            }\n\n            // 正在删除的线重新连接\n            if (edge._isDeletingEdge) {\n              delete edge._isDeletingEdge;\n            } else {\n              edge.mounted && edge.mounted();\n              this.edges.push(edge);\n            }\n\n            // 把endpoint重新赋值\n            if (edge.type === 'endpoint' && !_.get(edge, 'sourceEndpoint.type') && !_.get(edge, 'sourceEndpoint._tmpType')) {\n              edge.sourceEndpoint._tmpType = 'source';\n            }\n            if (edge.type === 'endpoint' && !_.get(edge, 'targetEndpoint.type') && !_.get(edge, 'targetEndpoint._tmpType')) {\n              edge.targetEndpoint._tmpType = 'target';\n            }\n\n            return edge;\n          });\n          if (_delEdges.length !== 0 && _emitEdges.length !== 0) {\n            this.pushActionQueue({\n              type: 'system:reconnectEdges',\n              data: {\n                delLinks: _delEdges,\n                addLinks: _emitEdges,\n                info: _reconnectInfo\n              }\n            });\n            this.emit('system.link.reconnect', {\n              delLinks: _delEdges,\n              addLinks: _emitEdges,\n              info: _reconnectInfo\n            });\n            this.emit('events', {\n              type: 'link:reconnect',\n              delLinks: _delEdges,\n              addLinks: _emitEdges,\n              info: _reconnectInfo\n            });\n          } else {\n            if (_delEdges.length !== 0) {\n              _delEdges.forEach((_edge) => {\n                this.pushActionQueue({\n                  type: 'system:removeEdges',\n                  data: _delEdges\n                });\n                this.emit('system.link.delete', {\n                  link: _edge\n                });\n                this.emit('events', {\n                  type: 'link:delete',\n                  link: _edge\n                });\n              });\n            }\n            if (_emitEdges.length !== 0) {\n              this.pushActionQueue({\n                type: 'system:addEdges',\n                data: this._dragEdges\n              });\n              this.emit('system.link.connect', {\n                links: this._dragEdges\n              });\n              this.emit('events', {\n                type: 'link:connect',\n                links: this._dragEdges\n              });\n            }\n          }\n        }\n      }\n      if (this._dragType === 'node:drag' && this._dragNode) {\n\n        let _handleDragNode = (dragNode) => {\n          let sourceGroup = null;\n          let targetGroup = null;\n          let _nodeLeft = dragNode.left;\n          let _nodeRight = dragNode.left + dragNode.getWidth();\n          let _nodeTop = dragNode.top;\n          let _nodeBottom = dragNode.top + dragNode.getHeight();\n\n          if (dragNode.group) {\n            const _group = this.getGroup(dragNode.group);\n            const _groupLeft = _group.left;\n            const _groupTop = _group.top;\n            if (_nodeRight < 0 || _nodeLeft > _group.getWidth() || _nodeBottom < 0 || _nodeTop > _group.getHeight()) {\n              _nodeLeft += _groupLeft;\n              _nodeTop += _groupTop;\n              _nodeRight += _groupLeft;\n              _nodeBottom += _groupTop;\n              sourceGroup = _group;\n            } else {\n              sourceGroup = _group;\n              targetGroup = _group;\n            }\n          }\n\n          if (!targetGroup) {\n            for (let i = 0; i < this.groups.length; i++) {\n              const _group = this.groups[i];\n              const _groupLeft = _group.left;\n              const _groupRight = _group.left + _group.getWidth();\n              const _groupTop = _group.top;\n              const _groupBottom = _group.top + _group.getHeight();\n              if (_groupLeft <= _nodeLeft && _groupRight >= _nodeRight && _groupTop <= _nodeTop && _groupBottom >= _nodeBottom) {\n                if (_group.id !== dragNode.group) {\n                  targetGroup = _group;\n                  break;\n                }\n              }\n            }\n          }\n\n          let neighborEdges = [];\n\n          // 更新edge里面的字段，以防外面操作了里面dom\n          let _updateNeighborEdge = (node, neighborEdges) => {\n            neighborEdges.forEach((_edge) => {\n              if (_edge.sourceNode.id === node.id) {\n                _edge.sourceNode = node;\n                let _sourceEndpoint = _.find(_edge.sourceNode.endpoints, (_point) => {\n                  return _edge.sourceEndpoint.id === _point.id;\n                });\n                _edge.sourceEndpoint = _sourceEndpoint;\n              }\n              if (_edge.targetNode.id === node.id) {\n                _edge.targetNode = node;\n                let _targetEndpoint = _.find(_edge.targetNode.endpoints, (_point) => {\n                  return _edge.targetEndpoint.id === _point.id;\n                });\n                _edge.targetEndpoint = _targetEndpoint;\n              }\n            });\n          };\n\n          if (sourceGroup) {\n            // 从源组拖动到目标组\n            if (sourceGroup !== targetGroup) {\n              const rmItem = this.removeNode(dragNode.id, true, true);\n              const rmNode = rmItem.nodes[0];\n              neighborEdges = rmItem.edges;\n              const nodeData = {\n                id: rmNode.id,\n                top: _nodeTop,\n                left: _nodeLeft,\n                dom: rmNode.dom,\n                _isDeleteGroup: true\n              };\n              let step = this.actionQueue[this.actionQueueIndex];\n              if (step.type === 'system:moveNodes') {\n                step.data._isDraging = true;\n              }\n              this.pushActionQueue({\n                type: 'system:groupRemoveMembers',\n                data: {\n                  group: sourceGroup,\n                  nodes: [rmNode],\n                  _isDraging: true\n                }\n              })\n              this.emit('events', {\n                type: 'system.group.removeMembers',\n                group: sourceGroup,\n                nodes: [rmNode]\n              });\n              this.emit('system.group.removeMembers', {\n                group: sourceGroup,\n                nodes: [rmNode]\n              });\n\n              if (targetGroup) {\n                if (ScopeCompare(dragNode.scope, targetGroup.scope, _.get(this, 'global.isScopeStrict'))) {\n                  nodeData.top -= targetGroup.top;\n                  nodeData.left -= targetGroup.left;\n                  nodeData.group = targetGroup.id;\n                  nodeData._isDeleteGroup = false;\n                  this.popActionQueue();\n                  this.pushActionQueue({\n                    type: 'system:groupAddMembers',\n                    data: {\n                      sourceGroup: sourceGroup,\n                      targetGroup: targetGroup,\n                      nodes: [rmNode],\n                      _isDraging: true\n                    }\n                  });\n                  this.emit('events', {\n                    type: 'system.group.addMembers',\n                    nodes: [rmNode],\n                    group: targetGroup\n                  });\n                  this.emit('system.group.addMembers', {\n                    nodes: [rmNode],\n                    group: targetGroup\n                  });\n\n                } else {\n                  console.warn(`nodeId为${dragNode.id}的节点和groupId${targetGroup.id}的节点组scope值不符，无法加入`);\n                }\n              }\n              rmNode._init(nodeData);\n              this.addNode(rmNode, true);\n              _updateNeighborEdge(rmNode, neighborEdges);\n            }\n          } else {\n            if (targetGroup) {\n              if (ScopeCompare(dragNode.scope, targetGroup.scope, _.get(this, 'global.isScopeStrict'))) {\n                const rmItem = this.removeNode(dragNode.id, true, true);\n                const rmNode = rmItem.nodes[0];\n                neighborEdges = rmItem.edges;\n                rmNode._init({\n                  top: _nodeTop - targetGroup.top,\n                  left: _nodeLeft - targetGroup.left,\n                  dom: rmNode.dom,\n                  group: targetGroup.id\n                });\n                this.addNode(rmNode, true);\n                let step = this.actionQueue[this.actionQueueIndex];\n                if (step.type === 'system:moveNodes') {\n                  step.data._isDraging = true;\n                }\n                _updateNeighborEdge(rmNode, neighborEdges);\n                this.pushActionQueue({\n                  type: 'system:groupAddMembers',\n                  data: {\n                    sourceGroup: undefined,\n                    targetGroup: targetGroup,\n                    nodes: [rmNode],\n                    _isDraging: true\n                  }\n                });\n                this.emit('events', {\n                  type: 'system.group.addMembers',\n                  nodes: [rmNode],\n                  group: targetGroup\n                });\n                this.emit('system.group.addMembers', {\n                  nodes: [rmNode],\n                  group: targetGroup\n                });\n              } else {\n                console.warn(`nodeId为${dragNode.id}的节点和groupId${targetGroup.id}的节点组scope值不符，无法加入`);\n              }\n            }\n          }\n          neighborEdges.forEach((item) => {\n            item.redraw();\n          });\n          dragNode.endpoints.forEach((item) => {\n            item.updatePos && item.updatePos();\n          });\n          dragNode._isMoving = false;\n        }\n        let moveNodes = [this._dragNode];\n        const unionKeys = this._findUnion('nodes', this._dragNode);\n        if (unionKeys && unionKeys.length > 0) {\n          unionKeys.forEach((key) => {\n            moveNodes = moveNodes.concat(this._unionData[key].nodes);\n          });\n          moveNodes = _.uniqBy(moveNodes, 'id');\n        }\n        moveNodes.forEach((dragNode) => {\n          _handleDragNode(dragNode);\n        });\n        _unionNodes = moveNodes;\n        this._rmSystemUnion();\n      }\n\n      // 节点组放大缩小\n      if (this._dragType === 'group:resize' && this._dragGroup) {\n        this.emit('events', {\n          type: 'system.group.resize',\n          group: this._dragGroup\n        });\n        this.emit('system.group.resize', {\n          group: this._dragGroup\n        });\n      }\n\n      // 点击空白处触发canvas click，并且框选模式下不触发\n      if ((this._dragType === 'canvas:drag' || !this._dragType) && !this.isSelectMode) {\n        this.emit('system.canvas.click');\n        this.emit('events', {\n          type: 'canvas:click'\n        });\n      }\n\n      if (this._dragType === 'node:drag' || this._dragType === 'group:drag') {\n        this.pushActionQueue({\n          type: '_system:dragNodeEnd'\n        });\n      }\n\n      this.emit('system.drag.end', {\n        dragType: this._dragType,\n        dragNode: this._dragNode,\n        dragEndpoint: this._dragEndpoint,\n        dragEdges: this._dragEdges,\n        dragGroup: this._dragGroup,\n        unionNodes: _unionNodes\n      });\n      this.emit('events', {\n        type: 'drag:end',\n        dragType: this._dragType,\n        dragNode: this._dragNode,\n        dragEndpoint: this._dragEndpoint,\n        dragEdges: this._dragEdges,\n        dragGroup: this._dragGroup,\n        unionNodes: _unionNodes\n      });\n\n      this._dragType = null;\n      this._dragNode = null;\n      this._dragEndpoint = null;\n      this._dragGroup = null;\n      this._dragEdges = [];\n      nodeOriginPos = {\n        x: 0,\n        y: 0\n      };\n      canvasOriginPos = {\n        x: 0,\n        y: 0\n      };\n      this._autoMoveDir = [];\n      this._guidelineService.isActive && this._guidelineService.clearCanvas();\n    };\n\n\n    this.root.addEventListener('mousedown', mouseDownEvent);\n    this.root.addEventListener('mousemove', mouseMoveEvent);\n    // this.root.addEventListener('mouseleave', mouseEndEvent);\n    this.root.addEventListener('mouseup', mouseEndEvent);\n  }\n  _autoMoveCanvas(x, y, data, cb) {\n\n    if (!this.theme.autoFixCanvas.enable) {\n      return;\n    }\n\n    this._autoMoveDir = [];\n    let _terOffsetX = this._coordinateService.terOffsetX;\n    let _terOffsetY = this._coordinateService.terOffsetY;\n\n    clearInterval(this._autoMoveTimer);\n    this._autoMoveTimer = null;\n\n    if (this._autoMoveTimer && this._autoMoveDir.length > 0) {\n      return;\n    }\n    let _autoMovePadding = this.theme.autoFixCanvas.autoMovePadding;\n    if (x - _terOffsetX <= _autoMovePadding[3]) {\n      this._autoMoveDir.push('left');\n    }\n    if (this._rootWidth - (x - _terOffsetX) <= _autoMovePadding[1]) {\n      this._autoMoveDir.push('right');\n    }\n    if (y - _terOffsetY <= _autoMovePadding[0]) {\n      this._autoMoveDir.push('top');\n    }\n    if (this._rootHeight - (y - _terOffsetY) <= _autoMovePadding[2]) {\n      this._autoMoveDir.push('bottom');\n    }\n\n    if (this._autoMoveDir.length === 0) {\n      clearInterval(this._autoMoveTimer);\n      return;\n    }\n\n    if (!this._autoMoveTimer) {\n      let MOVE_GAP = 5;\n      this._autoMoveTimer = setInterval(() => {\n        if (this._autoMoveDir.includes('left')) {\n          this.move([this._moveData[0] + MOVE_GAP, this._moveData[1]]);\n          _moveTarget([-MOVE_GAP, 0]);\n        }\n        if (this._autoMoveDir.includes('right')) {\n          this.move([this._moveData[0] - MOVE_GAP, this._moveData[1]]);\n          _moveTarget([+MOVE_GAP, 0]);\n        }\n        if (this._autoMoveDir.includes('top')) {\n          this.move([this._moveData[0], this._moveData[1] + MOVE_GAP]);\n          _moveTarget([0, -MOVE_GAP]);\n        }\n        if (this._autoMoveDir.includes('bottom')) {\n          this.move([this._moveData[0], this._moveData[1] - MOVE_GAP]);\n          _moveTarget([0, +MOVE_GAP]);\n        }\n      }, 70);\n    }\n\n    // 同时需要移动target\n    let _moveTarget = (gap) => {\n      if (data.type === 'node:drag') {\n        data.nodes.forEach((item) => {\n          item.moveTo(item.left + gap[0], item.top + gap[1]);\n        })\n      } else if (data.type === 'group:drag') {\n        let group = data.group;\n        group.moveTo(group.left + gap[0], group.top + gap[1]);\n      }\n      cb && cb(gap);\n    }\n  }\n  _moveNode(node, x, y, isNotEventEmit) {\n    if (!isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:moveNodes',\n        data: {\n          node: node,\n          top: y,\n          left: x\n        }\n      });\n    }\n    node._moveTo(x, y);\n    this.edges.forEach((edge) => {\n      if (edge.type === 'endpoint') {\n        const isLink = _.find(node.endpoints, (point) => {\n          return (point.nodeId === edge.sourceNode.id && !!edge.sourceNode.getEndpoint(point.id, 'source')) || (point.nodeId === edge.targetNode.id && !!edge.targetNode.getEndpoint(point.id, 'target'));\n        });\n        isLink && edge.redraw();\n      } else if (edge.type === 'node') {\n        const isLink = edge.sourceNode.id === node.id || edge.targetNode.id === node.id;\n        isLink && edge.redraw();\n      }\n    });\n  }\n  _moveGroup(group, x, y, isNotEventEmit) {\n    if (!isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:moveGroups',\n        data: {\n          group: group,\n          top: y,\n          left: x\n        }\n      });\n    }\n    group._moveTo(x, y);\n    this.edges.forEach((edge) => {\n      let hasUpdate = _.get(edge, 'sourceNode.group') === group.id ||\n        _.get(edge, 'targetNode.group') === group.id ||\n        (_.get(edge, '_sourceType') === 'group' && _.get(edge, 'sourceNode.id') === group.id) ||\n        (_.get(edge, '_targetType') === 'group' && _.get(edge, 'targetNode.id') === group.id);\n\n      hasUpdate && (edge.redraw());\n    });\n  }\n  _autoLayout(data) {\n    const width = this._rootWidth;\n    const height = this._rootHeight;\n\n    if (_.isFunction(this.layout)) {\n      this.layout({\n        width: width,\n        height: height,\n        data: data\n      });\n    } else {\n      // 重力布局\n      if (_.get(this.layout, 'type') === 'forceLayout') {\n        const _opts = $.extend({\n          // 布局画布总宽度\n          width,\n          // 布局画布总长度\n          height,\n          // 布局相对中心点\n          center: {\n            x: width / 2,\n            y: height / 2\n          },\n          // 节点互斥力，像电荷原理一样\n          chargeStrength: -150,\n          link: {\n            // 以node的什么字段为寻找id，跟d3原理一样\n            id: 'id',\n            // 线条的距离\n            distance: 200,\n            // 线条的粗细\n            strength: 1\n          }\n        }, _.get(this.layout, 'options'), true);\n\n        // 自动布局\n        if (_.get(this.layout, 'type') === 'forceLayout') {\n          Layout.forceLayout({\n            opts: _opts,\n            data: {\n              groups: data.groups,\n              nodes: data.nodes,\n              // 加工线条数据，兼容endpoint为id的属性，d3没这个概念\n              edges: data.edges.map(item => ({\n                source: item.type === 'endpoint' ? item.sourceNode : item.source,\n                target: item.type === 'endpoint' ? item.targetNode : item.target\n              }))\n            }\n          });\n        }\n      } else if (_.get(this.layout, 'type') === 'drageLayout') {\n        Layout.drageLayout({\n          //  /** layout 方向, 可选 TB, BT, LR, RL */\n          // public rankdir: 'TB' | 'BT' | 'LR' | 'RL' = 'TB';\n          rankdir: _.get(this.layout, 'options.rankdir') || 'TB',\n          // /** 节点对齐方式，可选 UL, UR, DL, DR */\n          // public align: undefined | 'UL' | 'UR' | 'DL' | 'DR';\n          align: _.get(this.layout, 'options.align'),\n          // /** 节点大小 */\n          // public nodeSize: number | number[] | undefined;\n          nodeSize: _.get(this.layout, 'options.nodeSize'),\n          // /** 节点水平间距(px) */\n          // public nodesepFunc: ((d?: any) => number) | undefined;\n          nodesepFunc: _.get(this.layout, 'options.nodesepFunc'),\n          // /** 每一层节点之间间距 */\n          // public ranksepFunc: ((d?: any) => number) | undefined;\n          ranksepFunc: _.get(this.layout, 'options.ranksepFunc'),\n          // /** 节点水平间距(px) */\n          // public nodesep: number = 50;\n          nodesep: _.get(this.layout, 'options.nodesep') || 50,\n          // /** 每一层节点之间间距 */\n          // public ranksep: number = 50;\n          ranksep: _.get(this.layout, 'options.ranksep') || 50,\n          // /** 是否保留布局连线的控制点 */\n          // public controlPoints: boolean = false;\n          controlPoints: _.get(this.layout, 'options.controlPoints') || false,\n          data: {\n            // groups: data.groups,\n            nodes: data.nodes,\n            edges: data.edges.map(item => ({\n              source: item.type === 'endpoint' ? item.sourceNode : item.source,\n              target: item.type === 'endpoint' ? item.targetNode : item.target\n            }))\n          }\n        })\n      } else if (_.get(this.layout, 'type') === 'concentricLayout') {\n        Layout.concentLayout({\n          /** 布局中心 默认值：图的中心 */\n          // public center: [number, number];\n          center: _.get(this.layout, 'options.center') || [width / 2, height / 2],\n          // /** 节点大小（直径）。用于防止节点重叠时的碰撞检测 */\n          // public nodeSize: number | [number, number] = 30;\n          nodeSize: _.get(this.layout, 'options.nodeSize') || 30,\n          // /** 环与环之间最小间距，用于调整半径 */\n          // public minNodeSpacing: number = 10;\n          minNodeSpacing: _.get(this.layout, 'options.minNodeSpacing') || 10,\n          // /** 是否防止重叠，必须配合上面属性 nodeSize，只有设置了与当前图节点大小相同的 nodeSize 值，才能够进行节点重叠的碰撞检测 */\n          // public preventOverlap: boolean = false;\n          preventOverlap: _.get(this.layout, 'options.preventOverlap') || false,\n          // /** 第一个节点与最后一个节点之间的弧度差。若为 undefined ，则将会被设置为  2 _ Math.PI _ (1 - 1 / |level.nodes|) ，其中 level.nodes 为该算法计算出的每一层的节点，|level.nodes| 代表该层节点数量 */\n          // public sweep: number | undefined;\n          sweep: _.get(this.layout, 'options.sweep'),\n          // /** 环与环之间的距离是否相等 */\n          // public equidistant: boolean = false;\n          equidistant: _.get(this.layout, 'options.equidistant') || false,\n          // /** 开始方式节点的弧度 */\n          // public startAngle: number = (3 / 2) * Math.PI;\n          startAngle: (3 / 2) * Math.PI,\n          // /** 是否按照顺时针排列 */\n          // public clockwise: boolean = true;\n          clockwise: _.get(this.layout, 'options.clockwise') || true,\n          // /** 每一层同心值的求和。若为 undefined，则将会被设置为 maxValue / 4 ，其中 maxValue 为最大的排序依据的属性值。例如，若 sortBy 为 'degree'，则 maxValue 为所有节点中度数最大的节点的度数 */\n          //public maxLevelDiff: undefined | number;\n          maxLevelDiff: _.get(this.layout, 'options.maxLevelDiff'),\n          // /** 指定排序的依据（节点属性名），数值越高则该节点被放置得越中心。若为 undefined，则会计算节点的度数，度数越高，节点将被放置得越中心 */\n          // public sortBy: string = 'degree';\n          sortBy: _.get(this.layout, 'options.sortBy') || 'degree',\n          // 布局画布总宽度\n          width: width,\n          // 布局画布总长度\n          height: height,\n          data: {\n            groups: data.groups,\n            nodes: data.nodes,\n            edges: data.edges.map(item => ({\n              source: item.type === 'endpoint' ? item.sourceNode : item.source,\n              target: item.type === 'endpoint' ? item.targetNode : item.target\n            }))\n          }\n        });\n      } else if (_.get(this.layout, 'type') === 'circleLayout') {\n        Layout.circleLayout({\n          radius: _.get(this.layout, 'options.radius'),\n          getWidth: _.get(this.layout, 'options.getWidth'),\n          getHeight: _.get(this.layout, 'options.getHeight'),\n          data: {\n            nodes: data.nodes,\n            edges: data.edges.map(item => ({\n              source: item.type === 'endpoint' ? item.sourceNode : item.source,\n              target: item.type === 'endpoint' ? item.targetNode : item.target\n            }))\n          }\n        });\n      } else if(_.get(this.layout, 'type') === 'gridLayout') {\n        const _opts = $.extend({\n          // 布局画布总宽度\n          width: 150,\n          // 布局画布总长度\n          height: 100,\n          // 布局相对起始点\n          begin: [0, 0],\n          preventOverlap: true,\n          preventOverlapPadding: 10,\n          condense: false,\n          //宽高\n          rows: undefined,\n          cols: undefined,\n          //位置\n          position: undefined,\n          // 排序方式\n          sortBy: 'degree',\n          nodeSize: 30,\n          link: {\n            // 以node的什么字段为寻找id，跟d3原理一样\n            id: 'id',\n            // 线条的距离\n            distance: 100,\n            // 线条的粗细\n            strength: 1\n          }\n        }, _.get(this.layout, 'options'), true);\n        // 自动布局\n        if (_.get(this.layout, 'type') === 'gridLayout') {\n\n          Layout.gridLayout({\n            opts: _opts,\n            data: {\n              groups: data.groups,\n              nodes: data.nodes,\n              // 加工线条数据，兼容endpoint为id的属性，d3没这个概念\n              edges: data.edges.map(item => ({\n                source: item.type === 'endpoint' ? item.sourceNode : item.source,\n                target: item.type === 'endpoint' ? item.targetNode : item.target\n              }))\n            }\n          })\n        }\n      } else if(_.get(this.layout, 'type') === 'fruchterman') {\n        const _opts = $.extend({\n           // 布局画布总宽度\n           width,\n           // 布局画布总长度\n           height,\n            /** 停止迭代的最大迭代数 */\n          maxIteration: 1000,\n            /** 布局中心 */\n          center: [width / 2, height / 2],\n            /** 重力大小，影响图的紧凑程度 */\n          gravity: 5,\n          /** 速度 */\n          speed: 5,\n           /** 是否产生聚类力 */\n          clustering: false,\n           /** 聚类力大小 */\n          clusterGravity: 10,\n          link: {\n            // 以node的什么字段为寻找id，跟d3原理一样\n            id: 'id',\n            // 线条的距离\n            distance: 100,\n            // 线条的粗细\n            strength: 1\n          }\n        }, _.get(this.layout, 'options'), true);\n        // 自动布局\n        if (_.get(this.layout, 'type') === 'fruchterman') {\n\n          Layout.fruchterman({\n            opts: _opts,\n            data: {\n              groups: data.groups,\n              nodes: data.nodes,\n              // 加工线条数据，兼容endpoint为id的属性，d3没这个概念\n              edges: data.edges.map(item => ({\n                source: item.type === 'endpoint' ? item.sourceNode : item.source,\n                target: item.type === 'endpoint' ? item.targetNode : item.target\n              }))\n            }\n          })\n        }\n      }\n    }\n  }\n  _selectMultiplyItem(range, toDirection) {\n\n    // 确认一下终端的偏移值\n    const startX = this._coordinateService._terminal2canvas('x', range[0]);\n    const startY = this._coordinateService._terminal2canvas('y', range[1]);\n    const endX = this._coordinateService._terminal2canvas('x', range[2]);\n    const endY = this._coordinateService._terminal2canvas('y', range[3]);\n\n    const includeNode = _.includes(this.selecContents, 'node');\n    const includeEdge = _.includes(this.selecContents, 'edge');\n    const includeEndpoint = _.includes(this.selecContents, 'endpoint');\n\n    let _isSelected = (option) => {\n      let _itemLeft = option.left;\n      let _itemRight = option.right;\n      let _itemTop = option.top;\n      let _itemBottom = option.bottom;\n      if (this.selecMode === 'include' || (this.selecMode === 'senior' && toDirection === 'right')) {\n        return startX < _itemLeft && endX > _itemRight && startY < _itemTop && endY > _itemBottom;\n      }\n      if (this.selecMode === 'touch' || (this.selecMode === 'senior' && toDirection === 'left')) {\n        let result = true;\n        if (endX < _itemLeft) {\n          result = false;\n        }\n        if (startX > _itemRight) {\n          result = false;\n        }\n        if (endY < _itemTop) {\n          result = false;\n        }\n        if (startY > _itemBottom) {\n          result = false;\n        }\n        return result;\n      }\n    }\n\n    // 框选节点\n    if (includeNode) {\n      this.nodes.forEach((item) => {\n        let nodeLeft = item.left;\n        let nodeRight = item.left + $(item.dom).width();\n        let nodeTop = item.top;\n        let nodeBottom = item.top + $(item.dom).height();\n        if (item.group) {\n          let _group = this.getGroup(item.group);\n          nodeLeft += _group.left;\n          nodeRight += _group.left;\n          nodeTop += _group.top;\n          nodeBottom += _group.top;\n        }\n        let isSelected = _isSelected({\n          left: nodeLeft,\n          right: nodeRight,\n          top: nodeTop,\n          bottom: nodeBottom\n        });\n        if (isSelected) {\n          this.selectItem.nodes.push(item);\n        }\n      });\n    }\n\n    // 框选锚点\n    if (includeEndpoint) {\n      this.nodes.forEach((node) => {\n        node.endpoints.forEach((item) => {\n          const pointLeft = item._posLeft;\n          const pointRight = item._posLeft + $(item.dom).width();\n          const pointTop = item._posTop;\n          const pointBottom = item._posTop + $(item.dom).height();\n          let isSelected = _isSelected({\n            left: pointLeft,\n            right: pointRight,\n            top: pointTop,\n            bottom: pointBottom\n          });\n          if (isSelected) {\n            this.selectItem.endpoints.push(item);\n          }\n        });\n      });\n    }\n\n    // 框选线条\n    if (includeEdge) {\n      this.edges.forEach((item) => {\n        if (item.type === 'endpoint') {\n          const left = item.sourceEndpoint._posLeft < item.targetEndpoint._posLeft ? item.sourceEndpoint._posLeft : item.targetEndpoint._posLeft;\n          const right = (item.sourceEndpoint._posLeft + item.sourceEndpoint._width) > (item.targetEndpoint._posLeft + item.targetEndpoint._width) ? (item.sourceEndpoint._posLeft + item.sourceEndpoint._width) : (item.targetEndpoint._posLeft + item.targetEndpoint._width);\n          const top = item.sourceEndpoint._posTop < item.targetEndpoint._posTop ? item.sourceEndpoint._posTop : item.targetEndpoint._posTop;\n          const bottom = (item.sourceEndpoint._posTop + item.sourceEndpoint._height) > (item.targetEndpoint._posTop + item.targetEndpoint._height) ? (item.sourceEndpoint._posTop + item.sourceEndpoint._height) : (item.targetEndpoint._posTop + item.targetEndpoint._height);\n          let isSelected = _isSelected({\n            left: left,\n            right: right,\n            top: top,\n            bottom: bottom\n          });\n          if (isSelected) {\n            this.selectItem.edges.push(item);\n          }\n        } else if (item.type === 'node') {\n          // 后续补\n        }\n      });\n    }\n\n    // 框选节点组，准备支持\n\n    return this.selectItem;\n  }\n  _getAllEndpoints() {\n    let points = [];\n    points = points.concat(this.nodes.map((_node) => {\n      return _node.endpoints;\n    }));\n    points = points.concat(this.groups.map((_node) => {\n      return _node.endpoints;\n    }));\n    points = points.filter((item) => {\n      return !!item;\n    });\n    return _.flatten(points);\n  }\n  undo() {\n    let result = [];\n    if (this.actionQueueIndex <= -1) {\n      console.warn('回退堆栈已空，无法再undo');\n      return;\n    }\n    let step = this.actionQueue[this.actionQueueIndex--];\n    if (step.type === '_system:dragNodeEnd') {\n      step = this.actionQueue[this.actionQueueIndex--];\n    }\n    result.push(step);\n    if (step.type === 'system:addNodes') {\n      this.removeNodes(step.data, false, true);\n    } else if (step.type === 'system:removeNodes') {\n      this.addNodes(step.data.nodes, true);\n      this.addEdges(step.data.edges, true);\n    } else if (step.type === 'system:addEdges') {\n      this.removeEdges(step.data, true, true);\n    } else if (step.type === 'system:removeEdges') {\n      this.addEdges(step.data, true);\n    } else if (step.type === 'system:moveNodes') {\n      for (let key in step.data.nodes) {\n        let _nodeInfo = step.data.nodes[key];\n        let _node = this.getNode(key);\n        _node.moveTo(_nodeInfo.fromLeft, _nodeInfo.fromTop, true);\n      }\n    } else if (step.type === 'system:moveGroups') {\n      for (let key in step.data.groups) {\n        let _groupInfo = step.data.groups[key];\n        let _group = this.getGroup(key);\n        _group.moveTo(_groupInfo.fromLeft, _groupInfo.fromTop, true);\n      }\n    } else if (step.type === 'system:addGroups') {\n      step.data.forEach((item) => {\n        if (item.nodes.length > 0) {\n          this.removeNodes(item.nodes);\n        }\n        this.removeGroup(item.group.id, true);\n      });\n    } else if (step.type === 'system:removeGroup') {\n      this.addGroup(step.data.group, step.data.nodes || [], undefined, true);\n    } else if (step.type === 'system:groupAddMembers') {\n      let sourceGroup = step.data.sourceGroup;\n      let targetGroup = step.data.targetGroup;\n\n      if (targetGroup) {\n        targetGroup.removeNodes(step.data.nodes, true);\n      }\n\n      if (sourceGroup) {\n        sourceGroup.addNodes(step.data.nodes, true);\n      }\n\n      let _preStep = {};\n      if (step.data._isDraging) {\n        _preStep = this.actionQueue[this.actionQueueIndex];\n        if (_preStep.type === 'system:moveNodes') {\n          for (let key in _preStep.data.nodes) {\n            let _nodeInfo = _preStep.data.nodes[key];\n            let _node = this.getNode(key);\n            _node.moveTo(_nodeInfo.fromLeft, _nodeInfo.fromTop, true);\n          }\n          result.unshift(_preStep);\n        }\n      }\n\n      this.actionQueueIndex--;\n\n    } else if (step.type === 'system:groupRemoveMembers') {\n\n      let group = step.data.group;\n\n      if (group) {\n        group.addNodes(step.data.nodes, true);\n      }\n\n      let _preStep = {};\n      if (step.data._isDraging) {\n        _preStep = this.actionQueue[this.actionQueueIndex];\n        if (_preStep.type === 'system:moveNodes') {\n          for (let key in _preStep.data.nodes) {\n            let _nodeInfo = _preStep.data.nodes[key];\n            let _node = this.getNode(key);\n            _node.moveTo(_nodeInfo.fromLeft, _nodeInfo.fromTop, true);\n          }\n          result.unshift(_preStep);\n          this.actionQueueIndex--;\n        }\n      }\n\n      this.actionQueueIndex--;\n    } else if (step.type === 'system:reconnectEdges') {\n\n      _.get(step, 'data.info', []).forEach((info) => {\n        let targetNode = this.getNode(info.preTargetNodeId);\n        let targetEndpoint = targetNode.getEndpoint(info.preTargetPointId);\n        info.edge._create({\n          id: `${info.edge.sourceEndpoint.id}-${targetEndpoint.id}`,\n          targetNode: targetNode,\n          _targetType: targetEndpoint.nodeType,\n          targetEndpoint: targetEndpoint,\n          type: 'endpoint'\n        })\n      });\n    }\n\n    this.emit('system.canvas.undo', {\n      steps: result\n    });\n    this.emit('events', {\n      type: 'canvas.undo',\n      steps: result\n    });\n  }\n  redo() {\n    let result = [];\n    if (this.actionQueueIndex >= this.actionQueue.length - 1) {\n      console.warn('重做堆栈已到顶，无法再redo');\n      return;\n    }\n    let step = this.actionQueue[++this.actionQueueIndex];\n    result.push(step);\n    if (step.type === 'system:moveNodes' && step.data._isDraging) {\n      step = this.actionQueue[++this.actionQueueIndex];\n      result.push(step);\n    }\n    if (step.type === 'system:addNodes') {\n      this.addNodes(step.data, true);\n    } else if (step.type === 'system:removeNodes') {\n      this.removeNodes(step.data.nodes, false, true);\n    } else if (step.type === 'system:addEdges') {\n      this.addEdges(step.data, true);\n    } else if (step.type === 'system:removeEdges') {\n      this.removeEdges(step.data, true);\n    } else if (step.type === 'system:moveNodes') {\n      for (let key in step.data.nodes) {\n        let _nodeInfo = step.data.nodes[key];\n        let _node = this.getNode(key);\n        _node.moveTo(_nodeInfo.toLeft, _nodeInfo.toTop, true);\n      }\n    } else if (step.type === 'system:moveGroups') {\n      for (let key in step.data.groups) {\n        let _groupInfo = step.data.groups[key];\n        let _group = this.getGroup(key);\n        _group.moveTo(_groupInfo.toLeft, _groupInfo.toTop, true);\n      }\n    } else if (step.type === 'system:addGroups') {\n      step.data.forEach((item) => {\n        this.addGroup(item.group, item.nodes || [], undefined, true);\n      })\n    } else if (step.type === 'system:removeGroup') {\n      this.removeGroup(step.data.group, true);\n    } else if (step.type === 'system:groupAddMembers') {\n      let sourceGroup = step.data.sourceGroup;\n      let targetGroup = step.data.targetGroup;\n\n      let _preStep = this.actionQueue[this.actionQueueIndex - 1];\n\n      if (_preStep.type === 'system:moveNodes' && _preStep.data._isDraging) {\n        for (let key in _preStep.data.nodes) {\n          let _nodeInfo = _preStep.data.nodes[key];\n          let _node = this.getNode(key);\n          _node.moveTo(_nodeInfo.toLeft, _nodeInfo.toTop, true);\n        }\n      }\n\n      if (targetGroup) {\n        targetGroup.addNodes(step.data.nodes, true);\n      }\n\n      if (sourceGroup) {\n        sourceGroup.removeNodes(step.data.nodes, true);\n      }\n\n    } else if (step.type === 'system:groupRemoveMembers') {\n      let group = step.data.group;\n\n      if (group) {\n        group.removeNodes(step.data.nodes, true);\n      }\n\n      let _preStep = {};\n      if (step.data._isDraging) {\n        _preStep = this.actionQueue[this.actionQueueIndex];\n        if (_preStep.type === 'system:moveNodes') {\n          for (let key in _preStep.data.nodes) {\n            let _nodeInfo = _preStep.data.nodes[key];\n            let _node = this.getNode(key);\n            _node.moveTo(_nodeInfo.fromLeft, _nodeInfo.fromTop, true);\n          }\n          this.actionQueueIndex--;\n        }\n      }\n    } else if (step.type === 'system:reconnectEdges') {\n      _.get(step, 'data.info', []).forEach((info) => {\n        let targetNode = this.getNode(info.currentTargetNodeId);\n        let targetEndpoint = targetNode.getEndpoint(info.currentTargetPointId);\n        info.edge._create({\n          id: `${info.edge.sourceEndpoint.id}-${targetEndpoint.id}`,\n          targetNode: targetNode,\n          _targetType: targetEndpoint.nodeType,\n          targetEndpoint: targetEndpoint,\n          type: 'endpoint'\n        })\n      });\n    }\n\n    this.emit('system.canvas.redo', {\n      steps: result\n    });\n    this.emit('events', {\n      type: 'canvas.redo',\n      steps: result\n    });\n\n    if (_.get(this.actionQueue, [this.actionQueueIndex + 1, 'type']) === '_system:dragNodeEnd') {\n      this.actionQueueIndex++;\n    }\n  }\n  isActionQueueTop() {\n    return this.actionQueueIndex >= this.actionQueue.length - 1;\n  }\n  isActionQueueBottom() {\n    return this.actionQueueIndex <= -1;\n  }\n  pushActionQueue(option) {\n\n    let step = option;\n    //移动节点需要合并堆栈\n    if (option.type === 'system:moveNodes' || option.type === 'system:moveGroups') {\n\n      let _type = {\n        'system:moveNodes': 'node',\n        'system:moveGroups': 'group'\n      }[option.type];\n      let _types = _type + 's';\n\n      // 堆栈前一个不是moveNode\n      let currentStep = this.actionQueue[this.actionQueueIndex] || {};\n      if (currentStep.type === option.type && currentStep.data[_types][option.data[_type].id]) {\n        currentStep.data[_types][option.data[_type].id]['toTop'] = option.data.top;\n        currentStep.data[_types][option.data[_type].id]['toLeft'] = option.data.left;\n        return;\n      } else {\n        let moveItems = [option.data[_type]];\n        const unionKeys = this._findUnion(_types, option.data[_type]);\n        if (unionKeys && unionKeys.length > 0) {\n          unionKeys.forEach((key) => {\n            moveItems = moveItems.concat(this._unionData[key][_types]);\n          });\n          moveItems = _.uniqBy(moveItems, 'id');\n        }\n\n        step = {\n          type: option.type,\n          data: {\n            [_types]: {}\n          }\n        };\n\n        moveItems.forEach((item) => {\n          step.data[_types][item.id] = {\n            fromTop: item.top,\n            fromLeft: item.left,\n            toTop: item.top,\n            toLeft: item.left\n          }\n        });\n        step.data[_types][option.data[_type].id]['toTop'] = option.data.top;\n        step.data[_types][option.data[_type].id]['toLeft'] = option.data.left;\n      }\n    }\n\n    // 堆栈满了，清理\n    if (this.actionQueueIndex >= this.global.limitQueueLen) {\n      this.actionQueue.shift();\n      this.actionQueueIndex--;\n    }\n    // 把index前的步骤覆盖掉\n    this.actionQueue.splice(this.actionQueueIndex + 1, this.actionQueue.length); // todo可能有问题\n    this.actionQueue.push(step);\n    this.actionQueueIndex++;\n\n    if (_.get(this.actionQueue, [this.actionQueueIndex - 1, 'type']) === '_system:dragNodeEnd') {\n      this.actionQueue.splice(this.actionQueueIndex - 1, 1);\n      this.actionQueueIndex--;\n    }\n  }\n  popActionQueue() {\n    if (this.actionQueue.length > 0) {\n      let action = this.actionQueue.pop();\n      return action;\n    } else {\n      console.warn('操作队列已为空，请确认');\n    }\n  }\n  clearActionQueue() {\n    this.actionQueue = [];\n    this.actionQueueIndex = -1;\n  }\n}\n\nexport default BaseCanvas;\n","'use strict';\n\nimport Node from './baseNode';\n\nclass TreeNode extends Node {\n  constructor(options) {\n    super(options);\n    this.children = options.children;\n    this.parent = options.parent;\n    this.collapsed = options.collapsed || false;\n    if (options.isRoot) {\n      this.isRoot = options.isRoot;\n    }\n  }\n  collapse() {\n    this._emit('InnerEvents', {\n      type: 'node:collapse',\n      nodeId: this.id\n    });\n    this.collapsed = true;\n  }\n  expand(nodes = []) {\n    this._emit('InnerEvents', {\n      type: 'node:expand',\n      nodeId: this.id,\n      nodes: nodes\n    });\n    delete this.collapsed;\n  }\n  detectLeaf() {\n    return !!!(this.children && this.children.length > 0);\n  }\n  detectRoot() {\n    return this.isRoot;\n  }\n}\n\nexport default TreeNode;","const Hierarchy = require('@antv/hierarchy');\n\nfunction tranlateData(data) {\n  let queue = [data];\n  let nodeList = [];\n  while (queue.length > 0) {\n    let node = queue.pop();\n    let newNode = node.data;\n    newNode.left = node.x;\n    newNode.top = node.y;\n    newNode.treePos = {\n      hgap: node.hgap,\n      vgap: node.vgap,\n      x: node.x,\n      y: node.y,\n      depth: node.depth,\n      side: node.side\n    };\n    nodeList.push(newNode);\n    queue = queue.concat(node.children);\n  }\n  return nodeList[0];\n}\n\nexport default {\n  compactBox: (data, options) => {\n    return tranlateData(Hierarchy.compactBox(data, options));\n  },\n  dendrogram: (data, options) => {\n    return tranlateData(Hierarchy.dendrogram(data, options));\n  },\n  indented: (data, options) => {\n    return tranlateData(Hierarchy.indented(data, options));\n  },\n  mindmap: (data, options) => {\n    return tranlateData(Hierarchy.mindmap(data, options));\n  }\n};\n","'use strict';\n\nimport Canvas from \"./baseCanvas\";\nconst _ = require('lodash');\nimport TreeNode from '../node/treeNode';\nimport Hierarchy from '../utils/layout/hierarchy';\n\nclass TreeCanvas extends Canvas {\n  constructor(options) {\n    super(options);\n    this._NodeClass = TreeNode;\n  }\n  _handleTreeNodes(data, isFlat) {\n    if (isFlat) {\n      return data;\n    } else {\n      let queue = [data];\n      let nodeList = [];\n      while (queue.length > 0) {\n        let node = queue.pop();\n        nodeList.push(node);\n        if (node.children && node.children.length > 0) {\n          node.children.forEach((child) => {\n            child.parent = node.id;\n          });\n          queue = queue.concat(node.children);\n        }\n      }\n      return nodeList;\n    }\n  }\n  _isExistNode(node) {\n    let result = super._isExistNode(node);\n    if (result && node.subCollapsed) {\n      result = false;\n    }\n    return;\n  }\n  _addEventListener() {\n    super._addEventListener();\n    this.on('InnerEvents', (data) => {\n      if (data.type === 'node:collapse') {\n        this.collapseNode(data.nodeId);\n      } else if (data.type == 'node:expand') {\n        this.expandNode(data.nodeId);\n      }\n    });\n  }\n  findSubTree(item) {\n    let queue = [item];\n    let result = [];\n    while (queue.length > 0) {\n      let _item = queue.pop();\n      result.push(_item);\n      if (_item.children?.length > 0) {\n        queue = queue.concat(_item.children);\n      }\n    }\n    return result;\n  }\n  collapseNode (nodeId) {\n    let collapseNodes = [];\n    let collapseEdges = [];\n    let targetNode = this.getNode(nodeId);\n    targetNode.collapsed = true;\n    targetNode.options.collapsed = true;\n    if (!targetNode) {\n      return;\n    }\n    let queue = [targetNode];\n    while (queue.length > 0) {\n      let node = queue.pop();\n      collapseNodes.push(node);\n      if (node.children && node.children.length > 0) {\n        queue = queue.concat(node.children);\n      }\n    }\n    // 先去掉target node做filter\n    collapseNodes = collapseNodes.filter((item) => {\n      return item.id !== targetNode.id;\n    });\n    let tmp = {};\n    collapseNodes.forEach((item) => {\n      tmp[item.id] = item;\n      item.subCollapsed = true;\n    });\n    collapseEdges = this.edges.filter((item) => {\n      let _isCollapsed = false;\n      if (item.type === 'endpoint') {\n        _isCollapsed = !!tmp[item.sourceNode.id] || !!tmp[item.targetNode.id]\n      } else {\n        _isCollapsed = !!tmp[item.source.id] || !!tmp[item.target.id];\n      }\n      if (item.sourceNode.id === targetNode.id) {\n        _isCollapsed = true;\n      }\n\n      if (_isCollapsed) {\n        item.collapsed = true;\n      }\n      return _isCollapsed;\n    });\n    collapseNodes.unshift(targetNode);\n\n    collapseNodes.forEach((item) => {\n      if (item.subCollapsed) {\n        item.destroy(true);\n      }\n\n      // 重置子节点的collapsed状态\n      if (item.id !== nodeId && item.collapsed) {\n        delete item.collapsed;\n      }\n    });\n    collapseEdges.forEach((item) => {\n      item.destroy(true);\n    });\n\n    this.redraw();\n\n    return {\n      nodes: collapseNodes,\n      edges: collapseEdges\n    }\n  }\n\n  expandNode(nodeId, nodes) {\n    let targetNode = this.getNode(nodeId);\n    let subNodes = [];\n    let collapseEdges = [];\n    let queue = [targetNode];\n    while (queue.length > 0) {\n      let node = queue.pop();\n      subNodes.push(node);\n      if (node.children && node.children.length > 0) {\n        queue = queue.concat(node.children);\n      }\n    }\n    // 先去掉target node做filter\n    subNodes = subNodes.filter((item) => {\n      return item.id !== targetNode.id;\n    });\n    let tmp = {};\n    subNodes.forEach((item) => {\n      tmp[item.id] = item;\n      item.subCollapsed = true;\n    });\n    collapseEdges = this.edges.filter((item) => {\n      let _isCollapsed = false;\n      if (item.type === 'endpoint') {\n        _isCollapsed = !!tmp[item.sourceNode.id] || !!tmp[item.targetNode.id]\n      } else {\n        _isCollapsed = !!tmp[item.source.id] || !!tmp[item.target.id];\n      }\n      if (item.sourceNode.id === targetNode.id) {\n        _isCollapsed = true;\n      }\n      return _isCollapsed;\n    });\n    this.nodes = _.differenceBy(this.nodes, subNodes, 'id');\n    this.addNodes(subNodes, true);\n    this.edges = _.filter(this.edges, (a) => {\n      if (a.type === 'endpoint') {\n        return !_.some(collapseEdges, ((b) => {\n          return a.sourceNode.id === b.sourceNode.id && a.targetNode.id === b.targetNode.id && a.source === b.source && a.target === b.target;\n        }));\n      } else {\n        return !_.some(collapseEdges, ((b) => {\n          return a.source === b.source && a.target === b.target;\n        }));\n      }\n    });\n    this.addEdges(collapseEdges, true);\n    subNodes.forEach((item) => {\n      delete item.subCollapsed;\n    });\n    delete targetNode.collapsed;\n    collapseEdges.forEach((item) => {\n      delete item.collapsed;\n    });\n    this.redraw();\n  }\n\n  redraw() {\n    let rootNode = this.getRootNode();\n    let tree = [];\n    let tmpTreeObj = {};\n    let queue = [rootNode];\n    while (queue.length > 0) {\n      let node = queue.pop();\n      let obj = {\n        id: node.id\n      };\n      if (tmpTreeObj[node.id]) {\n        obj = tmpTreeObj[node.id];\n      } else {\n        tmpTreeObj[obj.id] = obj;\n      }\n      if (node.isRoot) {\n        obj['isRoot'] = node.isRoot;\n      }\n      if (node.collapsed) {\n        obj['collapsed'] = node.collapsed;\n      }\n      tree.push(obj);\n      if (node.children && node.children.length > 0) {\n        obj.children = [];\n        node.children.forEach((child) => {\n          let _childObj = {\n            id: child.id\n          };\n          if (tmpTreeObj[child.id]) {\n            _childObj = tmpTreeObj[child.id];\n          } else {\n            tmpTreeObj[child.id] = _childObj;\n          }\n          if (child.isRoot) {\n            _childObj['isRoot'] = child.isRoot;\n          }\n          if (child.collapsed) {\n            _childObj['collapsed'] = child.collapsed;\n          }\n          obj.children.push(_childObj);\n        });\n        queue = queue.concat(node.children);\n      }\n    }\n    let nodes = tree.filter((item) => {\n      return true;\n    });\n    this._autoLayout({\n      nodes: nodes,\n      edges: [],\n      groups: []\n    });\n    this.nodes.forEach((item) => {\n      if (item.subCollapsed) {\n        return;\n      }\n      item?.endpoints?.forEach(endpoint => {\n        endpoint.updatePos();\n      });\n      let obj = tmpTreeObj[item.id];\n      if (item.top !== obj.top || item.left !== obj.left) {\n        item.options.top = obj.top;\n        item.options.left = obj.left;\n        item.options.treePos = obj.treePos;\n        item.moveTo(obj.left, obj.top);\n      }\n    });\n    this.edges.forEach((item) => {\n      item.redraw();\n    });\n  }\n  addNodes(data, isNotEventEmit) {\n    let nodes = super.addNodes(data, isNotEventEmit);\n    nodes.forEach((item) => {\n      if(item.parent) {\n        let parentNode = this.getNode(item.parent);\n        if (!_.some(parentNode.children, ['id', item.id])) {\n          !parentNode.children && (parentNode.children = []);\n          parentNode.children.push(item);\n        }\n      }\n    });\n    return nodes;\n  }\n  removeNodes(data, isNotDelEdge, isNotEventEmit) {\n\n    let nodes = data.map((item) => {\n      if (item instanceof Node) {\n        return item;\n      } else {\n        return this.getNode(item);\n      }\n    });\n\n    let rmNodes = [];\n\n    nodes.forEach((item) => {\n      let _subTree = this.findSubTree(item);\n      rmNodes = rmNodes.concat(_subTree);\n\n      // 如果是某个节点的子节点,将此节点从父节点的children中移除\n      if (item.parent) {\n        const parentNode = this.getNode(item.parent);\n\n        if (parentNode) {\n          parentNode.children = parentNode.children.filter((node) => node.id !== item.id);\n        }\n      }\n    });\n\n    rmNodes = _.unionBy(rmNodes, 'id');\n\n    let result = super.removeNodes(rmNodes, isNotDelEdge, isNotEventEmit);\n\n    return result;\n  }\n  getRootNode() {\n    return this.nodes.filter((item) => {\n      return item.isRoot;\n    })[0];\n  }\n  draw(opts, params, callback) {\n    const nodes = this._handleTreeNodes(opts.nodes || [], _.get(params, 'isFlatNode', false));\n    // 需要过滤掉collapsed的\n    super.draw({\n      nodes: nodes,\n      edges: opts.edges,\n      groups: opts.groups\n    }, () => {\n      let tmp = {};\n      this.nodes.forEach((item) => {\n        tmp[item.id] = item;\n        item.children = [];\n      });\n      this.nodes.forEach((item) => {\n        if (item.isRoot || !item.parent) {\n          return;\n        }\n        let parentNode = tmp[item.parent];\n        if (!parentNode) {\n          return;\n        }\n        !parentNode.children && (parentNode.children = []);\n        parentNode.children.unshift(item);\n      });\n      callback && callback({\n        nodes: this.nodes,\n        edges: this.edges,\n        groups: this.groups\n      });\n    });\n  }\n  // getDataMap(isFlat) {\n\n  // }\n  _autoLayout(options) {\n    let rootNode = options.nodes.filter((item) => {\n      return item.isRoot;\n    })[0];\n    if (!rootNode) {\n      return;\n    }\n\n    // 这部分需要优化\n    let type = _.get(this, 'layout.type', 'compactBox');\n    if (Hierarchy[type]) {\n      const NODE_SIZE = 16;\n      const NODE_WIDTH = 30;\n      const PEM = 5;\n      Hierarchy[type](rootNode, _.assign({\n        direction: 'H',\n        getId(d) {\n          return d.id;\n        },\n        getHeight(d) {\n          if (d.isRoot) {\n            return NODE_SIZE * 2;\n          }\n          return NODE_SIZE;\n        },\n        getWidth(d) {\n          if (d.isRoot) {\n            return NODE_WIDTH * 2;\n          }\n          return NODE_WIDTH;\n        },\n        getHGap(d) {\n          return 100;\n        },\n        getVGap(d) {\n          return 30;\n        },\n        getSubTreeSep(d) {\n          if (!d.children || !d.children.length) {\n            return 0;\n          }\n          return PEM;\n        }\n      }, _.get(this, 'layout.options', {})));\n    }\n  }\n}\n\nexport default TreeCanvas;","const $ = require('jquery');\n\nconst Default = {\n  TEMPLATE:\n    '<div class=\"butterfly-toolTip\" role=\"butterfly-tooltip\"><div class=\"butterfly-tooltip-arrow\"></div><div class=\"butterfly-tooltip-inner\"></div></div>',\n\n  $viewAppend: 'body',\n  $viewScale: '.butterfly-wrapper', // 有缩放的图层\n\n  $viewCon: '.butterfly-toolTip',\n  $inner: '.butterfly-tooltip-inner',\n  callbackWhitelist: ['LI'],\n\n  evntList: ['hover'],\n\n  callBackOpen: true,\n\n  delay: 300,\n};\n\nconst _toFixed_3 = (num) => {\n  if (!num) {\n    return 0;\n  }\n  if (Number(num)) {\n    return Number(parseFloat(num).toFixed(3));\n  }\n};\nconst _getTipOffset = (placement, pos) => {\n  const _pos = {};\n  let { left, top, width, height, actualWidth, actualHeight } = pos;\n  left = _toFixed_3(left);\n  top = _toFixed_3(top);\n  width = _toFixed_3(width);\n  height = _toFixed_3(height);\n  actualWidth = _toFixed_3(actualWidth);\n  actualHeight = _toFixed_3(actualHeight);\n\n  switch (placement) {\n    case 'top':\n      _pos.left = left + width / 2 - actualWidth / 2;\n      _pos.top = top - actualHeight;\n      break;\n    case 'left':\n      _pos.left = left - actualWidth;\n      _pos.top = top + height / 2 - actualHeight / 2;\n      break;\n    case 'right':\n      _pos.left = left + width;\n      _pos.top = top + height / 2 - actualHeight / 2;\n      break;\n    case 'bottom':\n      _pos.left = left + width / 2 - actualWidth / 2;\n      _pos.top = top + actualHeight;\n    default:\n      _pos.left = left + width / 2 - actualWidth / 2;\n      _pos.top = top - actualHeight;\n  }\n  return _pos;\n};\n\nconst show = (opts, dom, toolTipDom, callBackFunc, e) => {\n  $(opts.$viewCon).remove();\n\n  opts.callBackOpen &&\n    toolTipDom.on('click', (e) => {\n      if (callBackFunc) {\n        const res = { key:$(e.target).attr(\"key\"),value: e.target.textContent };\n        if (opts.callbackWhitelist.includes(e.target.nodeName)) {\n          $(opts.$viewCon).remove();\n          callBackFunc(res, e)\n        };\n      }\n      e.stopPropagation();\n    });\n\n  toolTipDom.appendTo($(opts.$viewAppend));\n  let placement = opts.placement || 'top';\n  toolTipDom.addClass(placement);\n\n  const scaleArr = ($(opts.$viewScale).css(\"transform\") || 'none').replace('matrix(', '').replace(')', '').split(',');\n  const scale = scaleArr[0] === 'none' ? 1 : scaleArr[0];\n\n  const pos = {\n    top: dom.offset().top,\n    left: dom.offset().left,\n    width: dom.outerWidth() * scale,\n    height: dom.outerHeight() * scale,\n    actualWidth: toolTipDom.outerWidth(),\n    actualHeight: toolTipDom.outerHeight(),\n  };\n\n  let posInit = {}\n  if (opts.x || opts.x === 0) {\n    posInit = {\n      left: opts.x,\n      top: opts.y\n    }\n  } else {\n    posInit = _getTipOffset(placement, pos);\n  }\n  const position = `top: ${posInit.top}px; left: ${posInit.left}px;`;\n  toolTipDom.attr('style', position).addClass('in');\n};\n\nconst hide = (toolTipDom) => {\n  toolTipDom.removeClass('in').remove();\n};\n\nfunction creatTips(option, dom, callBackFunc) {\n  const opts = { ...Default, ...option };\n\n  let toolTipDom = $(opts.TEMPLATE);\n  toolTipDom.find(opts.$inner).html(opts.content);\n\n  let _timeoutMouseover = null;\n\n  opts.evntList.includes('hover') &&\n    dom\n      .on('mouseover', (e) => {\n        clearTimeout(_timeoutMouseover);\n        _timeoutMouseover = setTimeout(() => {\n          show(opts, dom, toolTipDom, callBackFunc, e);\n        }, opts.delay);\n      })\n      .on('mouseout', (e) => {\n        clearTimeout(_timeoutMouseover);\n        !$(opts.$viewCon).hasClass('butterfly-active-tip') && hide(toolTipDom);\n      });\n  const clickOrSame = (e) => {\n    if ($(opts.$viewCon).hasClass('butterfly-active-tip')) {\n      $(opts.$viewCon).removeClass('butterfly-active-tip');\n      hide(toolTipDom);\n    } else {\n      toolTipDom.addClass('butterfly-active-tip');\n      show(opts, dom, toolTipDom, callBackFunc, e);\n    }\n  }\n  opts.evntList.includes('click') &&\n    dom.on('click', (e) => {\n      clickOrSame(e);\n    });\n\n  opts.evntList.includes('mousedown') && dom.mousedown((e) => {\n    $(dom).bind(\"contextmenu\", function (e) {\n      return false;\n    });\n    if (3 == e.which) {\n      clickOrSame(e);\n    }\n  });\n  opts.nowShow && show(opts, dom, toolTipDom, callBackFunc, '');\n\n  return dom;\n}\n\nfunction creatMenus(opts, dom, callBackFunc, menu = [], showTip = false) {\n  const menuDom = $('<div class=\"butterfly-tip-menu-div\"></div>');\n\n  const menuUl = $('<ul class=\"butterfly-tip-menu-ul\"></ul>');\n\n  (menu || []).forEach((item) => {\n    $('<li class=\"butterfly-tip-menu-li\"></li>')\n      .attr('key', `${item.key}`)\n      .text(item.value)\n      .appendTo(menuUl);\n  });\n\n  showTip && $(`<div class=\"butterfly-tip-menu-title\">${opts.content}</div>`).appendTo(menuDom);\n  menuUl.appendTo(menuDom);\n\n  opts.placement = opts.placement || 'right';\n  opts.content = menuDom;\n  opts.evntList = opts.evntList || [];\n\n  opts.nowShow = opts.nowShow || true;\n\n  return creatTips(opts, dom, callBackFunc);\n}\n\nexport default {\n  creatTips,\n  creatMenus,\n};\n","'use strict';\n\nconst _ = require('lodash');\n\nimport Canvas from './src/canvas/baseCanvas';\nimport TreeCanvas from './src/canvas/treeCanvas';\nimport Edge from './src/edge/baseEdge';\nimport Endpoint from './src/endpoint/baseEndpoint';\nimport Group from './src/group/baseGroup';\nimport Node from './src/node/baseNode';\nimport TreeNode from './src/node/treeNode';\nimport Minimap from './src/utils/minimap';\nimport Tips from './src/utils/toolTip';\nimport Layout from './src/utils/layout/layout';\nimport './src/index.less';\n\nmodule.exports = {\n  Canvas,\n  TreeCanvas,\n  Edge,\n  Endpoint,\n  Group,\n  Node,\n  TreeNode,\n  Minimap,\n  Tips,\n  Layout\n};\n"],"names":["EventEmit3","require","Canvas","Node","Endpoint","$","_","BaseEndpoint","opts","id","options","orientation","pos","type","nodeType","get","nodeId","root","scope","expandArea","limitNum","__type","_node","_global","_on","_emit","_top","_left","_posTop","_posLeft","_width","_height","_linkable","_coordinateService","dom","_isInitedDom","obj","draw","width","height","_terminal2canvas","offset","left","top","attachEvent","_dom","attr","_currentNode","_currentDom","_currentNodeType","nodeW","outerWidth","nodeH","outerHeight","targetDom","targetDomW","targetDomH","find","eOffsetX","eOffsetY","_offsetTop","_offsetLeft","_orientation","_pos","result","_ox","_oy","_px","_py","nodeDomOffsets","targetDomOffsets","_group","css","updated","x","y","addClass","removeClass","on","e","LEFT_KEY","button","preventDefault","stopPropagation","emit","data","isNotEvent","off","remove","removeAllListeners","detach","BaseNode","group","draggable","endpoints","_endpointsData","_endpointLimitNum","_isMoving","node","undefined","isInited","EndpointClass","Class","endpoint","assign","_limitNum","global","push","pointId","rmEndpointIndex","findIndex","point","rmEndpoint","splice","destroy","_isInited","_isDeleteGroup","_addEventListener","forEach","item","moveTo","isNotEventEmit","addEndpoint","map","includes","target","nodeName","setDraggable","MINDIST","TOL","TOLxTOL","LEFT","RIGHT","TOP","BOTTOM","Point","drawBezier","sourcePoint","targetPoint","_calcOrientation","Math","abs","_sx","_sy","_tx","_ty","_so","_to","sourceCtrlPoint","_findControlPoint","targetCtrlPoint","offsetX","offsetY","concat","join","drawAdvancedBezier","dist","sqrt","percent","minorDist","so_offsetX","so_offsetY","to_offsetX","to_offsetY","drawStraight","drawFlow","orientationLimit","stub","midpoint","w","h","sx","sy","tx","ty","so","to","oProduct","sourceAxis","startStubX","startStubY","endStubX","endStubY","isXGreaterThanStubTimes2","isYGreaterThanStubTimes2","anchorOrientation","_commonStubCalculator","stubCalculators","perpendicular","orthogonal","opposite","axis","idx","areInProximity","lastx","lasty","segments","_sgn","n","_addSegment","lx","ly","o","sgnx","sgny","stubs","oidx","ss","oss","es","oes","midx","midy","orientations","_lineCalculators","sis","midLines","linesToEnd","startToEnd","startToMidToEnd","otherStubs","soIdx","toIdx","otherFlipped","stub1","stub2","segmentIndexes","_quadrant","p1","p2","segment","startStub","otherStartStub","endStub","otherEndStub","extent","min","max","comparator","p","i","length","_drawFlowSegment","drawManhattan","pointArr","fromPt","toPt","_route","path","reduce","current","next","lw","_drawStraight","d","x1","y1","x2","y2","cloneDeep","dx","dy","_line","beginX","beginY","endX","endY","_calcWithLimit","rank","isInLimit","some","limit","posX","posY","k","majorAnchor","minorAnchor","conn","fromDir","toDir","xDiff","yDiff","dir","arrow","default1","calcSlope","shapeType","arrowPosition","coordinates","split","p0","getPointAtLength","getTotalLength","_initTime","Date","getTime","init","_svg","addAnimate","animateDom","_animateDom","circle","motion","document","createElementNS","append","_isContinue","_startTime","setAttribute","radius","color","dur","repeatCount","setTimeout","parseFloat","parseInt","insertAfter","Edge","BaseEdge","targetNode","_targetType","targetEndpoint","sourceNode","_sourceType","sourceEndpoint","label","arrowOffset","isExpandWidth","defaultAnimate","labelDom","arrowDom","eventHandlerDom","_path","_isDeletingEdge","_labelWidth","_labelHeight","_updateTimer","_UPDATE_INTERVAL","drawLabel","drawArrow","calcPath","DrawUtil","pathLength","centerPoint","offsetWidth","offsetHeight","isDom","HTMLElement","createElement","className","innerText","arrowFinalPosition","ArrowUtil","vector","deg","atan2","PI","_calcPath","redrawLabel","redrawArrow","redrawAnimate","LinkAnimateUtil","num","edge","set","redraw","Group","scope1","scope2","isScopeStrict","_scope1","filter","_scope2","totalScope","uniqScope","uniq","BaseGroup","resize","nodes","_container","titleDom","text","setResize","ScopeCompare","console","log","addNodes","rmNodes","targetGroup","removeNodes","flat","container","resizeDom","mouseDown","event","icon","appendTo","updatePos","isChildNodeMoving","indexOf","circleLayout","params","_isCircle","_preAngle","_halfWidth","getWidth","_halfHeight","getHeight","index","radian","angle","sin","cos","_textTop","_textLeft","posInfo","SPEED_DIVISOR","fruchterman","param","self","center","nodeMap","nodeIdxMap","isNumber","random","run","edges","maxIteration","window","innerWidth","innerHeight","maxDisplace","gravity","speed","clustering","clusterMap","cluster","name","cx","cy","count","c","key","displacements","j","applyCalculate","clusterGravity","distLength","gravityForce","limitedDist","calRepulsive","calAttractive","v","u","vecX","vecY","vecLengthSqr","sign","common","source","uIndex","vIndex","vecLength","module","gridLayout","layoutNodes","sortBy","isNaN","degree","values","getDegree","sort","n1","n2","oRows","rows","oCols","cols","columns","cells","ceil","splits","round","cellWidth","cellHeight","condense","preventOverlap","nodew","nodeh","size","nodeSize","preventOverlapPadding","cellUsed","row","col","id2manPos","rcPos","position","used","use","getPos","degrees","moveToNextCell","begin","forceLayout","groupNodes","groups","_edge","souceNode","simulation","d3","forceSimulation","force","chargeStrength","forceManyBody","strength","forceCenter","forceLink","link","distance","stop","alphaMin","alphaDecay","tick","concentLayout","minNodeSpacing","sweep","equidistant","startAngle","clockwise","maxLevelDiff","curnode","curedges","maxValueNode","maxNodeSize","isArray","isString","len","levels","currentLevel","diff","minDist","firstLvlHasMulti","maxR","rStep","r","level","dTheta","dcos","dsin","rMin","rDeltaMax","rr","rDelta","theta","drageLayout","rankdir","nodesepFunc","ranksepFunc","nodesep","ranksep","controlPoints","g","dagre","graphlib","Graph","nodeSizeFunc","horisep","getFunc","vertisep","verti","hori","setNode","setEdge","weight","setDefaultEdgeLabel","setGraph","layout","coord","it","_out","_in","_preds","_sucs","shape","points","slice","func","value","defaultValue","resultFunc","forceTreeLayout","forceX","forceY","treeLayout","Layout","SelectCanvas","cxt","getContext","canvasTop","canvasLeft","canvasHeight","canvasWidth","canScrollX","canScrollY","startX","startY","isDraw","isActive","addEventListener","bind","mouseUp","mouseMove","mouseLeave","evt","clientX","clientY","clearCanvas","toDirection","startLeft","startTop","endLeft","endTop","range","unActive","drawRect","beginPath","rect","fillStyle","fill","lineWidth","strokeStyle","stroke","clearRect","terScrollX","terScrollY","CoordinateService","canvas","terOffsetX","terOffsetY","terWidth","terHeight","canOffsetX","canOffsetY","scale","originX","originY","_currentTerX","_currentTerY","_lastScale","_isChangeOrigin","wrapper","style","transformOrigin","_isChangeMouse","mouseX","mouseY","oldOffset","_localtionX","_localtionY","newOriginX","newOriginY","f","_newLeft","_newTop","move","_canvas2terminal","coordinate","transformOriginX","transformOriginY","GridService","domWrapper","theme","gap","adsorbGap","backgroud","lineColor","circleRadiu","circleColor","merge","createCircle","createLine","_ctx","_p","_gap","arc","lineTo","closePath","_justifyItem","_ex","_ey","_right","_bottom","_posRight","_posBottom","Infinity","right","bottom","_moveNode","_moveGroup","GuidelineService","guideLineCanvas","process","floor","_leftDis","_rightDis","_topDis","_bottomDis","_leftItem","_rightItem","_topItem","_bottomItem","_groupLeft","_groupRight","_groupTop","_groupBottom","_nodeLeft","_nodeRight","_nodeTop","_nodeBottom","guidLine","transform","DOT_COLOR","GROUP_COLOR","DOT_ACTIVE_COLOR","GROUP_ACTIVE_COLOR","SAFE_DISTANCE","modifyCSS","ele","cssStyle","Object","keys","getPixelRatio","context","backingStore","backingStorePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","devicePixelRatio","checkOpts","Error","terminal2canvas","Minimap","canvas2terminal","$root","rleft","rtop","leftTop","rightBottom","screenLeftTop","screenRightBottom","$viewport","viewportDOM","parent","offsetParent","poffset","debounce","renderViewPort","renderBG","containerStyle","viewportStyle","backgroudStyle","nodeColor","groupColor","activeNodeColor","activeGroupColor","containerWidth","containerHeight","zoom","safeDistance","ratio","initContainer","getItemsPoint","check","allNTop","allNLeft","allNBottom","allNRight","allGTop","allGLeft","allGBottom","allGRight","allTop","allLeft","allBottom","allRight","minX","minY","maxX","maxY","graphSize","getBBox","Number","toFixed","debounceRender","backgroundDOM","initStyle","overflow","border","appendChild","initBGCanvas","initViewportEvts","canvasDom","cvsCtx","cvsRatio","dragging","viewportEvents","mousedown","viewportBBox","getViewportBBox","mousemove","isNil","mapWidth","mapHeight","vpWidth","vpHeight","boffset","ddx","ddy","mouseleave","mouseup","minimapActive","fillRect","setRatio","rootWidth","rootHeight","vwidth","vheight","vleft","vtop","removeChild","domtoimage","BaseCanvas","zoomable","moveable","linkable","disLinkable","isRepeat","isLinkMyself","linkableHighlight","zoomGap","autoFixCanvas","enable","autoMovePadding","autoResizeRootSize","limitQueueLen","_zoomData","_moveData","_zoomTimer","isSelectMode","selecContents","selecMode","selectItem","_remarkZoom","_remarkMove","svg","canvasWrapper","_genWrapper","_genSvgWrapper","_genCanvasWrapper","_dragType","_dragNode","_dragEndpoint","_dragEdges","_dragGroup","_rootWidth","_rootHeight","_gridService","_guidelineService","_unionData","__system","_NodeClass","actionQueue","actionQueueIndex","_autoMoveDir","_autoMoveTimer","_changeCanvasInfo","callback","_autoLayout","groupPromise","Promise","resolve","reject","addGroups","nodePromise","edgePromise","addEdges","all","then","removeGroups","clearActionQueue","GroupClass","_newNodes","_groupObj","_isExistGroup","warn","prepend","_createEndpoint","mounted","_isAbsolutePos","_moveTo","newNode","_existNode","__node","removeNode","_init","addNode","_nodeObj","_groupWidth","_groupHeight","_w","_h","setSize","pushActionQueue","_canvasFragment","createDocumentFragment","_existGroup","getGroup","_isExistNode","initObj","existGroup","_appendNodes","links","_edgeFragment","_labelFragment","EdgeClass","getNode","getEndpoint","_isRepeat","_result","_tmpType","_soucePoint","_targetPoint","datas","addGroup","isNotDelEdge","nodeIds","rmEdges","neighborEdges","getNeighborEdges","removeEdges","_rmNodes","isNotPushActionQueue","edgeIndex","_rmEdge","isExistEdge","groupId","_isDeleting","insideNodes","rmItem","rmNode","groupIds","rmGroups","removeGroup","iteratee","quene","neighbors","visited","Set","adjTable","getAdjcentTable","flatMap","add","shift","$node","$endpoint","$level","has","neighborsWithEndpoint","neighbor","$nNode","$nEndpoint","sourceNodeId","sourceEndpointId","targetNodeId","targetEndpointId","zoomDirection","_zoomDirection","_zoomCb","deltaY","platform","girdWrapper","removeEventListener","canLeft","canRight","canTop","canBottom","customOffset","canDisX","terDisX","canDisY","terDisY","scaleX","scaleY","terLeft","terRight","terTop","terBottom","time","animate","focusNodesWithAnimate","isFunction","containerW","containerH","targetY","targetX","frame","interval","clearInterval","setInterval","_canvasInfo","toString","replace","contents","_rmSystemUnion","active","setZoomable","setMoveable","create","events","updateEvts","getNodes","getGroups","minimap","getZoom","getOffset","updateFn","update","ev","error","_data","isId","uniqBy","getEdge","isExist","_item","method","dataUrl","justifyAllCoordinate","_detectMob","toMatch","toMatchItem","navigator","userAgent","match","_isMobi","_SVGWidth","_SVGHeight","_detectZoom","screen","ua","toLowerCase","deviceXDPI","logicalXDPI","_sclae","onresize","wrapperOffset","getBoundingClientRect","svgOffset","_isChrome","test","vendor","_getChromeVersion","raw","_isHightVerChrome","ResizeObserver","_resizeObserver","entries","observe","_addEndpoint","_point","_selectMultiplyItem","removeEdge","_hasNode","_attachMouseDownEvent","hasNodes","hasGroups","initOtps","endpointDom","canvasOriginPos","nodeOriginPos","_isActiveEndpoint","_activeItems","_activeLinkableEndpoint","_allPoints","_getAllEndpoints","canLink","_unActiveLinkableEndpoint","unLinkable","unHoverLinkable","_oldFocusPoint","_isFocusing","_focusLinkableEndpoint","_points","_focusPoint","_maxX","_maxY","_minX","_minY","hoverLinkable","mouseDownEvent","LEFT_BUTTON","dispatchEvent","MouseEvent","dragType","dragNode","dragEndpoint","dragEdges","dragGroup","canvasX","canvasY","mouseMoveEvent","moveNodes","unionKeys","_findUnion","_autoMoveCanvas","_isSourceEndpoint","_isTargetEndpoint","pointObj","_linkNums","_newEdge","targetEdge","_newWidth","_newHeight","mouseEndEvent","_unionNodes","_targetEndpoint","_nodes","isDestoryEdges","_linkNum","_delEdges","_reconnectInfo","_emitEdges","_preTargetNodeId","_preTargetPointId","_currentTargetNode","_currentTargetEndpoint","preTargetNodeId","preTargetPointId","currentTargetNodeId","currentTargetPointId","_create","_isConnect","isConnect","delLinks","addLinks","info","_handleDragNode","sourceGroup","_updateNeighborEdge","_sourceEndpoint","nodeData","step","_isDraging","popActionQueue","unionNodes","cb","_terOffsetX","_terOffsetY","_autoMovePadding","MOVE_GAP","_moveTarget","isLink","hasUpdate","_opts","extend","align","includeNode","includeEdge","includeEndpoint","_isSelected","option","_itemLeft","_itemRight","_itemTop","_itemBottom","nodeLeft","nodeRight","nodeTop","nodeBottom","isSelected","pointLeft","pointRight","pointTop","pointBottom","flatten","_nodeInfo","fromLeft","fromTop","_groupInfo","_preStep","unshift","steps","toLeft","toTop","_type","_types","currentStep","moveItems","action","pop","TreeNode","children","collapsed","isRoot","Hierarchy","tranlateData","queue","nodeList","treePos","hgap","vgap","depth","side","compactBox","dendrogram","indented","mindmap","TreeCanvas","isFlat","child","subCollapsed","collapseNode","expandNode","collapseNodes","collapseEdges","tmp","_isCollapsed","subNodes","differenceBy","a","b","rootNode","getRootNode","tree","tmpTreeObj","_childObj","parentNode","_subTree","findSubTree","unionBy","_handleTreeNodes","NODE_SIZE","NODE_WIDTH","PEM","direction","getId","getHGap","getVGap","getSubTreeSep","Default","TEMPLATE","$viewAppend","$viewScale","$viewCon","$inner","callbackWhitelist","evntList","callBackOpen","delay","_toFixed_3","_getTipOffset","placement","actualWidth","actualHeight","show","toolTipDom","callBackFunc","res","textContent","scaleArr","posInit","hide","creatTips","html","content","_timeoutMouseover","clearTimeout","hasClass","clickOrSame","which","nowShow","creatMenus","menu","showTip","menuDom","menuUl","exports","Tips"],"mappings":"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"}